<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Notes from day to day tasks" name="description"/><meta content="Padam Shrestha" name="author"/><link href="../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.5.3, mkdocs-material-8.5.7" name="generator"/><title>üß∫ Data dictionary for metadata driven Synapse pipeline - Blog</title><link href="../../assets/stylesheets/main.20d9efc8.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../assets/stylesheets/extra.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-08DR4DTC9K"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-08DR4DTC9K",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-08DR4DTC9K",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="indigo" data-md-color-primary="light-blue" data-md-color-scheme="slate" dir="ltr"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#data-dictionary-for-metadata-driven-synapse-pipeline"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="Blog" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Blog </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> üß∫ Data dictionary for metadata driven Synapse pipeline </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="light-blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Blog" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2"> Synapse <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Synapse" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Synapse </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/build-dev-pyspark-cluster/"> üê≥ Build Development Spark cluster - PySpark, Delta Lake </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-dataframe-api/"> üìù PySpark Quickstart </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-cheat-sheet/"> üìÑ PySpark Cheat Sheet </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-azure-tables/"> ‚ú® Creating tables in PySpark Azure </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../spark-delta-partition/"> Creating partition in delta lake with spark </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../generate-stock-schema-delta-api/"> Design stock and option schema and provide fast api to access using spark delta </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/introduction/"> üìò Synapse Introduction </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/problem-solutions/"> üîì Synapse / PySpark problem and solutions </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> üß∫ Data dictionary for metadata driven Synapse pipeline <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> üß∫ Data dictionary for metadata driven Synapse pipeline </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#diagram"> Diagram </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#derive-the-entity-relation-from-given-list-of-entities-with-their-properties"> Derive the entity relation from given list of entities with their properties: </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#schema-for-them-in-pyspark"> schema for them in pyspark </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pyspark-dataframe-from-individual-dataframe-which-are-grouped-by-process-processstep-and-so-on"> Pyspark dataframe from individual dataframe which are grouped by process, processStep and so on </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#now-lets-create-nested-group-starting-from-process"> Now let's create nested group starting from process </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#all-related-information-from-dataframes-group-by-entities-for-a-given-process"> All related information from dataframes group by entities for a given process </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#find-all-related-information-from-dataframes-group-by-entities-for-a-given-processcode"> Find all related information from dataframes group by entities for a given ProcessCode </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#query-to-group-them"> Query to group them </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#flow-diagram"> Flow Diagram </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-courses/"> üîÖ Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/links/"> üîó Synapse links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3"> Python <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Python" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Python </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-basics/"> üêç Python Basics </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/create-python-package/"> üì¶ Create Custom Python Package </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-courses/"> üìô Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/links/"> üîó Python links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4"> Dotnet <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Dotnet" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Dotnet </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-7/"> What's new in C# 7.0 through C# 7.3 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-8/"> What's new in C# 8.0 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-9/"> What's new in C# 9.0 - C# Guide </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-10/"> What's new in C# 10 - C# Guide </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-11/"> What's new in C# 11 - C# Guide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5"> Microservices <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Microservices" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Microservices </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/grafana-dashboards/"> Grafana Dashboards </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/azure-function-dapr/"> Azure function with Dapr to create event-driven, distributed application </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/dapr-resources/"> Resources </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/links/"> üîó Dapr links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6"> Serverless <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Serverless" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../serverless/links/"> üîó Azure Serverless links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7"> Azure <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Azure" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Azure </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-resource-graph-explorer/"> Write query using Azure Resource Graph Explorer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-keyboard-shortcuts/"> Azure Keyboard Shortcuts in Azure Portal </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-service-fabric/"> Introduction to Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/starting-azure-service-fabric/"> Starting Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../azure/links/"> üîó Azure links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" id="__nav_8" type="checkbox"/> <label class="md-nav__link" for="__nav_8"> Spark <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Spark" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> Spark </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/jupyter-pyspark-docker/"> Run Jupyter for Pyspark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-learning/"> Spark Machine Learning </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker/"> Run and Debug Dotnet Spark application on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-ubuntu/"> Install Dotnet Spark on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker-ubuntu/"> Running Dotnet Spark applications on Ubuntu Continer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/install-docker-ubuntu2004/"> Install Docker on Ubuntu 20.04 LTS and Dotnet Spark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/python-learning/"> Learning Python </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/links/"> üîó Spark links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9"> Kusto <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Kusto" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Kusto </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/kusto-overview/"> Kusto Query Language (KQL) </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/dynamic-365-hcm-kusto/"> Troubleshoot using Kusto </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" id="__nav_10" type="checkbox"/> <label class="md-nav__link" for="__nav_10"> Angular <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Angular" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> Angular </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/deploy-angular-app-to-github-io-pages/"> Deploy Angular app to github.io pages </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11"> Tools and Tricks <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Tools and Tricks" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> Tools and Tricks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../fastapi-uvicorn/"> Configure Fast API with Uvicorn in Dockerfile </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/limited_access_pat_token/"> Create Git PAT token with limited access. </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/multiple-remote-git/"> Multiple remote git configuration for repository </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/chocolatey/"> Install and manage applications using Chocolatey </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/keyboard-shortcuts/"> Keyboard shortcuts for everyday tasks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/error-solutions/"> Everyday error and fixes </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/certificates/"> Searching and Installing Certificates </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-vscode-ubuntu/"> Install VS Code on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-brave-ubuntu2004/"> Install Brave browser on Ubuntu 20.04 LTS </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/useful-online-tools/"> ‚öí Useful online tools </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/helpful-links/"> üîó Helpful links </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/nuget/"> Nuget Package Manger </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/docker/"> üê≥ Installing and Running Docker in WSL with VS Code </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/dotnetcore-azurefunction-wsl/"> Install dotnet core 3.1 and azure-functions-core-tools on WSL </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/configure-publish-mkdocs-github/"> üìö Configure Mkdocs and Auto deploy to Github.io </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/rename-dotnet-3-6/"> Migrate Dotnet Core 3.1 to DotNet 6.0 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/git-help/"> Git </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-dotnet-sdk-armx64/"> Install dotnet skd on Mac m1 armx64 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/windows-tricks/"> Windows tricks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/linux-commands/"> Useful linux commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" id="__nav_12" type="checkbox"/> <label class="md-nav__link" for="__nav_12"> Courses, Projects, Tutorials, Blogs <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Courses, Projects, Tutorials, Blogs" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> Courses, Projects, Tutorials, Blogs </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/coursera/"> Coursera Courses </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/github_project/"> Github repo and projects </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" id="__nav_13" type="checkbox"/> <label class="md-nav__link" for="__nav_13"> Finance <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Finance" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> Finance </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../finance/use_of_ft/"> Fourier Transform in Price </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" id="__nav_14" type="checkbox"/> <label class="md-nav__link" for="__nav_14"> Random <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Random" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> Random </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../random/links/"> üîó Random useful links </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tags/"> Tags </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#diagram"> Diagram </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#derive-the-entity-relation-from-given-list-of-entities-with-their-properties"> Derive the entity relation from given list of entities with their properties: </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#schema-for-them-in-pyspark"> schema for them in pyspark </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pyspark-dataframe-from-individual-dataframe-which-are-grouped-by-process-processstep-and-so-on"> Pyspark dataframe from individual dataframe which are grouped by process, processStep and so on </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#now-lets-create-nested-group-starting-from-process"> Now let's create nested group starting from process </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#all-related-information-from-dataframes-group-by-entities-for-a-given-process"> All related information from dataframes group by entities for a given process </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#find-all-related-information-from-dataframes-group-by-entities-for-a-given-processcode"> Find all related information from dataframes group by entities for a given ProcessCode </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#query-to-group-them"> Query to group them </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#flow-diagram"> Flow Diagram </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="data-dictionary-for-metadata-driven-synapse-pipeline">üß∫ Data dictionary for metadata driven Synapse pipeline<a class="headerlink" href="#data-dictionary-for-metadata-driven-synapse-pipeline" title="Permanent link">¬∂</a></h1> <h3 id="diagram">Diagram<a class="headerlink" href="#diagram" title="Permanent link">¬∂</a></h3> <pre class="mermaid"><code>graph TD;
    Process[Process] --&gt; ProcessStep[ProcessStep]
    ProcessStep --&gt; ProcessStepElementMapping[ProcessStepElementMapping]
    ProcessStepElementMapping --&gt; DataSet[DataSet]
    DataSet --&gt; DataSetElement[DataSetElement]
    ProcessStepElementMapping --&gt; Action[Action]
    Action --&gt; ActionType[ActionType]
    Action --&gt; ActionParameter[ActionParameter]</code></pre> <h3 id="derive-the-entity-relation-from-given-list-of-entities-with-their-properties">Derive the entity relation from given list of entities with their properties:<a class="headerlink" href="#derive-the-entity-relation-from-given-list-of-entities-with-their-properties" title="Permanent link">¬∂</a></h3> <p>Process: ProcessID, ProcessCode, ProcessName, ProcessDescription, TriggerPattern, KeyParameterTypeID, ImplementationInfo, MaxConcurrency, IsParallelProcess, EffectiveDate, ExpireDate, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy, ValidFrom, ValidTo;</p> <p>ProcessStep: ProcessStepID, ProcessID, ProcessStepName, ProcessStepDescription, ProcessStepTypeID, SubProcessID, ProcessStepOrder, SourceDatasetID, SourceDatasetValidationTypeID, DestinationDatasetID, ActionID, EffectiveDate, ExpireDate, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy, ValidFrom, ValidTo;</p> <p>DataSet: DatasetID, DatasetName, DatasetDescription, DatasetTypeID, NamePattern, LocationPattern, DatasetKey, DatasetSource, ConnectionDescription, EffectiveDate, ExpireDate, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy, ValidFrom, ValidTo;</p> <p>DataSetElement: DatasetElementID, DatasetID, DatasetElementName, DatasetElementDescription, DatasetElementOrder, DatasetElementType, IsRequired, EffectiveDate, ExpireDate, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy, ValidFrom, ValidTo;</p> <p>ProcessStepElementMapping: ProcessStepElementMappingID, ProcessStepID, DestinationElementID, ElementSourceTypeID, Source, EffectiveDate, ExpireDate, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy, ValidFrom, ValidTo;</p> <p>ActionType: ActionTypeID, ActionTypeDescription, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy;</p> <p>Action: ActionID, ActionName, ActionDescription, ActionTypeID, NamePattern, LocationPattern, ParameterExpression, ConnectionDescription, EffectiveDate, ExpireDate, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy, ValidFrom, ValidTo;</p> <p>ActionParameter: ActionParameterID, ActionID, ParameterName, ParameterValueTypeID, ParameterValue, ParameterOrder, IsRequired, EffectiveDate, ExpireDate, CreatedDatetime, CreatedBy, UpdatedDatetime, UpdatedBy;</p> <p>The entities and their relationships are as follows: - Process has a one-to-many relationship with ProcessStep, as a Process can have multiple ProcessSteps, but a ProcessStep can only belong to one Process. The ProcessID field in the ProcessStep entity is used to establish this relationship. - ProcessStep has a one-to-one relationship with SubProcess, as a ProcessStep can only belong to one SubProcess, but a SubProcess can only have one ProcessStep. The SubProcessID field in the ProcessStep entity is used to establish this relationship. - ProcessStep has a many-to-one relationship with DataSet, as a ProcessStep can have a source or destination DataSet, but a DataSet can be used by multiple ProcessSteps. The SourceDatasetID and DestinationDatasetID fields in the ProcessStep entity are used to establish this relationship. - ProcessStep has a many-to-one relationship with Action, as a ProcessStep can have an action, but an Action can be used by multiple ProcessSteps. The ActionID field in the ProcessStep entity is used to establish this relationship. - DataSet has a one-to-many relationship with DataSetElement, as a DataSet can have multiple DataSetElements, but a DataSetElement can only belong to one DataSet. The DatasetID field in the DataSetElement entity is used to establish this relationship. - ProcessStep has a many-to-many relationship with DataSetElement, as a ProcessStep can have multiple DataSetElements, and a DataSetElement can be used by multiple ProcessSteps. The ProcessStepElementMapping entity is used to establish this relationship, with ProcessStepID and DestinationElementID fields. - Action has a one-to-many relationship with ActionParameter, as an Action can have multiple ActionParameters, but an ActionParameter can only belong to one Action. The ActionID field in the ActionParameter entity is used to establish this relationship. - Action has a one-to-one relationship with ActionType, as an Action can only have one ActionType, but an ActionType can be used by multiple Actions. The ActionTypeID field in the Action entity is used to establish this relationship.</p> <h3 id="schema-for-them-in-pyspark">schema for them in pyspark<a class="headerlink" href="#schema-for-them-in-pyspark" title="Permanent link">¬∂</a></h3> <p><div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="c1"># Define the schema for the Process table</span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">process_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessName"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"TriggerPattern"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"KeyParameterTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"MaxConcurrency"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">()),</span>
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">())</span>
<a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">])</span>
<a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="c1"># Create the Process DataFrame</span>
<a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="n">process_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">process_schema</span><span class="p">)</span>
<a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="c1"># Define the schema for the ProcessStep table</span>
<a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="n">process_step_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessStepID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessStepName"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessStepDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessStepTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-34" id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"SubProcessID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-35" id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessStepOrder"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-36" id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"SourceDatasetID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-37" id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-38" id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DestinationDatasetID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-39" id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-40" id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-41" id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-42" id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-43" id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-44" id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-45" id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-46" id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-47" id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">())</span>
<a href="#__codelineno-0-48" id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="p">])</span>
<a href="#__codelineno-0-49" id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a href="#__codelineno-0-50" id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="c1"># Create the ProcessStep DataFrame</span>
<a href="#__codelineno-0-51" id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="n">process_step_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">process_step_schema</span><span class="p">)</span>
<a href="#__codelineno-0-52" id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a href="#__codelineno-0-53" id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="c1"># Define the schema for the DataSet table</span>
<a href="#__codelineno-0-54" id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="n">dataset_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-55" id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-56" id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetName"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-57" id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-58" id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-59" id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"NamePattern"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-60" id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"LocationPattern"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-61" id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetKey"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-62" id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetSource"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-63" id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ConnectionDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-64" id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate</span>
<a href="#__codelineno-0-65" id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a href="#__codelineno-0-66" id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-67" id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-68" id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-69" id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-70" id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-71" id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-72" id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-73" id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">())</span>
<a href="#__codelineno-0-74" id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="p">])</span>
<a href="#__codelineno-0-75" id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a href="#__codelineno-0-76" id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="c1"># Create the DataSet DataFrame</span>
<a href="#__codelineno-0-77" id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="n">dataset_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dataset_schema</span><span class="p">)</span>
<a href="#__codelineno-0-78" id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a href="#__codelineno-0-79" id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="c1"># Define the schema for the DataSetElement table</span>
<a href="#__codelineno-0-80" id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="n">dataset_element_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-81" id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetElementID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-82" id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-83" id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetElementName"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-84" id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetElementDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-85" id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetElementOrder"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-86" id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DatasetElementType"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-87" id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"IsRequired"</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">()),</span>
<a href="#__codelineno-0-88" id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-89" id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-90" id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-91" id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-92" id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-93" id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-94" id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-95" id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">())</span>
<a href="#__codelineno-0-96" id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="p">])</span>
<a href="#__codelineno-0-97" id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a href="#__codelineno-0-98" id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="c1"># Create the DataSetElement DataFrame</span>
<a href="#__codelineno-0-99" id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="n">dataset_element_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dataset_element_schema</span><span class="p">)</span>
<a href="#__codelineno-0-100" id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a href="#__codelineno-0-101" id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="c1"># Define the schema for the ProcessStepElementMapping table</span>
<a href="#__codelineno-0-102" id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="n">process_step_element_mapping_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-103" id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessStepElementMappingID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-104" id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ProcessStepID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-105" id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"DestinationElementID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-106" id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ElementSourceTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-107" id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"Source"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-108" id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-109" id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-110" id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-111" id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-112" id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-113" id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-114" id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-115" id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">())</span>
<a href="#__codelineno-0-116" id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="p">])</span>
<a href="#__codelineno-0-117" id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a href="#__codelineno-0-118" id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="c1"># Create the ProcessStepElementMapping DataFrame</span>
<a href="#__codelineno-0-119" id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="n">process_step_element_mapping_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">process_step_element_mapping_schema</span><span class="p">)</span>
<a href="#__codelineno-0-120" id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a href="#__codelineno-0-121" id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="c1"># Define the schema for the ActionType table</span>
<a href="#__codelineno-0-122" id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="n">action_type_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-123" id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-124" id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionTypeDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-125" id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-126" id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-127" id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-128" id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">())</span>
<a href="#__codelineno-0-129" id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="p">])</span>
<a href="#__codelineno-0-130" id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a href="#__codelineno-0-131" id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="c1"># Create the ActionType DataFrame</span>
<a href="#__codelineno-0-132" id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="n">action_type_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">action_type_schema</span><span class="p">)</span>
<a href="#__codelineno-0-133" id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a href="#__codelineno-0-134" id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="c1"># Define the schema for the Action table</span>
<a href="#__codelineno-0-135" id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="n">action_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-136" id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-137" id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionName"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-138" id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-139" id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-140" id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"NamePattern"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-141" id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"LocationPattern"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-142" id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ParameterExpression"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-143" id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ConnectionDescription"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-144" id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-145" id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-146" id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-147" id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-148" id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-149" id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-150" id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-151" id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">())</span>
<a href="#__codelineno-0-152" id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="p">])</span>
<a href="#__codelineno-0-153" id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a href="#__codelineno-0-154" id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="c1"># Create the Action DataFrame</span>
<a href="#__codelineno-0-155" id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="n">action_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">action_schema</span><span class="p">)</span>
<a href="#__codelineno-0-156" id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a href="#__codelineno-0-157" id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="c1"># Define the schema for the ActionParameter table</span>
<a href="#__codelineno-0-158" id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="n">action_parameter_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
<a href="#__codelineno-0-159" id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionParameterID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-160" id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-161" id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ParameterName"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-162" id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ParameterValueTypeID"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-163" id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ParameterValue"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-164" id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ParameterOrder"</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
<a href="#__codelineno-0-165" id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"IsRequired"</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">()),</span>
<a href="#__codelineno-0-166" id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-167" id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="n">DateType</span><span class="p">()),</span>
<a href="#__codelineno-0-168" id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-169" id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
<a href="#__codelineno-0-170" id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
<a href="#__codelineno-0-171" id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">StructField</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="n">StringType</span><span class="p">())</span>
<a href="#__codelineno-0-172" id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="p">])</span>
<a href="#__codelineno-0-173" id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a href="#__codelineno-0-174" id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="c1"># Create the ActionParameter DataFrame</span>
<a href="#__codelineno-0-175" id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="n">action_parameter_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">action_parameter_schema</span><span class="p">)</span>
</code></pre></div> It's worth noting that the data variable used in the example is a list of rows that should be loaded into the DataFrames. Also, this is just an example, you may need to adjust the datatype of the fields or add/remove fields as per your use case.</p> <p>Here is how the relationships between the entities can be defined in PySpark:</p> <p><div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># Define the relationships between the tables</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">process_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"process"</span><span class="p">)</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="n">process_step_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"process_step"</span><span class="p">)</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="n">dataset_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"dataset"</span><span class="p">)</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="n">dataset_element_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"dataset_element"</span><span class="p">)</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="n">process_step_element_mapping_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"process_step_element_mapping"</span><span class="p">)</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="n">action_type_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"action_type"</span><span class="p">)</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="n">action_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"action"</span><span class="p">)</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="n">action_parameter_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"action_parameter"</span><span class="p">)</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="c1"># One-to-many relationship from Process to ProcessStep</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT process.*, process_step.* FROM process JOIN process_step ON process.ProcessID = process_step.ProcessID"</span><span class="p">)</span>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a>
<a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="c1"># One-to-one relationship from ProcessStep to SubProcess</span>
<a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT process_step.*, sub_process.* FROM process_step JOIN sub_process ON process_step.SubProcessID = sub_process.SubProcessID"</span><span class="p">)</span>
<a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a>
<a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="c1"># Many-to-one relationship from ProcessStep to DataSet</span>
<a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT process_step.*, dataset.* FROM process_step JOIN dataset ON process_step.SourceDatasetID = dataset.DatasetID OR process_step.DestinationDatasetID = dataset.DatasetID"</span><span class="p">)</span>
<a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a>
<a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="c1"># Many-to-one relationship from ProcessStep to Action</span>
<a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT process_step.*, action.* FROM process_step JOIN action ON process_step.ActionID = action.ActionID"</span><span class="p">)</span>
<a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a>
<a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="c1"># One-to-many relationship from DataSet to DataSetElement</span>
<a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT dataset.*, dataset_element.* FROM dataset JOIN dataset_element ON dataset.DatasetID = dataset_element.DatasetID"</span><span class="p">)</span>
<a href="#__codelineno-1-25" id="__codelineno-1-25" name="__codelineno-1-25"></a>
<a href="#__codelineno-1-26" id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="c1"># Many-to-many relationship from ProcessStep to DataSetElement</span>
<a href="#__codelineno-1-27" id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT process_step.*, dataset_element.* FROM process_step JOIN process_step_element_mapping ON process_step.ProcessStepID = process_step_element_mapping.ProcessStepID JOIN dataset_element ON process_step_element_mapping.DestinationElementID = dataset_element.DatasetElementID"</span><span class="p">)</span>
<a href="#__codelineno-1-28" id="__codelineno-1-28" name="__codelineno-1-28"></a>
<a href="#__codelineno-1-29" id="__codelineno-1-29" name="__codelineno-1-29"></a><span class="c1"># One-to-many relationship from Action to ActionParameter</span>
<a href="#__codelineno-1-30" id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT action.*, action_parameter.* FROM action JOIN action_parameter ON action.ActionID = action_parameter.ActionID"</span><span class="p">)</span>
<a href="#__codelineno-1-31" id="__codelineno-1-31" name="__codelineno-1-31"></a>
<a href="#__codelineno-1-32" id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="c1"># One-to-one relationship from Action to ActionType</span>
<a href="#__codelineno-1-33" id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">"SELECT action.*, action_type.* FROM action JOIN action_type ON action.ActionTypeID = action_type.ActionTypeID"</span><span class="p">)</span>
</code></pre></div> It is worth noting that this is just an example and you may need to adjust the query as per your requirement. Also, the above mentioned SQL Queries are used to join the dataframe and load the data in the required format.</p> <h3 id="pyspark-dataframe-from-individual-dataframe-which-are-grouped-by-process-processstep-and-so-on">Pyspark dataframe from individual dataframe which are grouped by process, processStep and so on<a class="headerlink" href="#pyspark-dataframe-from-individual-dataframe-which-are-grouped-by-process-processstep-and-so-on" title="Permanent link">¬∂</a></h3> <p>Use PySpark to group the individual dataframes by their respective entities and create a new dataframe. Here is an example of how you can group the dataframes by "Process" and create a new dataframe: <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="o">*</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="c1"># Group the dataframes by Process</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="n">grouped_process_df</span> <span class="o">=</span> <span class="n">process_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>    <span class="nb">sum</span><span class="p">(</span><span class="s2">"MaxConcurrency"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"TotalMaxConcurrency"</span><span class="p">),</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>    <span class="n">count</span><span class="p">(</span><span class="s2">"*"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"NumOfProcessSteps"</span><span class="p">),</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">),</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">),</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">),</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">),</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">),</span>
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">),</span>
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">),</span>
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span>
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="p">)</span>
<a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>
<a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="c1"># Create a new dataframe with the grouped data</span>
<a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="n">process_summary_df</span> <span class="o">=</span> <span class="n">grouped_process_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a>    <span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">,</span> <span class="s2">"TotalMaxConcurrency"</span><span class="p">,</span> <span class="s2">"NumOfProcessSteps"</span><span class="p">,</span> <span class="s2">"ImplementationInfo"</span><span class="p">,</span> <span class="s2">"IsParallelProcess"</span><span class="p">,</span> <span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="s2">"ValidTo"</span>
<a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="p">)</span>
</code></pre></div></p> <p>You can also group other dataframes by their respective entities in a similar way.</p> <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">grouped_processStep_df</span> <span class="o">=</span> <span class="n">processStep_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">"ProcessStepID"</span><span class="p">,</span> <span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessStepName"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ProcessStepDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepDescription"</span><span class="p">),</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ProcessStepTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepTypeID"</span><span class="p">),</span>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"SubProcessID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SubProcessID"</span><span class="p">),</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ProcessStepOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepOrder"</span><span class="p">),</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"SourceDatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetID"</span><span class="p">),</span>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">),</span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"DestinationDatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DestinationDatasetID"</span><span class="p">),</span>
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">),</span>
<a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">),</span>
<a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">),</span>
<a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">),</span>
<a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">),</span>
<a href="#__codelineno-3-16" id="__codelineno-3-16" name="__codelineno-3-16"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">),</span>
<a href="#__codelineno-3-17" id="__codelineno-3-17" name="__codelineno-3-17"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span>
<a href="#__codelineno-3-18" id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="p">)</span>
<a href="#__codelineno-3-19" id="__codelineno-3-19" name="__codelineno-3-19"></a>
<a href="#__codelineno-3-20" id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="n">processStep_summary_df</span> <span class="o">=</span> <span class="n">grouped_processStep_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a href="#__codelineno-3-21" id="__codelineno-3-21" name="__codelineno-3-21"></a>    <span class="s2">"ProcessStepID"</span><span class="p">,</span> <span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessStepName"</span><span class="p">,</span> <span class="s2">"ProcessStepDescription"</span><span class="p">,</span> <span class="s2">"ProcessStepTypeID"</span><span class="p">,</span> <span class="s2">"SubProcessID"</span><span class="p">,</span> <span class="s2">"ProcessStepOrder"</span><span class="p">,</span> <span class="s2">"SourceDatasetID"</span><span class="p">,</span> <span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">,</span> <span class="s2">"DestinationDatasetID"</span><span class="p">,</span> <span class="s2">"ActionID"</span><span class="p">,</span> <span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="s2">"ValidTo"</span>
<a href="#__codelineno-3-22" id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="p">)</span>
</code></pre></div> <p>In this example, I am using the groupBy method to group the dataframe by specific columns and the agg method to aggregate the data. You can use different aggregation functions like sum, count, first, last etc. to get the desired values for the new dataframe.</p> <p>It's worth noting that this is just an example, you may need to adjust the code as per your use case.</p> <h3 id="now-lets-create-nested-group-starting-from-process">Now let's create nested group starting from process<a class="headerlink" href="#now-lets-create-nested-group-starting-from-process" title="Permanent link">¬∂</a></h3> <p>Create nested groups starting from the "Process" dataframe in PySpark. Here is an example of how you can group the dataframes by "Process" and then group the resulting dataframe by "ProcessStep":</p> <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="o">*</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="c1"># Group the dataframes by Process</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="n">grouped_process_df</span> <span class="o">=</span> <span class="n">process_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>    <span class="nb">sum</span><span class="p">(</span><span class="s2">"MaxConcurrency"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"TotalMaxConcurrency"</span><span class="p">),</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>    <span class="n">count</span><span class="p">(</span><span class="s2">"*"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"NumOfProcessSteps"</span><span class="p">),</span>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">),</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">),</span>
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">),</span>
<a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">),</span>
<a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">),</span>
<a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">),</span>
<a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">),</span>
<a href="#__codelineno-4-16" id="__codelineno-4-16" name="__codelineno-4-16"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">),</span>
<a href="#__codelineno-4-17" id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepIDList"</span><span class="p">)</span>
<a href="#__codelineno-4-18" id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="p">)</span>
<a href="#__codelineno-4-19" id="__codelineno-4-19" name="__codelineno-4-19"></a>
<a href="#__codelineno-4-20" id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="c1"># Group the resulting dataframe by ProcessStep</span>
<a href="#__codelineno-4-21" id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="n">grouped_processStep_df</span> <span class="o">=</span> <span class="n">grouped_process_df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">,</span> <span class="s2">"TotalMaxConcurrency"</span><span class="p">,</span> <span class="s2">"NumOfProcessSteps"</span><span class="p">,</span> <span class="s2">"ImplementationInfo"</span><span class="p">,</span> <span class="s2">"IsParallelProcess"</span><span class="p">,</span> <span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="s2">"ValidTo"</span><span class="p">,</span> <span class="s2">"explode(ProcessStepIDList) as ProcessStepID"</span><span class="p">)</span>
<a href="#__codelineno-4-22" id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="n">grouped_processStep_df</span> <span class="o">=</span> <span class="n">grouped_processStep_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">,</span> <span class="s2">"ProcessStepID"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-4-23" id="__codelineno-4-23" name="__codelineno-4-23"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"TotalMaxConcurrency"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"TotalMaxConcurrency"</span><span class="p">),</span>
<a href="#__codelineno-4-24" id="__codelineno-4-24" name="__codelineno-4-24"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"NumOfProcessSteps"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"NumOfProcessSteps"</span><span class="p">),</span>
<a href="#__codelineno-4-25" id="__codelineno-4-25" name="__codelineno-4-25"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">),</span>
<a href="#__codelineno-4-26" id="__codelineno-4-26" name="__codelineno-4-26"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">),</span>
<a href="#__codelineno-4-27" id="__codelineno-4-27" name="__codelineno-4-27"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">),</span>
<a href="#__codelineno-4-28" id="__codelineno-4-28" name="__codelineno-4-28"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">),</span>
<a href="#__codelineno-4-29" id="__codelineno-4-29" name="__codelineno-4-29"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-4-30" id="__codelineno-4-30" name="__codelineno-4-30"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">),</span>
<a href="#__codelineno-4-31" id="__codelineno-4-31" name="__codelineno-4-31"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-4-32" id="__codelineno-4-32" name="__codelineno-4-32"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">),</span>
<a href="#__codelineno-4-33" id="__codelineno-4-33" name="__codelineno-4-33"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">),</span>
<a href="#__codelineno-4-34" id="__codelineno-4-34" name="__codelineno-4-34"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">),</span>
<a href="#__codelineno-4-35" id="__codelineno-4-35" name="__codelineno-4-35"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-4-36" id="__codelineno-4-36" name="__codelineno-4-36"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-4-37" id="__codelineno-4-37" name="__codelineno-4-37"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SubProcessID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SubProcessIDList"</span><span class="p">),</span>
<a href="#__codelineno-4-38" id="__codelineno-4-38" name="__codelineno-4-38"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepOrderList"</span><span class="p">),</span>
<a href="#__codelineno-4-39" id="__codelineno-4-39" name="__codelineno-4-39"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SourceDatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-4-40" id="__codelineno-4-40" name="__codelineno-4-40"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-4-41" id="__codelineno-4-41" name="__codelineno-4-41"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DestinationDatasetIDList"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DestinationDatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-4-42" id="__codelineno-4-42" name="__codelineno-4-42"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionIDList"</span><span class="p">),</span>
<a href="#__codelineno-4-43" id="__codelineno-4-43" name="__codelineno-4-43"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDateList"</span><span class="p">),</span>
<a href="#__codelineno-4-44" id="__codelineno-4-44" name="__codelineno-4-44"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDateList"</span><span class="p">),</span>
<a href="#__codelineno-4-45" id="__codelineno-4-45" name="__codelineno-4-45"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-4-46" id="__codelineno-4-46" name="__codelineno-4-46"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedByList"</span><span class="p">),</span>
<a href="#__codelineno-4-47" id="__codelineno-4-47" name="__codelineno-4-47"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-4-48" id="__codelineno-4-48" name="__codelineno-4-48"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedByList"</span><span class="p">),</span>
<a href="#__codelineno-4-49" id="__codelineno-4-49" name="__codelineno-4-49"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFromList"</span><span class="p">),</span>
<a href="#__codelineno-4-50" id="__codelineno-4-50" name="__codelineno-4-50"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidToList"</span><span class="p">)</span>
<a href="#__codelineno-4-51" id="__codelineno-4-51" name="__codelineno-4-51"></a><span class="p">)</span>
</code></pre></div> <p>In this example, I am using the collect_list function to collect all the values for each unique ProcessStepID and then groupBy method to group the resulting dataframe by "ProcessID", "ProcessCode", "ProcessName" and "ProcessStepID". Once you have the nested group it's possible to explode the lists and have separate rows for each processStep by using selectExpr and explode method</p> <p>It's worth noting that this is just an example, you may need to adjust the code as per your use case.</p> <p>Example of how you can use the selectExpr and explode method to explode the lists and have separate rows for each processStep:</p> <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1"># Explode the lists and create separate rows for each ProcessStep</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="n">exploded_df</span> <span class="o">=</span> <span class="n">grouped_processStep_df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">,</span> <span class="s2">"TotalMaxConcurrency"</span><span class="p">,</span> <span class="s2">"NumOfProcessSteps"</span><span class="p">,</span> <span class="s2">"ImplementationInfo"</span><span class="p">,</span> <span class="s2">"IsParallelProcess"</span><span class="p">,</span> <span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="s2">"ValidTo"</span><span class="p">,</span> <span class="s2">"ProcessStepID"</span><span class="p">,</span> <span class="s2">"explode(ProcessStepDescriptionList) as ProcessStepDescription"</span><span class="p">,</span> <span class="s2">"explode(ProcessStepTypeIDList) as ProcessStepTypeID"</span><span class="p">,</span> <span class="s2">"explode(SubProcessIDList) as SubProcessID"</span><span class="p">,</span> <span class="s2">"explode(ProcessStepOrderList) as ProcessStepOrder"</span><span class="p">,</span> <span class="s2">"explode(SourceDatasetIDList) as SourceDatasetID"</span><span class="p">,</span> <span class="s2">"explode(SourceDatasetValidationTypeIDList) as SourceDatasetValidationTypeID"</span><span class="p">,</span> <span class="s2">"explode(DestinationDatasetIDList) as DestinationDatasetID"</span><span class="p">,</span> <span class="s2">"explode(ActionIDList) as ActionID"</span><span class="p">,</span> <span class="s2">"explode(EffectiveDateList) as EffectiveDate"</span><span class="p">,</span> <span class="s2">"explode(ExpireDateList) as ExpireDate"</span><span class="p">,</span> <span class="s2">"explode(CreatedDatetimeList) as CreatedDatetime"</span><span class="p">,</span> <span class="s2">"explode(CreatedByList) as CreatedBy"</span><span class="p">,</span> <span class="s2">"explode(UpdatedDatetimeList) as UpdatedDatetime"</span><span class="p">,</span> <span class="s2">"explode(UpdatedByList) as UpdatedBy"</span><span class="p">,</span> <span class="s2">"explode(ValidFromList) as ValidFrom"</span><span class="p">,</span> <span class="s2">"explode(ValidToList) as ValidTo"</span><span class="p">)</span>
</code></pre></div> <p>This will create a new dataframe, exploded_df, where each row represents a unique ProcessStep. Each row will contain the corresponding ProcessStep information as well as the information from the parent Process.</p> <p>You can also use the <code>selectExpr</code></p> <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">exploded_df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">,</span> <span class="s2">"ProcessStepID"</span><span class="p">,</span> <span class="s2">"ProcessStepDescription"</span><span class="p">,</span> <span class="s2">"ProcessStepTypeID"</span><span class="p">,</span> <span class="s2">"SubProcessID"</span><span class="p">,</span> <span class="s2">"ProcessStepOrder"</span><span class="p">,</span> <span class="s2">"SourceDatasetID"</span><span class="p">,</span> <span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">,</span> <span class="s2">"DestinationDatasetID"</span><span class="p">,</span> <span class="s2">"ActionID"</span><span class="p">,</span> <span class="s2">"EffectiveDate"</span><span class="p">,</span> <span class="s2">"ExpireDate"</span><span class="p">,</span> <span class="s2">"CreatedDatetime"</span><span class="p">,</span> <span class="s2">"CreatedBy"</span><span class="p">,</span> <span class="s2">"UpdatedDatetime"</span><span class="p">,</span> <span class="s2">"UpdatedBy"</span><span class="p">,</span> <span class="s2">"ValidFrom"</span><span class="p">,</span> <span class="s2">"ValidTo"</span><span class="p">)</span>
</code></pre></div> <p>This will select only the relevant columns for the exploded dataframe. It's worth noting that the above method will repeat the parent process information for each processStep, if you don't want this, you can use a join method to bring the parent process information.</p> <p>It's also worth noting that this is just an example, you may need to adjust the code as per your use case.</p> <h3 id="all-related-information-from-dataframes-group-by-entities-for-a-given-process">All related information from dataframes group by entities for a given process<a class="headerlink" href="#all-related-information-from-dataframes-group-by-entities-for-a-given-process" title="Permanent link">¬∂</a></h3> <p>Use Spark SQL to query the dataframes and find all related information for a given process. Here is an example of how you can query the dataframes and group them by entities for a given process:</p> <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="o">*</span>
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="c1"># Create a temporary view for each dataframe</span>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="n">process_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"process"</span><span class="p">)</span>
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="n">processStep_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"processStep"</span><span class="p">)</span>
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="n">dataset_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"dataset"</span><span class="p">)</span>
<a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="n">datasetElement_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"datasetElement"</span><span class="p">)</span>
<a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="n">processStepElementMapping_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"processStepElementMapping"</span><span class="p">)</span>
<a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="n">actionType_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"actionType"</span><span class="p">)</span>
<a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="n">action_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"action"</span><span class="p">)</span>
<a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="n">actionParameter_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"actionParameter"</span><span class="p">)</span>
<a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a>
<a href="#__codelineno-7-13" id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="c1"># Define the process ID for which you want to find the related information</span>
<a href="#__codelineno-7-14" id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="n">process_id</span> <span class="o">=</span> <span class="s2">"123"</span>
<a href="#__codelineno-7-15" id="__codelineno-7-15" name="__codelineno-7-15"></a>
<a href="#__codelineno-7-16" id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="c1"># Query to find all related information for the given process ID</span>
<a href="#__codelineno-7-17" id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<a href="#__codelineno-7-18" id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="s2">SELECT process.*, processStep.*, dataset.*, datasetElement.*, processStepElementMapping.*, actionType.*, action.*, actionParameter.*</span>
<a href="#__codelineno-7-19" id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="s2">FROM process</span>
<a href="#__codelineno-7-20" id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="s2">LEFT JOIN processStep ON process.ProcessID = processStep.ProcessID</span>
<a href="#__codelineno-7-21" id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="s2">LEFT JOIN dataset ON processStep.SourceDatasetID = dataset.DatasetID OR processStep.DestinationDatasetID = dataset.DatasetID</span>
<a href="#__codelineno-7-22" id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="s2">LEFT JOIN datasetElement ON dataset.DatasetID = datasetElement.DatasetID</span>
<a href="#__codelineno-7-23" id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="s2">LEFT JOIN processStepElementMapping ON processStep.ProcessStepID = processStepElementMapping.ProcessStepID</span>
<a href="#__codelineno-7-24" id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="s2">LEFT JOIN actionType ON processStep.ProcessStepTypeID = actionType.ActionTypeID</span>
<a href="#__codelineno-7-25" id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="s2">LEFT JOIN action ON processStep.ActionID = action.ActionID</span>
<a href="#__codelineno-7-26" id="__codelineno-7-26" name="__codelineno-7-26"></a><span class="s2">LEFT JOIN actionParameter ON action.ActionID = actionParameter.ActionID</span>
<a href="#__codelineno-7-27" id="__codelineno-7-27" name="__codelineno-7-27"></a><span class="s2">WHERE process.ProcessID = '</span><span class="si">{}</span><span class="s2">'</span>
<a href="#__codelineno-7-28" id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="s2">"""</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">process_id</span><span class="p">)</span>
<a href="#__codelineno-7-29" id="__codelineno-7-29" name="__codelineno-7-29"></a>
<a href="#__codelineno-7-30" id="__codelineno-7-30" name="__codelineno-7-30"></a><span class="c1"># Execute the query and group the results by entities</span>
<a href="#__codelineno-7-31" id="__codelineno-7-31" name="__codelineno-7-31"></a><span class="n">result_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div> <p>In this example, I'm using the LEFT JOIN operator to join the dataframes based on the relationships between the entities. I'm also using the WHERE clause to filter the results based on the given process ID.</p> <p>It's worth noting that this is just an example, you may need to adjust the code as per your use case.</p> <p>Use the groupBy method to group the results by entities after executing the query. Here is an example of how you can group the results:</p> <p><div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># Group the results by Process</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">grouped_by_process_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">,</span> <span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ProcessDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessDescription"</span><span class="p">),</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"TriggerPattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"TriggerPattern"</span><span class="p">),</span>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"KeyParameterTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"KeyParameterTypeID"</span><span class="p">),</span>
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">),</span>
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"MaxConcurrency"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"MaxConcurrency"</span><span class="p">),</span>
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">),</span>
<a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">),</span>
<a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">),</span>
<a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">),</span>
<a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">),</span>
<a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">),</span>
<a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">),</span>
<a href="#__codelineno-8-17" id="__codelineno-8-17" name="__codelineno-8-17"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-18" id="__codelineno-8-18" name="__codelineno-8-18"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepNameList"</span><span class="p">),</span>
<a href="#__codelineno-8-19" id="__codelineno-8-19" name="__codelineno-8-19"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-8-20" id="__codelineno-8-20" name="__codelineno-8-20"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-21" id="__codelineno-8-21" name="__codelineno-8-21"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SubProcessID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SubProcessIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-22" id="__codelineno-8-22" name="__codelineno-8-22"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepOrderList"</span><span class="p">),</span>
<a href="#__codelineno-8-23" id="__codelineno-8-23" name="__codelineno-8-23"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SourceDatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-24" id="__codelineno-8-24" name="__codelineno-8-24"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-25" id="__codelineno-8-25" name="__codelineno-8-25"></a>    <span class="n">collect_list</span>
<a href="#__codelineno-8-26" id="__codelineno-8-26" name="__codelineno-8-26"></a>
<a href="#__codelineno-8-27" id="__codelineno-8-27" name="__codelineno-8-27"></a>    <span class="c1"># seems incomplete</span>
<a href="#__codelineno-8-28" id="__codelineno-8-28" name="__codelineno-8-28"></a>    <span class="n">grouped_by_process_df</span> <span class="o">=</span> <span class="n">grouped_by_process_df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-8-29" id="__codelineno-8-29" name="__codelineno-8-29"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DestinationDatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DestinationDatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-30" id="__codelineno-8-30" name="__codelineno-8-30"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-31" id="__codelineno-8-31" name="__codelineno-8-31"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-32" id="__codelineno-8-32" name="__codelineno-8-32"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetNameList"</span><span class="p">),</span>
<a href="#__codelineno-8-33" id="__codelineno-8-33" name="__codelineno-8-33"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-8-34" id="__codelineno-8-34" name="__codelineno-8-34"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-35" id="__codelineno-8-35" name="__codelineno-8-35"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"NamePattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"NamePatternList"</span><span class="p">),</span>
<a href="#__codelineno-8-36" id="__codelineno-8-36" name="__codelineno-8-36"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"LocationPattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"LocationPatternList"</span><span class="p">),</span>
<a href="#__codelineno-8-37" id="__codelineno-8-37" name="__codelineno-8-37"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetKey"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetKeyList"</span><span class="p">),</span>
<a href="#__codelineno-8-38" id="__codelineno-8-38" name="__codelineno-8-38"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetSource"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetSourceList"</span><span class="p">),</span>
<a href="#__codelineno-8-39" id="__codelineno-8-39" name="__codelineno-8-39"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ConnectionDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ConnectionDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-8-40" id="__codelineno-8-40" name="__codelineno-8-40"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDateList"</span><span class="p">),</span>
<a href="#__codelineno-8-41" id="__codelineno-8-41" name="__codelineno-8-41"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDateList"</span><span class="p">),</span>
<a href="#__codelineno-8-42" id="__codelineno-8-42" name="__codelineno-8-42"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-8-43" id="__codelineno-8-43" name="__codelineno-8-43"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedByList"</span><span class="p">),</span>
<a href="#__codelineno-8-44" id="__codelineno-8-44" name="__codelineno-8-44"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-8-45" id="__codelineno-8-45" name="__codelineno-8-45"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedByList"</span><span class="p">),</span>
<a href="#__codelineno-8-46" id="__codelineno-8-46" name="__codelineno-8-46"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFromList"</span><span class="p">),</span>
<a href="#__codelineno-8-47" id="__codelineno-8-47" name="__codelineno-8-47"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidToList"</span><span class="p">),</span>
<a href="#__codelineno-8-48" id="__codelineno-8-48" name="__codelineno-8-48"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-49" id="__codelineno-8-49" name="__codelineno-8-49"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementNameList"</span><span class="p">),</span>
<a href="#__codelineno-8-50" id="__codelineno-8-50" name="__codelineno-8-50"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-8-51" id="__codelineno-8-51" name="__codelineno-8-51"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementOrderList"</span><span class="p">),</span>
<a href="#__codelineno-8-52" id="__codelineno-8-52" name="__codelineno-8-52"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementType"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementTypeList"</span><span class="p">),</span>
<a href="#__codelineno-8-53" id="__codelineno-8-53" name="__codelineno-8-53"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"IsRequired"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsRequiredList"</span><span class="p">),</span>
<a href="#__codelineno-8-54" id="__codelineno-8-54" name="__codelineno-8-54"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepElementMappingID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepElementMappingIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-55" id="__codelineno-8-55" name="__codelineno-8-55"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DestinationElementID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DestinationElementIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-56" id="__codelineno-8-56" name="__codelineno-8-56"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ElementSourceTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ElementSourceTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-57" id="__codelineno-8-57" name="__codelineno-8-57"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"Source"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceList"</span><span class="p">),</span>
<a href="#__codelineno-8-58" id="__codelineno-8-58" name="__codelineno-8-58"></a>    <span class="n">collect_list</span>
<a href="#__codelineno-8-59" id="__codelineno-8-59" name="__codelineno-8-59"></a>
<a href="#__codelineno-8-60" id="__codelineno-8-60" name="__codelineno-8-60"></a>    <span class="c1"># same here</span>
<a href="#__codelineno-8-61" id="__codelineno-8-61" name="__codelineno-8-61"></a>    <span class="n">grouped_by_process_df</span> <span class="o">=</span> <span class="n">grouped_by_process_df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-8-62" id="__codelineno-8-62" name="__codelineno-8-62"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDateList"</span><span class="p">),</span>
<a href="#__codelineno-8-63" id="__codelineno-8-63" name="__codelineno-8-63"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDateList"</span><span class="p">),</span>
<a href="#__codelineno-8-64" id="__codelineno-8-64" name="__codelineno-8-64"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-8-65" id="__codelineno-8-65" name="__codelineno-8-65"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedByList"</span><span class="p">),</span>
<a href="#__codelineno-8-66" id="__codelineno-8-66" name="__codelineno-8-66"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-8-67" id="__codelineno-8-67" name="__codelineno-8-67"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedByList"</span><span class="p">),</span>
<a href="#__codelineno-8-68" id="__codelineno-8-68" name="__codelineno-8-68"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFromList"</span><span class="p">),</span>
<a href="#__codelineno-8-69" id="__codelineno-8-69" name="__codelineno-8-69"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidToList"</span><span class="p">),</span>
<a href="#__codelineno-8-70" id="__codelineno-8-70" name="__codelineno-8-70"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-71" id="__codelineno-8-71" name="__codelineno-8-71"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionTypeDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionTypeDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-8-72" id="__codelineno-8-72" name="__codelineno-8-72"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionNameList"</span><span class="p">),</span>
<a href="#__codelineno-8-73" id="__codelineno-8-73" name="__codelineno-8-73"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-8-74" id="__codelineno-8-74" name="__codelineno-8-74"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"NamePattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"NamePatternList"</span><span class="p">),</span>
<a href="#__codelineno-8-75" id="__codelineno-8-75" name="__codelineno-8-75"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"LocationPattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"LocationPatternList"</span><span class="p">),</span>
<a href="#__codelineno-8-76" id="__codelineno-8-76" name="__codelineno-8-76"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterExpression"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterExpressionList"</span><span class="p">),</span>
<a href="#__codelineno-8-77" id="__codelineno-8-77" name="__codelineno-8-77"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ConnectionDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ConnectionDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-8-78" id="__codelineno-8-78" name="__codelineno-8-78"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionParameterID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionParameterIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-79" id="__codelineno-8-79" name="__codelineno-8-79"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterNameList"</span><span class="p">),</span>
<a href="#__codelineno-8-80" id="__codelineno-8-80" name="__codelineno-8-80"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterValueTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterValueTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-8-81" id="__codelineno-8-81" name="__codelineno-8-81"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterValue"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterValueList"</span><span class="p">),</span>
<a href="#__codelineno-8-82" id="__codelineno-8-82" name="__codelineno-8-82"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterOrderList"</span><span class="p">),</span>
<a href="#__codelineno-8-83" id="__codelineno-8-83" name="__codelineno-8-83"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"IsRequired"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsRequiredList"</span><span class="p">),</span>
<a href="#__codelineno-8-84" id="__codelineno-8-84" name="__codelineno-8-84"></a>    <span class="p">)</span>
</code></pre></div> In this example, I'm using the groupBy method to group the results by Process ID, Process Code, and Process Name, and using the agg method and the collect_list function to collect all the values for each unique Process ID and then group the resulting dataframe by process. It's worth noting that this is just an example, you may need to adjust the code as per your use case.</p> <h3 id="find-all-related-information-from-dataframes-group-by-entities-for-a-given-processcode">Find all related information from dataframes group by entities for a given ProcessCode<a class="headerlink" href="#find-all-related-information-from-dataframes-group-by-entities-for-a-given-processcode" title="Permanent link">¬∂</a></h3> <p>use Spark SQL to query the dataframes and find all related information for a given ProcessCode. Here is an example of how you can query the dataframes and group them by entities for a given ProcessCode:</p> <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="o">*</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="c1"># Create a temporary view for each dataframe</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="n">process_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"process"</span><span class="p">)</span>
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="n">processStep_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"processStep"</span><span class="p">)</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="n">dataset_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"dataset"</span><span class="p">)</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="n">datasetElement_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"datasetElement"</span><span class="p">)</span>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="n">processStepElementMapping_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"processStepElementMapping"</span><span class="p">)</span>
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="n">actionType_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"actionType"</span><span class="p">)</span>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="n">action_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"action"</span><span class="p">)</span>
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="n">actionParameter_df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"actionParameter"</span><span class="p">)</span>
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="c1"># Define the process code for which you want to find the related information</span>
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="n">process_code</span> <span class="o">=</span> <span class="s2">"code123"</span>
<a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a>
<a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="c1"># Query to find all related information for the given process code</span>
<a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="s2">SELECT process.*, processStep.*, dataset.*, datasetElement.*, processStepElementMapping.*, actionType.*, action.*, actionParameter.*</span>
<a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="s2">FROM process</span>
<a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="s2">LEFT JOIN processStep ON process.ProcessID = processStep.ProcessID</span>
<a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="s2">LEFT JOIN dataset ON processStep.SourceDatasetID = dataset.DatasetID OR processStep.DestinationDatasetID = dataset.DatasetID</span>
<a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="s2">LEFT JOIN datasetElement ON dataset.DatasetID = datasetElement.DatasetID</span>
<a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="s2">LEFT JOIN processStepElementMapping ON processStep.ProcessStepID = processStepElementMapping.ProcessStepID</span>
<a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="s2">LEFT JOIN actionType ON processStep.ProcessStepTypeID = actionType.ActionTypeID</span>
<a href="#__codelineno-9-25" id="__codelineno-9-25" name="__codelineno-9-25"></a><span class="s2">LEFT JOIN action ON processStep.ActionID = action.ActionID</span>
<a href="#__codelineno-9-26" id="__codelineno-9-26" name="__codelineno-9-26"></a><span class="s2">LEFT JOIN actionParameter ON action.ActionID = actionParameter.ActionID</span>
<a href="#__codelineno-9-27" id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="s2">WHERE process.ProcessCode = '</span><span class="si">{}</span><span class="s2">'</span>
<a href="#__codelineno-9-28" id="__codelineno-9-28" name="__codelineno-9-28"></a><span class="s2">"""</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">process_code</span><span class="p">)</span>
<a href="#__codelineno-9-29" id="__codelineno-9-29" name="__codelineno-9-29"></a>
<a href="#__codelineno-9-30" id="__codelineno-9-30" name="__codelineno-9-30"></a><span class="c1"># Execute the query and group the results by entities</span>
<a href="#__codelineno-9-31" id="__codelineno-9-31" name="__codelineno-9-31"></a><span class="n">result_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div> <p>In this example, I'm using the LEFT JOIN operator to join the dataframes based on the relationships between the entities. I'm also using the WHERE clause to filter the results based on the given ProcessCode.</p> <p>It's worth noting that this is just an example, you may need to adjust the code as per your use case. Once you have the result of the query, you can use the groupBy and agg method as previously explained to group the result by entities.</p> <h3 id="query-to-group-them">Query to group them<a class="headerlink" href="#query-to-group-them" title="Permanent link">¬∂</a></h3> <div class="highlight"><span class="filename">Python</span><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="c1"># Group the results by Process</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">grouped_by_process_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">"ProcessCode"</span><span class="p">,</span> <span class="s2">"ProcessName"</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessID"</span><span class="p">),</span>
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ProcessDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessDescription"</span><span class="p">),</span>
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"TriggerPattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"TriggerPattern"</span><span class="p">),</span>
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"KeyParameterTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"KeyParameterTypeID"</span><span class="p">),</span>
<a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ImplementationInfo"</span><span class="p">),</span>
<a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"MaxConcurrency"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"MaxConcurrency"</span><span class="p">),</span>
<a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsParallelProcess"</span><span class="p">),</span>
<a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">),</span>
<a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">),</span>
<a href="#__codelineno-10-12" id="__codelineno-10-12" name="__codelineno-10-12"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-10-13" id="__codelineno-10-13" name="__codelineno-10-13"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">),</span>
<a href="#__codelineno-10-14" id="__codelineno-10-14" name="__codelineno-10-14"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">),</span>
<a href="#__codelineno-10-15" id="__codelineno-10-15" name="__codelineno-10-15"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">),</span>
<a href="#__codelineno-10-16" id="__codelineno-10-16" name="__codelineno-10-16"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">),</span>
<a href="#__codelineno-10-17" id="__codelineno-10-17" name="__codelineno-10-17"></a>    <span class="n">first</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">),</span>
<a href="#__codelineno-10-18" id="__codelineno-10-18" name="__codelineno-10-18"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-19" id="__codelineno-10-19" name="__codelineno-10-19"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepNameList"</span><span class="p">),</span>
<a href="#__codelineno-10-20" id="__codelineno-10-20" name="__codelineno-10-20"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-10-21" id="__codelineno-10-21" name="__codelineno-10-21"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-22" id="__codelineno-10-22" name="__codelineno-10-22"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SubProcessID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SubProcessIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-23" id="__codelineno-10-23" name="__codelineno-10-23"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepOrderList"</span><span class="p">),</span>
<a href="#__codelineno-10-24" id="__codelineno-10-24" name="__codelineno-10-24"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SourceDatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-25" id="__codelineno-10-25" name="__codelineno-10-25"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceDatasetValidationTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-26" id="__codelineno-10-26" name="__codelineno-10-26"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DestinationDatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DestinationDatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-27" id="__codelineno-10-27" name="__codelineno-10-27"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-28" id="__codelineno-10-28" name="__codelineno-10-28"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-29" id="__codelineno-10-29" name="__codelineno-10-29"></a>    <span class="n">collect_</span>
<a href="#__codelineno-10-30" id="__codelineno-10-30" name="__codelineno-10-30"></a>
<a href="#__codelineno-10-31" id="__codelineno-10-31" name="__codelineno-10-31"></a><span class="n">grouped_by_process_df</span> <span class="o">=</span> <span class="n">grouped_by_process_df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-10-32" id="__codelineno-10-32" name="__codelineno-10-32"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetNameList"</span><span class="p">),</span>
<a href="#__codelineno-10-33" id="__codelineno-10-33" name="__codelineno-10-33"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-10-34" id="__codelineno-10-34" name="__codelineno-10-34"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-35" id="__codelineno-10-35" name="__codelineno-10-35"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"NamePattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"NamePatternList"</span><span class="p">),</span>
<a href="#__codelineno-10-36" id="__codelineno-10-36" name="__codelineno-10-36"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"LocationPattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"LocationPatternList"</span><span class="p">),</span>
<a href="#__codelineno-10-37" id="__codelineno-10-37" name="__codelineno-10-37"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetKey"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetKeyList"</span><span class="p">),</span>
<a href="#__codelineno-10-38" id="__codelineno-10-38" name="__codelineno-10-38"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetSource"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetSourceList"</span><span class="p">),</span>
<a href="#__codelineno-10-39" id="__codelineno-10-39" name="__codelineno-10-39"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ConnectionDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ConnectionDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-10-40" id="__codelineno-10-40" name="__codelineno-10-40"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDateList"</span><span class="p">),</span>
<a href="#__codelineno-10-41" id="__codelineno-10-41" name="__codelineno-10-41"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDateList"</span><span class="p">),</span>
<a href="#__codelineno-10-42" id="__codelineno-10-42" name="__codelineno-10-42"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-10-43" id="__codelineno-10-43" name="__codelineno-10-43"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedByList"</span><span class="p">),</span>
<a href="#__codelineno-10-44" id="__codelineno-10-44" name="__codelineno-10-44"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-10-45" id="__codelineno-10-45" name="__codelineno-10-45"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedByList"</span><span class="p">),</span>
<a href="#__codelineno-10-46" id="__codelineno-10-46" name="__codelineno-10-46"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFromList"</span><span class="p">),</span>
<a href="#__codelineno-10-47" id="__codelineno-10-47" name="__codelineno-10-47"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidToList"</span><span class="p">),</span>
<a href="#__codelineno-10-48" id="__codelineno-10-48" name="__codelineno-10-48"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-49" id="__codelineno-10-49" name="__codelineno-10-49"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementNameList"</span><span class="p">),</span>
<a href="#__codelineno-10-50" id="__codelineno-10-50" name="__codelineno-10-50"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-10-51" id="__codelineno-10-51" name="__codelineno-10-51"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementOrderList"</span><span class="p">),</span>
<a href="#__codelineno-10-52" id="__codelineno-10-52" name="__codelineno-10-52"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DatasetElementType"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DatasetElementTypeList"</span><span class="p">),</span>
<a href="#__codelineno-10-53" id="__codelineno-10-53" name="__codelineno-10-53"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"IsRequired"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsRequiredList"</span><span class="p">),</span>
<a href="#__codelineno-10-54" id="__codelineno-10-54" name="__codelineno-10-54"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ProcessStepElementMappingID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ProcessStepElementMappingIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-55" id="__codelineno-10-55" name="__codelineno-10-55"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"DestinationElementID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"DestinationElementIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-56" id="__codelineno-10-56" name="__codelineno-10-56"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ElementSourceTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ElementSourceTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-57" id="__codelineno-10-57" name="__codelineno-10-57"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"Source"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"SourceList"</span><span class="p">),</span>
<a href="#__codelineno-10-58" id="__codelineno-10-58" name="__codelineno-10-58"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"EffectiveDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"EffectiveDateList"</span><span class="p">),</span>
<a href="#__codelineno-10-59" id="__codelineno-10-59" name="__codelineno-10-59"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ExpireDate"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ExpireDateList"</span><span class="p">),</span>
<a href="#__codelineno-10-60" id="__codelineno-10-60" name="__codelineno-10-60"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedDatetimeList"</span><span class="p">),</span>
<a href="#__codelineno-10-61" id="__codelineno-10-61" name="__codelineno-10-61"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"CreatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"CreatedByList"</span><span class="p">),</span>
<a href="#__codelineno-10-62" id="__codelineno-10-62" name="__codelineno-10-62"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedDatetime"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"</span>
<a href="#__codelineno-10-63" id="__codelineno-10-63" name="__codelineno-10-63"></a>
<a href="#__codelineno-10-64" id="__codelineno-10-64" name="__codelineno-10-64"></a>
<a href="#__codelineno-10-65" id="__codelineno-10-65" name="__codelineno-10-65"></a><span class="n">grouped_by_process_df</span> <span class="o">=</span> <span class="n">grouped_by_process_df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a href="#__codelineno-10-66" id="__codelineno-10-66" name="__codelineno-10-66"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"UpdatedBy"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"UpdatedByList"</span><span class="p">),</span>
<a href="#__codelineno-10-67" id="__codelineno-10-67" name="__codelineno-10-67"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidFrom"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidFromList"</span><span class="p">),</span>
<a href="#__codelineno-10-68" id="__codelineno-10-68" name="__codelineno-10-68"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ValidTo"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ValidToList"</span><span class="p">),</span>
<a href="#__codelineno-10-69" id="__codelineno-10-69" name="__codelineno-10-69"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-70" id="__codelineno-10-70" name="__codelineno-10-70"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionTypeDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionTypeDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-10-71" id="__codelineno-10-71" name="__codelineno-10-71"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionNameList"</span><span class="p">),</span>
<a href="#__codelineno-10-72" id="__codelineno-10-72" name="__codelineno-10-72"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-10-73" id="__codelineno-10-73" name="__codelineno-10-73"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"NamePattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"NamePatternList"</span><span class="p">),</span>
<a href="#__codelineno-10-74" id="__codelineno-10-74" name="__codelineno-10-74"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"LocationPattern"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"LocationPatternList"</span><span class="p">),</span>
<a href="#__codelineno-10-75" id="__codelineno-10-75" name="__codelineno-10-75"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterExpression"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterExpressionList"</span><span class="p">),</span>
<a href="#__codelineno-10-76" id="__codelineno-10-76" name="__codelineno-10-76"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ConnectionDescription"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ConnectionDescriptionList"</span><span class="p">),</span>
<a href="#__codelineno-10-77" id="__codelineno-10-77" name="__codelineno-10-77"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ActionParameterID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ActionParameterIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-78" id="__codelineno-10-78" name="__codelineno-10-78"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterName"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterNameList"</span><span class="p">),</span>
<a href="#__codelineno-10-79" id="__codelineno-10-79" name="__codelineno-10-79"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterValueTypeID"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterValueTypeIDList"</span><span class="p">),</span>
<a href="#__codelineno-10-80" id="__codelineno-10-80" name="__codelineno-10-80"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterValue"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterValueList"</span><span class="p">),</span>
<a href="#__codelineno-10-81" id="__codelineno-10-81" name="__codelineno-10-81"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"ParameterOrder"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"ParameterOrderList"</span><span class="p">),</span>
<a href="#__codelineno-10-82" id="__codelineno-10-82" name="__codelineno-10-82"></a>    <span class="n">collect_list</span><span class="p">(</span><span class="s2">"IsRequired"</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">"IsRequiredList"</span><span class="p">)</span>
<a href="#__codelineno-10-83" id="__codelineno-10-83" name="__codelineno-10-83"></a><span class="p">)</span>
<a href="#__codelineno-10-84" id="__codelineno-10-84" name="__codelineno-10-84"></a>
<a href="#__codelineno-10-85" id="__codelineno-10-85" name="__codelineno-10-85"></a><span class="n">In</span> <span class="n">this</span> <span class="n">example</span><span class="p">,</span> <span class="n">I</span><span class="s1">'m using the groupBy method to group the results by Process Code and Process Name, and using the agg method and the collect_list function to collect all the values for each unique Process Code and then group the resulting dataframe by process.</span>
<a href="#__codelineno-10-86" id="__codelineno-10-86" name="__codelineno-10-86"></a><span class="n">It</span><span class="s1">'s worth noting that this is just an example, you may need to adjust the code as per your use case.</span>
</code></pre></div> <h3 id="flow-diagram">Flow Diagram<a class="headerlink" href="#flow-diagram" title="Permanent link">¬∂</a></h3> <pre class="mermaid"><code>flowchart TD
    subgraph Process
        ProcessID(ProcessID) --&gt; ProcessCode(ProcessCode)
        ProcessCode --&gt; ProcessName(ProcessName)
        ProcessName --&gt; ProcessDescription(ProcessDescription)
        ProcessDescription --&gt; TriggerPattern(TriggerPattern)
        TriggerPattern --&gt; KeyParameterTypeID(KeyParameterTypeID)
        KeyParameterTypeID --&gt; ImplementationInfo(ImplementationInfo)
        ImplementationInfo --&gt; MaxConcurrency(MaxConcurrency)
        MaxConcurrency --&gt; IsParallelProcess(IsParallelProcess)
        IsParallelProcess --&gt; EffectiveDate(EffectiveDate)
        EffectiveDate --&gt; ExpireDate(ExpireDate)
        ExpireDate --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
        UpdatedBy --&gt; ValidFrom(ValidFrom)
        ValidFrom --&gt; ValidTo(ValidTo)
    end

    subgraph ProcessStep
        ProcessStepID(ProcessStepID) --&gt; ProcessID(ProcessID)
        ProcessID --&gt; ProcessStepName(ProcessStepName)
        ProcessStepName --&gt; ProcessStepDescription(ProcessStepDescription)
        ProcessStepDescription --&gt; ProcessStepTypeID(ProcessStepTypeID)
        ProcessStepTypeID --&gt; SubProcessID(SubProcessID)
        SubProcessID --&gt; ProcessStepOrder(ProcessStepOrder)
        ProcessStepOrder --&gt; SourceDatasetID(SourceDatasetID)
        SourceDatasetID --&gt; SourceDatasetValidationTypeID(SourceDatasetValidationTypeID)
        SourceDatasetValidationTypeID --&gt; DestinationDatasetID(DestinationDatasetID)
        DestinationDatasetID --&gt; ActionID(ActionID)
        ActionID --&gt; EffectiveDate(EffectiveDate)
        EffectiveDate --&gt; ExpireDate(ExpireDate)
        ExpireDate --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
        UpdatedBy --&gt; ValidFrom(ValidFrom)
        ValidFrom --&gt; ValidTo(ValidTo)
    end

    subgraph DataSet
        DatasetName --&gt; DatasetDescription(DatasetDescription)
        DatasetDescription --&gt; DatasetTypeID(DatasetTypeID)
        DatasetTypeID --&gt; NamePattern(NamePattern)
        NamePattern --&gt; LocationPattern(LocationPattern)
        LocationPattern --&gt; DatasetKey(DatasetKey)
        DatasetKey --&gt; DatasetSource(DatasetSource)
        DatasetSource --&gt; ConnectionDescription(ConnectionDescription)
        ConnectionDescription --&gt; EffectiveDate(EffectiveDate)
        EffectiveDate --&gt; ExpireDate(ExpireDate)
        ExpireDate --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
        UpdatedBy --&gt; ValidFrom(ValidFrom)
        ValidFrom --&gt; ValidTo(ValidTo)
    end

    subgraph DataSetElement
        DatasetElementID(DatasetElementID) --&gt; DatasetID(DatasetID)
        DatasetID --&gt; DatasetElementName(DatasetElementName)
        DatasetElementName --&gt; DatasetElementDescription(DatasetElementDescription)
        DatasetElementDescription --&gt; DatasetElementOrder(DatasetElementOrder)
        DatasetElementOrder --&gt; DatasetElementType(DatasetElementType)
        DatasetElementType --&gt; IsRequired(IsRequired)
        IsRequired --&gt; EffectiveDate(EffectiveDate)
        EffectiveDate --&gt; ExpireDate(ExpireDate)
        ExpireDate --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
        UpdatedBy --&gt; ValidFrom(ValidFrom)
        ValidFrom --&gt; ValidTo(ValidTo)
    end

    subgraph ProcessStepElementMapping
        ProcessStepElementMappingID(ProcessStepElementMappingID) --&gt; ProcessStepID(ProcessStepID)
        ProcessStepID --&gt; DestinationElementID(DestinationElementID)
        DestinationElementID --&gt; ElementSourceTypeID(ElementSourceTypeID)
        ElementSourceTypeID --&gt; Source(Source)
        Source --&gt; EffectiveDate(EffectiveDate)
        EffectiveDate --&gt; ExpireDate(ExpireDate)
        ExpireDate --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
        UpdatedBy --&gt; ValidFrom(ValidFrom)
        ValidFrom --&gt; ValidTo(ValidTo)
    end

    subgraph ActionType
        ActionTypeID(ActionTypeID) --&gt; ActionTypeDescription(ActionTypeDescription)
        ActionTypeDescription --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
    end

    subgraph Action
        NamePattern --&gt; LocationPattern(LocationPattern)
        LocationPattern --&gt; ParameterExpression(ParameterExpression)
        ParameterExpression --&gt; ConnectionDescription(ConnectionDescription)
        ConnectionDescription --&gt; EffectiveDate(EffectiveDate)
        EffectiveDate --&gt; ExpireDate(ExpireDate)
        ExpireDate --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
        UpdatedBy --&gt; ValidFrom(ValidFrom)
        ValidFrom --&gt; ValidTo(ValidTo)
    end

    subgraph ActionParameter
        ActionParameterID(ActionParameterID) --&gt; ActionID(ActionID)
        ActionID --&gt; ParameterName(ParameterName)
        ParameterName --&gt; ParameterValueTypeID(ParameterValueTypeID)
        ParameterValueTypeID --&gt; ParameterValue(ParameterValue)
        ParameterValue --&gt; ParameterOrder(ParameterOrder)
        ParameterOrder --&gt; IsRequired(IsRequired)
        IsRequired --&gt; EffectiveDate(EffectiveDate)
        EffectiveDate --&gt; ExpireDate(ExpireDate)
        ExpireDate --&gt; CreatedDatetime(CreatedDatetime)
        CreatedDatetime --&gt; CreatedBy(CreatedBy)
        CreatedBy --&gt; UpdatedDatetime(UpdatedDatetime)
        UpdatedDatetime --&gt; UpdatedBy(UpdatedBy)
    end
</code></pre> <div class="highlight"><span class="filename">Text Only</span><pre><span></span><code>Process --&gt; ProcessStep
ProcessStep --&gt; SubProcess
ProcessStep --&gt; DataSet
ProcessStep --&gt; Action
DataSet --&gt; DataSetElement
ProcessStep --&gt; ProcessStepElementMapping
ProcessStepElementMapping --&gt; DataSetElement
Action --&gt; ActionParameter
Action --&gt; ActionType
</code></pre></div> </article> </div> </div> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: üîì Synapse / PySpark problem and solutions" class="md-footer__link md-footer__link--prev" href="../../synapse/problem-solutions/" rel="prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Previous </span> üîì Synapse / PySpark problem and solutions </div> </div> </a> <a aria-label="Next: üîÖ Courses and Tutorials" class="md-footer__link md-footer__link--next" href="../../synapse/pyspark-courses/" rel="next"> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Next </span> üîÖ Courses and Tutorials </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest", "header.autohide"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src="../../assets/javascripts/bundle.8492ddcf.min.js"></script> <script src="../../assets/javascripts/extra.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body> </html>