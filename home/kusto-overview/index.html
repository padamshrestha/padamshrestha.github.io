<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Notes from day to day tasks" name="description"/><meta content="Padam Shrestha" name="author"/><link href="../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.5.3, mkdocs-material-8.5.7" name="generator"/><title>Kusto Query Language (KQL) - Blog</title><link href="../../assets/stylesheets/main.20d9efc8.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../assets/stylesheets/extra.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-08DR4DTC9K"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-08DR4DTC9K",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-08DR4DTC9K",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="indigo" data-md-color-primary="light-blue" data-md-color-scheme="slate" dir="ltr"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#kusto-query-language-kql"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="Blog" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Blog </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Kusto Query Language (KQL) </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="light-blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Blog" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2"> Synapse <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Synapse" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Synapse </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/build-dev-pyspark-cluster/"> üê≥ Build Development Spark cluster - PySpark, Delta Lake </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-dataframe-api/"> üìù PySpark Quickstart </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-cheat-sheet/"> üìÑ PySpark Cheat Sheet </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-azure-tables/"> ‚ú® Creating tables in PySpark Azure </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/spark-delta-partition/"> Creating partition in delta lake with spark </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/generate-stock-schema-delta-api/"> Design stock and option schema and provide fast api to access using spark delta </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/introduction/"> üìò Synapse Introduction </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/problem-solutions/"> üîì Synapse / PySpark problem and solutions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/data-dcitionary-pipeline/"> üß∫ Data dictionary for metadata driven Synapse pipeline </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-courses/"> üîÖ Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/links/"> üîó Synapse links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3"> Python <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Python" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Python </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-basics/"> üêç Python Basics </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/create-python-package/"> üì¶ Create Custom Python Package </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-courses/"> üìô Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/links/"> üîó Python links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4"> Dotnet <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Dotnet" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Dotnet </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-7/"> What's new in C# 7.0 through C# 7.3 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-8/"> What's new in C# 8.0 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-9/"> What's new in C# 9.0 - C# Guide </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-10/"> What's new in C# 10 - C# Guide </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-11/"> What's new in C# 11 - C# Guide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5"> Microservices <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Microservices" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Microservices </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/grafana-dashboards/"> Grafana Dashboards </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/azure-function-dapr/"> Azure function with Dapr to create event-driven, distributed application </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/dapr-resources/"> Resources </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/links/"> üîó Dapr links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6"> Serverless <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Serverless" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../serverless/links/"> üîó Azure Serverless links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7"> Azure <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Azure" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Azure </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../azure-resource-graph-explorer/"> Write query using Azure Resource Graph Explorer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../azure-keyboard-shortcuts/"> Azure Keyboard Shortcuts in Azure Portal </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../azure-service-fabric/"> Introduction to Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../starting-azure-service-fabric/"> Starting Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../azure/links/"> üîó Azure links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" id="__nav_8" type="checkbox"/> <label class="md-nav__link" for="__nav_8"> Spark <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Spark" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> Spark </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/jupyter-pyspark-docker/"> Run Jupyter for Pyspark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-learning/"> Spark Machine Learning </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker/"> Run and Debug Dotnet Spark application on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-ubuntu/"> Install Dotnet Spark on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker-ubuntu/"> Running Dotnet Spark applications on Ubuntu Continer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/install-docker-ubuntu2004/"> Install Docker on Ubuntu 20.04 LTS and Dotnet Spark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/python-learning/"> Learning Python </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/links/"> üîó Spark links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9"> Kusto <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Kusto" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Kusto </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> Kusto Query Language (KQL) <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> Kusto Query Language (KQL) </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#generic"> Generic </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#numerical-search"> Numerical search </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extract-values"> Extract values </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#string-search"> String search </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#named-expressions-and-user-defined-functions"> Named expressions and user-defined functions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#visualizations"> Visualizations </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#join-tables"> Join tables </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../dynamic-365-hcm-kusto/"> Troubleshoot using Kusto </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" id="__nav_10" type="checkbox"/> <label class="md-nav__link" for="__nav_10"> Angular <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Angular" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> Angular </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../deploy-angular-app-to-github-io-pages/"> Deploy Angular app to github.io pages </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11"> Tools and Tricks <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Tools and Tricks" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> Tools and Tricks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/fastapi-uvicorn/"> Configure Fast API with Uvicorn in Dockerfile </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/limited_access_pat_token/"> Create Git PAT token with limited access. </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/multiple-remote-git/"> Multiple remote git configuration for repository </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/chocolatey/"> Install and manage applications using Chocolatey </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/keyboard-shortcuts/"> Keyboard shortcuts for everyday tasks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/error-solutions/"> Everyday error and fixes </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/certificates/"> Searching and Installing Certificates </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-vscode-ubuntu/"> Install VS Code on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-brave-ubuntu2004/"> Install Brave browser on Ubuntu 20.04 LTS </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/useful-online-tools/"> ‚öí Useful online tools </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/helpful-links/"> üîó Helpful links </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/nuget/"> Nuget Package Manger </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/docker/"> üê≥ Installing and Running Docker in WSL with VS Code </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/dotnetcore-azurefunction-wsl/"> Install dotnet core 3.1 and azure-functions-core-tools on WSL </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/configure-publish-mkdocs-github/"> üìö Configure Mkdocs and Auto deploy to Github.io </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/rename-dotnet-3-6/"> Migrate Dotnet Core 3.1 to DotNet 6.0 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/git-help/"> Git </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-dotnet-sdk-armx64/"> Install dotnet skd on Mac m1 armx64 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/windows-tricks/"> Windows tricks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/linux-commands/"> Useful linux commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" id="__nav_12" type="checkbox"/> <label class="md-nav__link" for="__nav_12"> Courses, Projects, Tutorials, Blogs <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Courses, Projects, Tutorials, Blogs" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> Courses, Projects, Tutorials, Blogs </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/coursera/"> Coursera Courses </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/github_project/"> Github repo and projects </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" id="__nav_13" type="checkbox"/> <label class="md-nav__link" for="__nav_13"> Finance <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Finance" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> Finance </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../finance/use_of_ft/"> Fourier Transform in Price </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" id="__nav_14" type="checkbox"/> <label class="md-nav__link" for="__nav_14"> Random <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Random" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> Random </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../random/links/"> üîó Random useful links </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tags/"> Tags </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#generic"> Generic </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#numerical-search"> Numerical search </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extract-values"> Extract values </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#string-search"> String search </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#named-expressions-and-user-defined-functions"> Named expressions and user-defined functions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#visualizations"> Visualizations </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#join-tables"> Join tables </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="kusto-query-language-kql">Kusto Query Language (KQL)<a class="headerlink" href="#kusto-query-language-kql" title="Permanent link">¬∂</a></h1> <p>Official documentation <a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/">KQL Documentation</a> Course <a href="https://app.pluralsight.com/library/courses/kusto-query-language-kql-from-scratch/table-of-contents">Pluralsight course</a></p> <p><strong>what is KQL and where is it used?</strong> KQL is an open source language created by Microsoft to query big data sets stored in the Azure cloud. These queries can also be used in alerting rules. Some examples of services/products hosted in Azure that make use of KQL are: * Azure Data Explorer * Log Analytics * Sentinel (this is Microsoft‚Äôs cloud SIEM solution that makes use of a Log Analytics workspace as its backend) * Microsoft Defender ATP</p> <p>Sample or Demo queries can be tested at <a href="https://portal.azure.com/#blade/Microsoft_Azure_Monitoring_Logs/DemoLogsBlade">DemoLogs</a></p> <h2 id="generic">Generic<a class="headerlink" href="#generic" title="Permanent link">¬∂</a></h2> <p>A string literal with a backslash requires <strong>escaping</strong> by a backslash: <code>"a string literal with a \\ needs to be escaped"</code></p> <p>The same can be achieved using a <strong>verbatim string</strong> literal by putting the @ sign in front: <code>@"a verbatim string literal with a \\ that does not need to be escaped"</code></p> <p>More info on escaping string data types can be found <a href="[https://link](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/scalar-data-types/string)">here</a>.</p> <hr/> <p><strong>Add comments</strong> to your query with a double forward slash: <code>// This is a comment</code></p> <hr/> <p>The where <strong>operator and the pipe ( | ) delimiter</strong> are essential in writing KQL queries. </p> <p>where is used to filter rows from a table. In this example we filter on events from a source, the table SecurityEvent, where the column Computer is equal to "ContosoAppSrv1", and count the number of results: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>SecurityEvent<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span><span class="nv">Computer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"ContosoAppSrv1"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>count
</code></pre></div></p> <p>The pipe is used to separate data transformation operators. Such as: where Computer == "ContosoAppSrv1". The result can be piped to a new operator. For example, to count the number for rows: | count</p> <hr/> <p>Only include <strong>events from the last 24 hours</strong> using the ago() function: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>TimeGenerated<span class="w"> </span>&gt;<span class="w"> </span>ago<span class="o">(</span>24h<span class="o">)</span>
</code></pre></div></p> <p>For performance reasons always use time filters first in your query. The ago() function supports multiple types of timespans. More info can be found <a href="[https://link](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/scalar-data-types/timespan)">here</a>. For example: ‚Ä¢ 1d 1 day ‚Ä¢ 10m 10 minutes ‚Ä¢ 30s 30 seconds</p> <hr/> <p><strong>Select and customize the columns</strong> from the resulting table of your query with the project operator.</p> <p>‚Ä¢ Specify the <strong>columns to include</strong>: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>project<span class="w"> </span>TimeGenerated,<span class="w"> </span>EventID,<span class="w"> </span>Account,
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>Computer,<span class="w"> </span>LogonType
</code></pre></div></p> <p>‚Ä¢ <strong>Rename columns</strong>. In this example we renamed the column Account to UserName: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>project<span class="w"> </span>TimeGenerated,<span class="w"> </span>EventID,<span class="w"> </span><span class="nv">UserName</span><span class="w"> </span><span class="o">=</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>Account,<span class="w"> </span>Computer,<span class="w"> </span>LogonType
</code></pre></div></p> <p>‚Ä¢ <strong>Remove columns</strong> with project-away: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>project-away<span class="w"> </span>EventSourceName,<span class="w"> </span>Task,<span class="w"> </span>Level
</code></pre></div></p> <hr/> <p><strong>Add calculated columns</strong> to the result using the extend operator: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>extend<span class="w"> </span><span class="nv">EventAge</span><span class="o">=</span>now<span class="o">()</span>-TimeGenerated
</code></pre></div></p> <hr/> <p><strong>Count the number of records</strong> using the count operator: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>count
</code></pre></div></p> <hr/> <p><strong>Match based on conditions</strong> using <a href="[https://link](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/logicaloperators)">logical operators</a> . For example: ‚Ä¢ T | where EventID == 4624 and LogonType == 3 ‚Ä¢ T | where EventID == 4624 or EventID == 4625 ‚Ä¢ T | where (EventID == 4624 and LogonType == 3) or EventID == 4625</p> <hr/> <p><strong>Aggerate results</strong> from your query with the summarize operator: ‚Ä¢ Aggregate on multiple columns: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>summarize<span class="w"> </span>by<span class="w"> </span>Computer,<span class="w"> </span>Account
</code></pre></div></p> <p>‚Ä¢ Aggregate on multiple columns and return the count of the group: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>summarize<span class="w"> </span>count<span class="o">()</span><span class="w"> </span>by<span class="w"> </span>Computer,<span class="w"> </span>Account
</code></pre></div></p> <p>Besides count() many more very useful aggregation functions exist. An overview can be found <a href="[https://link](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/summarizeoperator#list-of-aggregation-functions)">here</a>.</p> <hr/> <p><strong>Sort the rows</strong> of the result using the sort operator: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span><span class="nv">EventID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4624</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>summarize<span class="w"> </span>count<span class="o">()</span><span class="w"> </span>by
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>AuthenticationPackageName<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>by<span class="w"> </span>count_
</code></pre></div></p> <p>By default, rows are sorted in descending order. Sorting in ascending order is also possible: ‚Ä¢ sort by count_ asc ‚Ä¢ Descending order: desc</p> <hr/> <p><strong>Concatenate values</strong>. The result will be a string data type: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>project<span class="w"> </span><span class="nv">example</span><span class="o">=</span>strcat<span class="o">(</span>EventID,<span class="w"> </span><span class="s2">" - "</span>,<span class="w"> </span>Channel<span class="o">)</span>
</code></pre></div></p> <p>A variable number of values can be passed through the strcat function. If values are not a string, they will be forcibly converted to a string.</p> <h2 id="numerical-search">Numerical search<a class="headerlink" href="#numerical-search" title="Permanent link">¬∂</a></h2> <p><strong>Search for a specific value</strong>: T | where EventID == 4688 ‚Ä¢ Not equal to: !=</p> <p>All of the numerical operators can be found <a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/numoperators">here</a>.</p> <hr/> <p>Search for a <strong>value less or greater than</strong>: T | where EventID == 4688 | summarize count() by Process | where count_ &lt; 5 ‚Ä¢ Greater: &gt; ‚Ä¢ Less or Equal: &lt;= ‚Ä¢ Greater or Equal: &gt;=</p> <hr/> <p>Match on <strong>multiple numeric values</strong>: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>EventID<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">(</span><span class="m">4624</span>,<span class="w"> </span><span class="m">4625</span><span class="o">)</span>
</code></pre></div></p> <hr/> <h2 id="extract-values">Extract values<a class="headerlink" href="#extract-values" title="Permanent link">¬∂</a></h2> <p><strong>Extract values from a string or JSON data</strong>. For example, extract the ‚Äúprocess name‚Äù using a regular expression (if you are less familiar with regular expressions have a look at the split and parse function): <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>SecurityAlert<span class="w"> </span><span class="p">|</span><span class="w"> </span>extend<span class="w"> </span><span class="nv">_ProcessName</span><span class="o">=</span>extract<span class="o">(</span><span class="s1">'"process</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="s1">name": "(.*)"'</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>ExtendedProperties<span class="o">)</span>
</code></pre></div></p> <p>Because the column ExtendedProperties contains JSON data you can also use the function extractjson(): <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>SecurityAlert<span class="w"> </span><span class="p">|</span><span class="w"> </span>extend<span class="w"> </span><span class="nv">_ProcessName</span><span class="w"> </span><span class="o">=</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>extractjson<span class="o">(</span><span class="s2">"</span>$<span class="s2">.process name"</span>,<span class="w"> </span>ExtendedProperties<span class="o">)</span>
</code></pre></div></p> <p>If you need to extract multiple elements from JSON data, stored as a string, you can use the function parse_json(). Use the dot notation if the data is of the type dictionary or a list of dictionaries in an array. One way to find out is through the gettype() function. To play with data stored as a dictionary have a look at the help cluster in the <a href="https://dataexplorer.azure.com/clusters/help/databases/Samples">Azure Data Explorer</a> (table: StormEvents, column: StormSummary).</p> <h2 id="string-search">String search<a class="headerlink" href="#string-search" title="Permanent link">¬∂</a></h2> <p><strong>Search across all tables and columns</strong>: search "<em>KEYWORD</em>" ‚Ä¢ Keep in mind that this is a performance intensive operation.</p> <hr/> <p><strong>Search for a specific value</strong>: T | where ProcessName == @"C:\Windows\System32\regsvr32.exe"</p> <hr/> <p>A <strong>not equal to match</strong> is done by adding an exclamation mark as prefix: ‚Ä¢ Equal to: == ‚Ä¢ Not equal to: != This is also supported in a similar way for other <a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/datatypes-string-operators">string operators</a></p> <hr/> <p>A <strong>case insensitive match</strong> can be achieved using a tilde: ‚Ä¢ Case sensitive: == ‚Ä¢ Case insensitive: =~ ‚Ä¢ Case insensitive and not equal to: !~ This is also supported in a similar way for other <a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/datatypes-string-operators">string operators</a>.</p> <hr/> <p>Match on values that <strong>contain a specific string</strong>: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>CommandLine<span class="w"> </span>contains<span class="w"> </span><span class="s2">"guest"</span>
</code></pre></div></p> <p>Because has is more performant, it‚Äôs advised to use has over contains when searching for full keywords. The following expression yields to true: ‚Ä¢ "North America" has "america"</p> <p>contains and has are case insensitive by default. A case sensitive match can be achieved by adding the suffix _cs: contains_cs / has_cs</p> <hr/> <p>Match on values <strong>starting with or ending with a specific string</strong>: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>Computer<span class="w"> </span>startswith<span class="w"> </span><span class="s2">"contoso"</span>
</code></pre></div> ‚Ä¢ Ending with a specific string: endswith</p> <p>startswith and endswith are case insensitive by default. A case sensitive match can be achieved by adding the suffix _cs: startswith_cs / endswith_cs</p> <hr/> <p><strong>Match on multiple string values</strong>: T | where Computer in ("ContosoAppSrv1", "ContosoSQLSrv1") ‚Ä¢ Not equal to: !in ‚Ä¢ Case insensitive: in~ ‚Ä¢ Case insensitive and not equal to: !in~</p> <hr/> <p>Match based on a <strong>regular expression</strong>: T | where Computer matches regex "^Contoso.*" ‚Ä¢ KQL uses the re2 library and also complies with that syntax. Troubleshooting your regex can be done on regex101.com. Select the regex Flavor ‚ÄúGolang‚Äù which also makes use of re2.</p> <p>A <strong>not equal to match</strong> can be done using the not() function: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>not<span class="o">(</span>Computer<span class="w"> </span>matches<span class="w"> </span>regex<span class="w"> </span><span class="s2">"^Contoso.*"</span><span class="o">)</span>
</code></pre></div></p> <p>A <strong>case insensitive match</strong> can be achieved by providing the i flag: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>Computer<span class="w"> </span>matches<span class="w"> </span>regex<span class="w"> </span><span class="s2">"(?i)^contoso.*"</span>
</code></pre></div></p> <h2 id="named-expressions-and-user-defined-functions">Named expressions and user-defined functions<a class="headerlink" href="#named-expressions-and-user-defined-functions" title="Permanent link">¬∂</a></h2> <p>Use the let statement to <strong>bind names to expressions</strong>. See below two examples of a named expression. Of course, much more complex expression can be created. Such as complete queries that can be nested inside another query (i.e. sub-query). For <strong>sub-queries</strong> consider the use of the materialize() function when the sub-query is called multiple times.</p> <p>Take into account the semicolon at the end of the let statement: <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="nb">let</span><span class="w"> </span><span class="nv">_SearchWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ago<span class="o">(</span>24h<span class="o">)</span><span class="p">;</span>
<a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>TimeGenerated<span class="w"> </span>&gt;<span class="w"> </span>_SearchWindow
<a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a>
<a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="nb">let</span><span class="w"> </span><span class="nv">_computers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>dynamic<span class="o">([</span><span class="s2">"ContosoAppSrv1"</span>,
<a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="s2">"ContosoSQLSrv1"</span><span class="o">])</span><span class="p">;</span>
<a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a>T<span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span>Computer<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">(</span>_computers<span class="o">)</span>
</code></pre></div></p> <p>The let statement can be used in many other useful ways. Such as to create <strong>user-defined functions</strong>. More info on the let statement can be found <a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/letstatement">here</a>.</p> <h2 id="visualizations">Visualizations<a class="headerlink" href="#visualizations" title="Permanent link">¬∂</a></h2> <p>The render operator can be used to create visualizations. Besides the below example, more types of visualizations are possible. More info can be found <a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/renderoperator?pivots=azuredataexplorer">here</a>. (Pie charts are not the most telling graphics, but the support for the render operator is limited on the demo environment.)</p> <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a>SecurityAlert<span class="w"> </span><span class="p">|</span>
<a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a>summarize<span class="w"> </span><span class="nv">Count</span><span class="o">=</span>count<span class="o">()</span><span class="w"> </span>by<span class="w"> </span><span class="nv">Alert</span><span class="o">=</span>strcat<span class="o">(</span>DisplayName,
<a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="s2">" ("</span>,<span class="w"> </span>toupper<span class="o">(</span>AlertSeverity<span class="o">)</span>,<span class="w"> </span><span class="s2">")"</span><span class="o">)</span>
<a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>by<span class="w"> </span>Count<span class="w"> </span><span class="p">|</span><span class="w"> </span>render<span class="w"> </span>piechart
</code></pre></div> <h2 id="join-tables">Join tables<a class="headerlink" href="#join-tables" title="Permanent link">¬∂</a></h2> <p>KQL has the ability to join tables. In this example, we join some of the events in the SecurityAlert table with process creation events (event ID 4688) from the SecurityEvent table. More information on joining tables can be found <a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/joinoperator?pivots=azuredataexplorer">here</a>.</p> <p>This query serves purely as an example to explain the join operator because all process data is contained within the column Entities of the SecurityAlert table</p> <div class="highlight"><span class="filename">Bash</span><pre><span></span><code><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a>SecurityAlert<span class="w"> </span><span class="p">|</span>
<a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a>extend<span class="w"> </span><span class="nv">_ProcessId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>extractjson<span class="o">(</span><span class="s2">"</span>$<span class="s2">.process id"</span>,
<a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a>ExtendedProperties<span class="o">)</span>,
<a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="nv">_ProcessCommandLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tolower<span class="o">(</span>extractjson<span class="o">(</span><span class="s2">"</span>$<span class="s2">.command</span>
<a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="s2">line"</span>,<span class="w"> </span>ExtendedProperties<span class="o">))</span>,
<a href="#__codelineno-20-6" id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="nv">_HostName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tolower<span class="o">(</span>extractjson<span class="o">(</span><span class="s2">"</span>$<span class="s2">[0].HostName"</span>,
<a href="#__codelineno-20-7" id="__codelineno-20-7" name="__codelineno-20-7"></a>Entities<span class="o">))</span>
<a href="#__codelineno-20-8" id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="p">|</span><span class="w"> </span>join<span class="w"> </span><span class="nv">kind</span><span class="o">=</span>inner<span class="w"> </span><span class="o">(</span>
<a href="#__codelineno-20-9" id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="w"> </span>SecurityEvent
<a href="#__codelineno-20-10" id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>where<span class="w"> </span><span class="nv">EventID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4688</span>
<a href="#__codelineno-20-11" id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>extend<span class="w"> </span><span class="nv">_HostName</span><span class="o">=</span>tolower<span class="o">(</span>Computer<span class="o">)</span>
<a href="#__codelineno-20-12" id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>extend<span class="w"> </span><span class="nv">_ProcessCommandLine</span><span class="o">=</span>tolower<span class="o">(</span>CommandLine<span class="o">)</span>
<a href="#__codelineno-20-13" id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="o">)</span><span class="w"> </span>on<span class="w"> </span><span class="nv">$left</span>._ProcessId<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">$right</span>.NewProcessId,
<a href="#__codelineno-20-14" id="__codelineno-20-14" name="__codelineno-20-14"></a>_HostName,<span class="w"> </span>_ProcessCommandLine
</code></pre></div> </article> </div> </div> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: üîó Spark links" class="md-footer__link md-footer__link--prev" href="../../spark/links/" rel="prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Previous </span> üîó Spark links </div> </div> </a> <a aria-label="Next: Troubleshoot using Kusto" class="md-footer__link md-footer__link--next" href="../dynamic-365-hcm-kusto/" rel="next"> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Next </span> Troubleshoot using Kusto </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest", "header.autohide"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src="../../assets/javascripts/bundle.8492ddcf.min.js"></script> <script src="../../assets/javascripts/extra.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body> </html>