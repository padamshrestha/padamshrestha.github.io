<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Notes from day to day tasks" name="description"/><meta content="Padam Shrestha" name="author"/><link href="../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.5.3, mkdocs-material-8.5.7" name="generator"/><title>Ichimoku Cloud Master - Blog</title><link href="../../assets/stylesheets/main.20d9efc8.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../assets/stylesheets/extra.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-08DR4DTC9K"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-08DR4DTC9K",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-08DR4DTC9K",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="indigo" data-md-color-primary="light-blue" data-md-color-scheme="slate" dir="ltr"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#ichimoku-cloud-master"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="Blog" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Blog </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Ichimoku Cloud Master </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="light-blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Blog" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2"> Synapse <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Synapse" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Synapse </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/build-dev-pyspark-cluster/"> üê≥ Build Development Spark cluster - PySpark, Delta Lake </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-dataframe-api/"> üìù PySpark Quickstart </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-cheat-sheet/"> üìÑ PySpark Cheat Sheet </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-azure-tables/"> ‚ú® Creating tables in PySpark Azure </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/spark-delta-partition/"> Creating partition in delta lake with spark </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/generate-stock-schema-delta-api/"> Design stock and option schema and provide fast api to access using spark delta </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/introduction/"> üìò Synapse Introduction </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/problem-solutions/"> üîì Synapse / PySpark problem and solutions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/data-dcitionary-pipeline/"> üß∫ Data dictionary for metadata driven Synapse pipeline </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-courses/"> üîÖ Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/links/"> üîó Synapse links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3"> Python <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Python" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Python </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-basics/"> üêç Python Basics </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/create-python-package/"> üì¶ Create Custom Python Package </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-courses/"> üìô Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/links/"> üîó Python links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4"> Dotnet <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Dotnet" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Dotnet </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-7/"> What's new in C# 7.0 through C# 7.3 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-8/"> What's new in C# 8.0 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-9/"> What's new in C# 9.0 - C# Guide </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-10/"> What's new in C# 10 - C# Guide </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../csharp/csharp-11/"> What's new in C# 11 - C# Guide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5"> Microservices <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Microservices" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Microservices </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/grafana-dashboards/"> Grafana Dashboards </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/azure-function-dapr/"> Azure function with Dapr to create event-driven, distributed application </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/dapr-resources/"> Resources </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/links/"> üîó Dapr links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6"> Serverless <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Serverless" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../serverless/links/"> üîó Azure Serverless links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7"> Azure <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Azure" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Azure </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-resource-graph-explorer/"> Write query using Azure Resource Graph Explorer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-keyboard-shortcuts/"> Azure Keyboard Shortcuts in Azure Portal </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-service-fabric/"> Introduction to Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/starting-azure-service-fabric/"> Starting Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../azure/links/"> üîó Azure links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" id="__nav_8" type="checkbox"/> <label class="md-nav__link" for="__nav_8"> Spark <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Spark" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> Spark </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/jupyter-pyspark-docker/"> Run Jupyter for Pyspark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-learning/"> Spark Machine Learning </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker/"> Run and Debug Dotnet Spark application on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-ubuntu/"> Install Dotnet Spark on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker-ubuntu/"> Running Dotnet Spark applications on Ubuntu Continer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/install-docker-ubuntu2004/"> Install Docker on Ubuntu 20.04 LTS and Dotnet Spark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/python-learning/"> Learning Python </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/links/"> üîó Spark links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9"> Kusto <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Kusto" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Kusto </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/kusto-overview/"> Kusto Query Language (KQL) </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/dynamic-365-hcm-kusto/"> Troubleshoot using Kusto </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" id="__nav_10" type="checkbox"/> <label class="md-nav__link" for="__nav_10"> Angular <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Angular" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> Angular </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/deploy-angular-app-to-github-io-pages/"> Deploy Angular app to github.io pages </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11"> Tools and Tricks <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Tools and Tricks" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> Tools and Tricks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/fastapi-uvicorn/"> Configure Fast API with Uvicorn in Dockerfile </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/limited_access_pat_token/"> Create Git PAT token with limited access. </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/multiple-remote-git/"> Multiple remote git configuration for repository </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/chocolatey/"> Install and manage applications using Chocolatey </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/keyboard-shortcuts/"> Keyboard shortcuts for everyday tasks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/error-solutions/"> Everyday error and fixes </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/certificates/"> Searching and Installing Certificates </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-vscode-ubuntu/"> Install VS Code on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-brave-ubuntu2004/"> Install Brave browser on Ubuntu 20.04 LTS </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/useful-online-tools/"> ‚öí Useful online tools </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/helpful-links/"> üîó Helpful links </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/nuget/"> Nuget Package Manger </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/docker/"> üê≥ Installing and Running Docker in WSL with VS Code </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/dotnetcore-azurefunction-wsl/"> Install dotnet core 3.1 and azure-functions-core-tools on WSL </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/configure-publish-mkdocs-github/"> üìö Configure Mkdocs and Auto deploy to Github.io </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/rename-dotnet-3-6/"> Migrate Dotnet Core 3.1 to DotNet 6.0 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/git-help/"> Git </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-dotnet-sdk-armx64/"> Install dotnet skd on Mac m1 armx64 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/windows-tricks/"> Windows tricks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/linux-commands/"> Useful linux commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" id="__nav_12" type="checkbox"/> <label class="md-nav__link" for="__nav_12"> Courses, Projects, Tutorials, Blogs <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Courses, Projects, Tutorials, Blogs" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> Courses, Projects, Tutorials, Blogs </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/coursera/"> Coursera Courses </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/github_project/"> Github repo and projects </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" id="__nav_13" type="checkbox"/> <label class="md-nav__link" for="__nav_13"> Finance <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Finance" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> Finance </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../finance/use_of_ft/"> Fourier Transform in Price </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" id="__nav_14" type="checkbox"/> <label class="md-nav__link" for="__nav_14"> Random <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Random" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> Random </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../random/links/"> üîó Random useful links </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tags/"> Tags </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#explanation-of-script"> Explanation of script: </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#signals"> Signals: </a> <nav aria-label="Signals:" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#customisation"> Customisation: </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#the-perfect-entry"> The perfect entry? </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="ichimoku-cloud-master">Ichimoku Cloud Master<a class="headerlink" href="#ichimoku-cloud-master" title="Permanent link">¬∂</a></h1> <p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../../assets/images/20230916024414.png"><img alt="" src="../../assets/images/20230916024414.png"/></a></p> <p>Ichimoku Cloud Master aims to provide the ichimoku trader with easy alert functionality to not miss out on valuable trade setups. The key purpose of this script is to better visualise crucial moments in Ichimoku trading. These alerts should not be used for botting in my opinion as they always need a human to confirm the ichimoku market structure. For example, is the Kijun-Sen flat and too far away from price? A good ichimoku trader will not enter at such a point in time.</p> <h2 id="explanation-of-script">Explanation of script:<a class="headerlink" href="#explanation-of-script" title="Permanent link">¬∂</a></h2> <p>Chikou(lagging span): pink line, this is price plotted 26 bars ago. People ignore the power of this it is crucial to see how chikou behaves towards past price action as seen in the chart below where we got an entry at red arrow because chikou bounced from past fractal bottom.</p> <p>Kijun-Sen(base line): Black line or color coded line. This is the equilibrium of last 26 candles. To me this is the most important line in the system as it attracts price. Kijun = (Highest high of 26 periods + Lowest low of 26 periods) √∑ 2</p> <p>Tenkan-Sen(conversion line): Blue line. This is the equilibrium of last 9 candles. In a strong uptrend price stays above this line. Tenkan = (Highest high of 9 periods + Lowest low of 9 periods) √∑ 2</p> <p>Senkou A (Leading span A)= Pink cloud line, this is the average of the 2 components projected 26 bars in the future. Senkou A = (Tenkan + Kijun) √∑ 2</p> <p>Senkou B (Leading span B) = Green cloud line, this is the 52 day equilibrium projected 26 bars in the future. Senkou B = (Highest high of prior 52 periods + Lowest low of prior 52 periods) √∑ 2</p> <p>Notice how the distance between Chikou and the cloud is also 52 bars. This is all part of Hosoda's numbers which I am not going to explain here.</p> <p>Fractals: These are the black triangles you find at key turning point. If you want to know how they work reseach williams fractals. I've used fractals with a period of 9 as it is an ichimoku number. These fractals are useful when working with ichimoku wave theory. Again I will not explain that here but in further education</p> <p>Fractal Support: Ability to extend lines from the fractals which can be used as an entry/exit mechanism in your trading. For example wait for tenkan to cross kijun and then enter on fractal breakout.</p> <h2 id="signals">Signals:<a class="headerlink" href="#signals" title="Permanent link">¬∂</a></h2> <p>Crossing of Chikou (lagging span) with past Kijun-Sen: this will color code the Bars / Kijun-Sen (you can turn this off in options) The script also has a signal for this, this will be the green and purple diamonds. Where green is bullish and purple is bearish. wy is this important? When current price plotted 26 candles back (chikou) crosses over the past equilibrium (kijun-sen) this usualy means price has moved past resistance levels where sellers come in. This indicates a switch in market structure and price is bullish from this point, this is the same in the other direction.</p> <p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../../assets/images/20230916022918.png"><img alt="" src="../../assets/images/20230916022918.png"/></a></p> <p>Kumo Twist: when the kumo cloud (future) has a crossover from for example green to red (bull to bear). The script plots these using the colored cross symbols as seen in the picture above. A chikou cross + a Kumo twist at same bar of next to eachother below the cloud can be a great entry sign: this would be an entry after cross in the chart above.</p> <p>Kijun Bounce: when in an uptrend the price retraces back to Kijun-Sen and starts to go back up. These are marked by the yellow circles as seen in chart below: low below Kijun-Sen and close above it</p> <p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../../assets/images/20230916022955.png"><img alt="" src="../../assets/images/20230916022955.png"/></a></p> <p>trong Trend: when Tenkan is above Kijun, price above cloud, future cloud green, chikou above close, chikou above Kijun we establish a strong bullish trend. For bearish the exact opposite. The script has a function to send an alert at the start of such trends and to plot them with small colored circles above the bars.</p> <h3 id="customisation">Customisation:<a class="headerlink" href="#customisation" title="Permanent link">¬∂</a></h3> <p>I've added options to disable specific aspects of the indicator for those traders who do not want to use all aspects of the indicator. In the customisation tab I've given each part a clear title so you can use your own colors/shapes.</p> <p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../../assets/images/20230916023039.png"><img alt="" src="../../assets/images/20230916023039.png"/></a></p> <h3 id="the-perfect-entry">The perfect entry?<a class="headerlink" href="#the-perfect-entry" title="Permanent link">¬∂</a></h3> <p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../../assets/images/20230916023104.png"><img alt="" src="../../assets/images/20230916023104.png"/></a></p> <p>Further info: Look into my education pane, I will be adding education in the future. The chance of me making a more advanced version of the script including line forecasting etc is rather high so watch out for that.</p> <p>For those who want to master this system I recommend reading the book: How to make money with the ichimoku system by Balkrishna M. Sadekar Or the originals books by Hosoda the inventor of Ichimoku if you can get your hands on them and can read Japanese. Almost all info about the ichimoku system you find on the internet will lose you money because they reduce the system to simple signals that do not generate money. I will be providing educational material on tradingview using this indicator.</p> <div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1">//@version=5</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nx">indicator</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s1">'Ichimoku Cloud Master'</span><span class="p">,</span><span class="w"> </span><span class="nx">shorttitle</span><span class="o">=</span><span class="s1">'Ichimoku Master'</span><span class="p">,</span><span class="w"> </span><span class="nx">overlay</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">timeframe</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="nx">timeframe_gaps</span><span class="o">=</span><span class="kc">false</span><span class="p">)</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="c1">//----------[ Ichimoku Basic Script</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="c1">//inputs</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="nx">tenkanPeriods</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">9</span><span class="p">,</span><span class="w">  </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Tenkan-Sen Length'</span><span class="p">,</span><span class="w">                               </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="nx">kijunPeriods</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">26</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Kijun-Sen Length'</span><span class="p">,</span><span class="w">                                </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="nx">laggingSpan2Periods</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">52</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Senkou Span B Length'</span><span class="p">,</span><span class="w">                            </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="nx">displacement</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">26</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Displacement'</span><span class="p">,</span><span class="w">                                    </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="nx">useBarColor</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w">        </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Bar Colored by Chikou'</span><span class="p">,</span><span class="w">                           </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="nx">usekijunChikouColors</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w">       </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kijun Colored by Chikou"</span><span class="p">,</span><span class="w">                         </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="nx">useKumoMid</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w">       </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Kumo Middle'</span><span class="p">,</span><span class="w">                                     </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="nx">useCloseInstead</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w">       </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Use close Instead of Kijun for Chikou Crossover'</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Ichimoku'</span><span class="p">)</span>
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="nx">useChikouCross</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w">        </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Chikou/Kijun Crossover'</span><span class="p">,</span><span class="w">                          </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Conditions'</span><span class="p">)</span>
<a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="nx">useKumoTwist</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w">        </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Kumo Twists'</span><span class="p">,</span><span class="w">                                     </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Conditions'</span><span class="p">)</span>
<a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="nx">useKijunBounce</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w">        </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Kijun Bounce'</span><span class="p">,</span><span class="w">                                    </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Conditions'</span><span class="p">)</span>
<a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="nx">useTrendDetector</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w">       </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Strong Trend'</span><span class="p">,</span><span class="w">                                    </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Conditions'</span><span class="p">)</span>
<a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="c1">//Calculations</span>
<a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="nx">donchian</span><span class="p">(</span><span class="nx">len</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="nx">math</span><span class="p">.</span><span class="nx">avg</span><span class="p">(</span><span class="nx">ta</span><span class="p">.</span><span class="nx">lowest</span><span class="p">(</span><span class="nx">len</span><span class="p">),</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">highest</span><span class="p">(</span><span class="nx">len</span><span class="p">))</span>
<a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="nx">tenkanSen</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="nx">donchian</span><span class="p">(</span><span class="nx">tenkanPeriods</span><span class="p">)</span>
<a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="nx">kijunSen</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="nx">donchian</span><span class="p">(</span><span class="nx">kijunPeriods</span><span class="p">)</span>
<a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="nx">senkouSpanA</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">avg</span><span class="p">(</span><span class="nx">tenkanSen</span><span class="p">,</span><span class="w"> </span><span class="nx">kijunSen</span><span class="p">)</span>
<a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="nx">senkouSpanB</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nx">donchian</span><span class="p">(</span><span class="nx">laggingSpan2Periods</span><span class="p">)</span>
<a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="nx">isChikouAboveKijun</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nx">useCloseInstead</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">close</span><span class="o">&gt;</span><span class="nx">close</span><span class="p">[</span><span class="mf">26</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">kijunSen</span><span class="p">[</span><span class="mf">26</span><span class="p">]</span>
<a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="nx">chikouColor</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="o">&gt;</span><span class="nx">open</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">255</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="o">&lt;</span><span class="nx">open</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">100</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">)</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="o">&lt;</span><span class="nx">open</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">238</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">238</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">)</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="o">&gt;</span><span class="nx">open</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">75</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">130</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span>
<a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="nx">chikouColor2</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">255</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">255</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="c1">//Plotting</span>
<a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">tenkanSen</span><span class="p">,</span><span class="w">        </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">255</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span><span class="w">                                                                                                                  </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Tenkan-Sen'</span><span class="p">)</span>
<a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">kijunSen</span><span class="p">,</span><span class="w">         </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">usekijunChikouColors</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">chikouColor2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span><span class="w">                                                                              </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Kijun-Sen'</span><span class="p">)</span>
<a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w">            </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">238</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">238</span><span class="p">,</span><span class="mf">20</span><span class="p">),</span><span class="w"> </span><span class="nx">offset</span><span class="o">=-</span><span class="nx">displacement</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w">                                                                                   </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Chikou Span'</span><span class="p">)</span>
<a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="nx">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">(</span><span class="nx">senkouSpanA</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">238</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">238</span><span class="p">),</span><span class="w">    </span><span class="nx">offset</span><span class="o">=</span><span class="nx">displacement</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w">                                                                                    </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Senkou Span A'</span><span class="p">)</span>
<a href="#__codelineno-0-34" id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="nx">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">(</span><span class="nx">senkouSpanB</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">100</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span><span class="w">        </span><span class="nx">offset</span><span class="o">=</span><span class="nx">displacement</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w">                                                                                    </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Senkou Span B'</span><span class="p">)</span>
<a href="#__codelineno-0-35" id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="nx">kumoCloudFillUpColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">189</span><span class="p">,</span><span class="mf">209</span><span class="p">,</span><span class="mf">186</span><span class="p">,</span><span class="mf">70</span><span class="p">),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kumo Fill Up Color"</span><span class="p">)</span>
<a href="#__codelineno-0-36" id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="nx">kumoCloudFillDownColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">230</span><span class="p">,</span><span class="mf">187</span><span class="p">,</span><span class="mf">189</span><span class="p">,</span><span class="mf">70</span><span class="p">),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kumo Fill Dowan Color"</span><span class="p">)</span>
<a href="#__codelineno-0-37" id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="nx">fill</span><span class="p">(</span><span class="nx">p1</span><span class="p">,</span><span class="w"> </span><span class="nx">p2</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">senkouSpanA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">senkouSpanB</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">kumoCloudFillUpColor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">kumoCloudFillDownColor</span><span class="p">)</span>
<a href="#__codelineno-0-38" id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="c1">//----------] End of Ichimoku Basic Script</span>
<a href="#__codelineno-0-39" id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a href="#__codelineno-0-40" id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a href="#__codelineno-0-41" id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="c1">//----------[ Start of Williams Fractals</span>
<a href="#__codelineno-0-42" id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="c1">// Define "n" as the number of periods and keep a minimum value of 2 for error handling.</span>
<a href="#__codelineno-0-43" id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="nx">n</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="nx">defval</span><span class="o">=</span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Fractal Periods'</span><span class="p">,</span><span class="w">       </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Williams Fractals'</span><span class="p">)</span>
<a href="#__codelineno-0-44" id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="nx">useFractals</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w">              </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Fractals"</span><span class="p">,</span><span class="w">              </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Williams Fractals'</span><span class="p">)</span>
<a href="#__codelineno-0-45" id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="nx">showFractalSupport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w">                  </span><span class="nx">title</span><span class="o">=</span><span class="s1">'show Fractal Support?'</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="o">=</span><span class="s1">'Williams Fractals'</span><span class="p">)</span>
<a href="#__codelineno-0-46" id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="c1">// UpFractal</span>
<a href="#__codelineno-0-47" id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">upflagDownFrontier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-48" id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">upflagUpFrontier0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-49" id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">upflagUpFrontier1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-50" id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">upflagUpFrontier2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-51" id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">upflagUpFrontier3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-52" id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">upflagUpFrontier4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-53" id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a href="#__codelineno-0-54" id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-0-55" id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="nx">upflagDownFrontier</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">upflagDownFrontier</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-56" id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="nx">upflagUpFrontier0</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">upflagUpFrontier0</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-57" id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="w">    </span><span class="nx">upflagUpFrontier1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">upflagUpFrontier1</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-58" id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="nx">upflagUpFrontier2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">upflagUpFrontier2</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-59" id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="nx">upflagUpFrontier3</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">upflagUpFrontier3</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-60" id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="nx">upflagUpFrontier4</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">upflagUpFrontier4</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-61" id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="w">    </span><span class="nx">upflagUpFrontier4</span>
<a href="#__codelineno-0-62" id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="nx">flagUpFrontier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">upflagUpFrontier0</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">upflagUpFrontier1</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">upflagUpFrontier2</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">upflagUpFrontier3</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">upflagUpFrontier4</span>
<a href="#__codelineno-0-63" id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a href="#__codelineno-0-64" id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="nx">upFractal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">upflagDownFrontier</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">flagUpFrontier</span>
<a href="#__codelineno-0-65" id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a href="#__codelineno-0-66" id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="c1">// downFractal</span>
<a href="#__codelineno-0-67" id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">downflagDownFrontier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-68" id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">downflagUpFrontier0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-69" id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">downflagUpFrontier1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-70" id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">downflagUpFrontier2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-71" id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">downflagUpFrontier3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-72" id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="nx">bool</span><span class="w"> </span><span class="nx">downflagUpFrontier4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-0-73" id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a href="#__codelineno-0-74" id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-0-75" id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="w">    </span><span class="nx">downflagDownFrontier</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">downflagDownFrontier</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-76" id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="nx">downflagUpFrontier0</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">downflagUpFrontier0</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-77" id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="nx">downflagUpFrontier1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">downflagUpFrontier1</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-78" id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="nx">downflagUpFrontier2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">downflagUpFrontier2</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-79" id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="w">    </span><span class="nx">downflagUpFrontier3</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">downflagUpFrontier3</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-80" id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="nx">downflagUpFrontier4</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">downflagUpFrontier4</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span>
<a href="#__codelineno-0-81" id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">    </span><span class="nx">downflagUpFrontier4</span>
<a href="#__codelineno-0-82" id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="nx">flagDownFrontier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">downflagUpFrontier0</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">downflagUpFrontier1</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">downflagUpFrontier2</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">downflagUpFrontier3</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">downflagUpFrontier4</span>
<a href="#__codelineno-0-83" id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a href="#__codelineno-0-84" id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="nx">downFractal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">downflagDownFrontier</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">flagDownFrontier</span>
<a href="#__codelineno-0-85" id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a href="#__codelineno-0-86" id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="c1">//Plotting</span>
<a href="#__codelineno-0-87" id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="nx">lastUpFractal</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">valuewhen</span><span class="p">(</span><span class="nx">upFractal</span><span class="p">,</span><span class="w">  </span><span class="nx">high</span><span class="p">[</span><span class="nx">n</span><span class="p">],</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-0-88" id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="nx">lastDownFractal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">valuewhen</span><span class="p">(</span><span class="nx">downFractal</span><span class="p">,</span><span class="w"> </span><span class="nx">low</span><span class="p">[</span><span class="nx">n</span><span class="p">],</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-0-89" id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="nx">pFractalUp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">(</span><span class="nx">showFractalSupport</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">lastUpFractal</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_circles</span><span class="p">,</span><span class="w">                                             </span><span class="nx">offset</span><span class="o">=-</span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span><span class="w">    </span><span class="nx">title</span><span class="o">=</span><span class="s1">'last Up Fractal'</span><span class="p">)</span>
<a href="#__codelineno-0-90" id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="nx">pFractalDown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">(</span><span class="nx">showFractalSupport</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">lastDownFractal</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_circles</span><span class="p">,</span><span class="w">                                             </span><span class="nx">offset</span><span class="o">=-</span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span><span class="w">    </span><span class="nx">title</span><span class="o">=</span><span class="s1">'last Down Fractal'</span><span class="p">)</span>
<a href="#__codelineno-0-91" id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useFractals</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">downFractal</span><span class="p">,</span><span class="w">                                      </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">triangledown</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">belowbar</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">tiny</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="o">=-</span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">80</span><span class="p">),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Down Fractal"</span><span class="p">)</span>
<a href="#__codelineno-0-92" id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useFractals</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">upFractal</span><span class="p">,</span><span class="w">                                        </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">triangleup</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w">   </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">tiny</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="o">=-</span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">80</span><span class="p">),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Up Fractal"</span><span class="p">)</span>
<a href="#__codelineno-0-93" id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="c1">//----------] End of Williams Fractals</span>
<a href="#__codelineno-0-94" id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="c1">// Plot Buy and Sell Signals</span>
<a href="#__codelineno-0-95" id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="c1">// plotshape(useFractals and downFractal, title="Sell Signal", color=color.green, style=shape.labeldown, location=location.belowbar, text="Buy", offset=-n)</span>
<a href="#__codelineno-0-96" id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="c1">// plotshape(useFractals and upFractal, title="Buy Signal", color=color.red, style=shape.labelup, location=location.abovebar, text="Sell", offset=-n)</span>
<a href="#__codelineno-0-97" id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="c1">// Alert Fractals</span>
<a href="#__codelineno-0-98" id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">downFractal</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Down Fractal Alert"</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">=</span><span class="s2">"Down Fractal Detected. Consider Buying."</span><span class="p">)</span>
<a href="#__codelineno-0-99" id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">upFractal</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Up Fractal Alert"</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">=</span><span class="s2">"Up Fractal Detected. Consider Selling."</span><span class="p">)</span>
<a href="#__codelineno-0-100" id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a href="#__codelineno-0-101" id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="c1">//----------[ Ichimoku Logical Parameters</span>
<a href="#__codelineno-0-102" id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="nx">isTenkanAboveKijun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tenkanSen</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">kijunSen</span>
<a href="#__codelineno-0-103" id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="nx">isCloseAboveTenkan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">tenkanSen</span>
<a href="#__codelineno-0-104" id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="nx">isCloseAboveKijun</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">kijunSen</span>
<a href="#__codelineno-0-105" id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="nx">kumoTwistUp</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossover</span><span class="p">(</span><span class="nx">senkouSpanA</span><span class="p">,</span><span class="w"> </span><span class="nx">senkouSpanB</span><span class="p">)</span>
<a href="#__codelineno-0-106" id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="nx">kumoTwistDown</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossunder</span><span class="p">(</span><span class="nx">senkouSpanA</span><span class="p">,</span><span class="w"> </span><span class="nx">senkouSpanB</span><span class="p">)</span>
<a href="#__codelineno-0-107" id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="nx">tenkanCrossUp</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossover</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">tenkanSen</span><span class="p">)</span>
<a href="#__codelineno-0-108" id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="nx">tenkanCrossDown</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossunder</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">tenkanSen</span><span class="p">)</span>
<a href="#__codelineno-0-109" id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="nx">kijunCrossUp</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossover</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">kijunSen</span><span class="p">)</span>
<a href="#__codelineno-0-110" id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="nx">kijunCrossDown</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossunder</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">kijunSen</span><span class="p">)</span>
<a href="#__codelineno-0-111" id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="nx">isChikouAbovePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">close</span><span class="p">[</span><span class="mf">26</span><span class="p">]</span>
<a href="#__codelineno-0-112" id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="nx">kumoTop</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">senkouSpanA</span><span class="p">,</span><span class="w"> </span><span class="nx">senkouSpanB</span><span class="p">)</span>
<a href="#__codelineno-0-113" id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="nx">kumoBottom</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">senkouSpanA</span><span class="p">,</span><span class="w"> </span><span class="nx">senkouSpanB</span><span class="p">)</span>
<a href="#__codelineno-0-114" id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="nx">kumoMiddle</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">kumoTop</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">kumoBottom</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span>
<a href="#__codelineno-0-115" id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="nx">kumoGreen</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="nx">senkouSpanA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">senkouSpanB</span>
<a href="#__codelineno-0-116" id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="nx">kumoRed</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nx">senkouSpanA</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">senkouSpanB</span>
<a href="#__codelineno-0-117" id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="nx">isPriceAboveKumo</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">kumoTop</span><span class="p">[</span><span class="mf">25</span><span class="p">]</span>
<a href="#__codelineno-0-118" id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="nx">isPriceBelowKumo</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">kumoBottom</span><span class="p">[</span><span class="mf">25</span><span class="p">]</span>
<a href="#__codelineno-0-119" id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="nx">kumoBreakUp</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossover</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">kumoTop</span><span class="p">[</span><span class="mf">25</span><span class="p">])</span>
<a href="#__codelineno-0-120" id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="nx">kumoBreakDown</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">crossunder</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">kumoBottom</span><span class="p">[</span><span class="mf">25</span><span class="p">])</span>
<a href="#__codelineno-0-121" id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="c1">//----------] End of Ichimoku Logical Parameters</span>
<a href="#__codelineno-0-122" id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a href="#__codelineno-0-123" id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a href="#__codelineno-0-124" id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="c1">//----------[ Start of Kumo Signals</span>
<a href="#__codelineno-0-125" id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="nx">bullTrend</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">isPriceAboveKumo</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kumoGreen</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">isTenkanAboveKijun</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">isChikouAbovePrice</span>
<a href="#__codelineno-0-126" id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="nx">bearTrend</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">)</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">isPriceBelowKumo</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kumoRed</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isTenkanAboveKijun</span><span class="p">)</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAbovePrice</span><span class="p">)</span>
<a href="#__codelineno-0-127" id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="nx">kijunBounceUp</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nx">bullTrend</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">low</span><span class="o">&lt;</span><span class="nx">kijunSen</span><span class="o">*</span><span class="mf">1.0001</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="o">&gt;</span><span class="nx">kijunSen</span><span class="o">*</span><span class="mf">1.0001</span>
<a href="#__codelineno-0-128" id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="nx">kijunBounceDown</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">bearTrend</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">high</span><span class="o">&gt;</span><span class="nx">kijunSen</span><span class="o">*</span><span class="mf">0.9999</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="o">&lt;</span><span class="nx">kijunSen</span><span class="o">*</span><span class="mf">0.9999</span>
<a href="#__codelineno-0-129" id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a href="#__codelineno-0-130" id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="c1">//Plotting</span>
<a href="#__codelineno-0-131" id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useChikouCross</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">diamond</span><span class="p">,</span><span class="w">      </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">small</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">100</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w">   </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Chikou crossover Kijun"</span><span class="p">)</span>
<a href="#__codelineno-0-132" id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useChikouCross</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">),</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">diamond</span><span class="p">,</span><span class="w">      </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">small</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">75</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w">  </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Chikou crossunder Kijun"</span><span class="p">)</span>
<a href="#__codelineno-0-133" id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useKumoTwist</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kumoTwistUp</span><span class="p">,</span><span class="w">                                          </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">xcross</span><span class="p">,</span><span class="w">       </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">small</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">100</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w">   </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kumo twist up"</span><span class="p">)</span>
<a href="#__codelineno-0-134" id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useKumoTwist</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kumoTwistDown</span><span class="p">,</span><span class="w">                                        </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">xcross</span><span class="p">,</span><span class="w">       </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">small</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">75</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w">  </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kumo twist down"</span><span class="p">)</span>
<a href="#__codelineno-0-135" id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useTrendDetector</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">bullTrend</span><span class="p">,</span><span class="w">                                        </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">circle</span><span class="p">,</span><span class="w">       </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">tiny</span><span class="p">,</span><span class="w">  </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">100</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">80</span><span class="p">),</span><span class="w">   </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Strong Bulltrend"</span><span class="p">)</span>
<a href="#__codelineno-0-136" id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">useTrendDetector</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">bearTrend</span><span class="p">,</span><span class="w">                                        </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">circle</span><span class="p">,</span><span class="w">       </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">tiny</span><span class="p">,</span><span class="w">  </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">75</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">80</span><span class="p">),</span><span class="w">  </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Strong Beartrend"</span><span class="p">)</span>
<a href="#__codelineno-0-137" id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">useKijunBounce</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kijunBounceUp</span><span class="o">?</span><span class="nx">kijunSen</span><span class="o">:</span><span class="nx">na</span><span class="p">,</span><span class="w">                               </span><span class="nx">style</span><span class="o">=</span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_circles</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">8</span><span class="p">,</span><span class="w">                                 </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w">     </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kijun Bounce Up"</span><span class="p">)</span>
<a href="#__codelineno-0-138" id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">useKijunBounce</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kijunBounceDown</span><span class="o">?</span><span class="nx">kijunSen</span><span class="o">:</span><span class="nx">na</span><span class="p">,</span><span class="w">                             </span><span class="nx">style</span><span class="o">=</span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_circles</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">8</span><span class="p">,</span><span class="w">                                 </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w">     </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kijun Bounce Down"</span><span class="p">)</span>
<a href="#__codelineno-0-139" id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">useKijunBounce</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kijunBounceUp</span><span class="o">?</span><span class="nx">kijunSen</span><span class="o">:</span><span class="nx">na</span><span class="p">,</span><span class="w">                               </span><span class="nx">style</span><span class="o">=</span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_circles</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">6</span><span class="p">,</span><span class="w">                                 </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">255</span><span class="p">,</span><span class="mf">215</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kijun Bounce Up"</span><span class="p">)</span>
<a href="#__codelineno-0-140" id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">useKijunBounce</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">kijunBounceDown</span><span class="o">?</span><span class="nx">kijunSen</span><span class="o">:</span><span class="nx">na</span><span class="p">,</span><span class="w">                             </span><span class="nx">style</span><span class="o">=</span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_circles</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">6</span><span class="p">,</span><span class="w">                                 </span><span class="nx">color</span><span class="o">=</span><span class="nx">color</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mf">255</span><span class="p">,</span><span class="mf">215</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">10</span><span class="p">),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kijun Bounce Down"</span><span class="p">)</span>
<a href="#__codelineno-0-141" id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">useKumoMid</span><span class="o">?</span><span class="nx">kumoMiddle</span><span class="o">:</span><span class="nx">na</span><span class="p">,</span><span class="w">                                                   </span><span class="nx">offset</span><span class="o">=</span><span class="nx">displacement</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w">  </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span><span class="w">                                 </span><span class="nx">color</span><span class="o">=</span><span class="nx">chikouColor2</span><span class="p">,</span><span class="w">            </span><span class="nx">title</span><span class="o">=</span><span class="s1">'kumoMiddle'</span><span class="p">)</span>
<a href="#__codelineno-0-142" id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="nx">barcolor</span><span class="p">(</span><span class="nx">useBarColor</span><span class="o">?</span><span class="p">(</span><span class="nx">chikouColor</span><span class="p">)</span><span class="o">:</span><span class="nx">na</span><span class="p">)</span>
<a href="#__codelineno-0-143" id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a href="#__codelineno-0-144" id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="c1">// Signals</span>
<a href="#__codelineno-0-145" id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">isChikouAboveKijun</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span><span class="w">                                                                                                                   </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Chikou Crossover"</span><span class="p">)</span>
<a href="#__codelineno-0-146" id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">isChikouAboveKijun</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">isChikouAboveKijun</span><span class="p">),</span><span class="w">                                                                                                                   </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Chikou Crossunder"</span><span class="p">)</span>
<a href="#__codelineno-0-147" id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">kumoTwistUp</span><span class="p">,</span><span class="w">                                                                                                                                                          </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kumo Twist Up"</span><span class="p">)</span>
<a href="#__codelineno-0-148" id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">kumoTwistDown</span><span class="p">,</span><span class="w">                                                                                                                                                        </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kumo Twist Down"</span><span class="p">)</span>
<a href="#__codelineno-0-149" id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">kijunBounceUp</span><span class="p">,</span><span class="w">                                                                                                                                                        </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kijun Bounce Up"</span><span class="p">)</span>
<a href="#__codelineno-0-150" id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">kijunBounceDown</span><span class="p">,</span><span class="w">                                                                                                                                                      </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Kijun Bounce Down"</span><span class="p">)</span>
<a href="#__codelineno-0-151" id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">bullTrend</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">bullTrend</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span><span class="w">                                                                                                                                     </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Bulltrend Start"</span><span class="p">)</span>
<a href="#__codelineno-0-152" id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">bearTrend</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">(</span><span class="nx">not</span><span class="w"> </span><span class="nx">bearTrend</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span><span class="w">                                                                                                                                     </span><span class="nx">title</span><span class="o">=</span><span class="s2">"BearTrend Start"</span><span class="p">)</span>
<a href="#__codelineno-0-153" id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="c1">//----------[ End of Kumo Signals</span>
</code></pre></div> <div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">//@version=3</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="c1">// Copyright (c) 2018-present, Alex Orekhov (everget)</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="c1">// On Balance Volume script may be freely distributed under the MIT license.</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="nx">study</span><span class="p">(</span><span class="s2">"On Balance Volume with SMA"</span><span class="p">,</span><span class="w"> </span><span class="nx">shorttitle</span><span class="o">=</span><span class="s2">"OBV"</span><span class="p">,</span><span class="w"> </span><span class="nx">precision</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="nx">showSignal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s2">"Show Signal ?"</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="nx">bool</span><span class="p">,</span><span class="w"> </span><span class="nx">defval</span><span class="o">=</span><span class="kc">true</span><span class="p">)</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="nx">signalType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s2">"Signal Smoothing Type"</span><span class="p">,</span><span class="w"> </span><span class="nx">defval</span><span class="o">=</span><span class="s2">"SMA"</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="o">=</span><span class="p">[</span><span class="s2">"EMA"</span><span class="p">,</span><span class="w"> </span><span class="s2">"SMA"</span><span class="p">])</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="nx">signalLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s2">"Signal Smoothing Length"</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="nx">integer</span><span class="p">,</span><span class="w"> </span><span class="nx">defval</span><span class="o">=</span><span class="mf">21</span><span class="p">)</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="nx">highlightCrossovers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s2">"Highlight Crossovers ?"</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="nx">bool</span><span class="p">,</span><span class="w"> </span><span class="nx">defval</span><span class="o">=</span><span class="kc">false</span><span class="p">)</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="nx">applyFilling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s2">"Apply Ribbon Filling ?"</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="nx">bool</span><span class="p">,</span><span class="w"> </span><span class="nx">defval</span><span class="o">=</span><span class="kc">true</span><span class="p">)</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s2">"Source"</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="nx">source</span><span class="p">,</span><span class="w"> </span><span class="nx">defval</span><span class="o">=</span><span class="nx">close</span><span class="p">)</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="nx">obv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cum</span><span class="p">(</span><span class="nx">sign</span><span class="p">(</span><span class="nx">change</span><span class="p">(</span><span class="nx">src</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">volume</span><span class="p">)</span>
<a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="nx">signal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">signalType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"EMA"</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">ema</span><span class="p">(</span><span class="nx">obv</span><span class="p">,</span><span class="w"> </span><span class="nx">signalLength</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">sma</span><span class="p">(</span><span class="nx">obv</span><span class="p">,</span><span class="w"> </span><span class="nx">signalLength</span><span class="p">)</span>
<a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a>
<a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="nx">trendColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">obv</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">signal</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="err">#</span><span class="mf">0</span><span class="nx">ebb23</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">red</span>
<a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a>
<a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="nx">obvColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">applyFilling</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">trendColor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="err">#</span><span class="mo">00</span><span class="mf">94</span><span class="nx">ff</span>
<a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="nx">signalColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">applyFilling</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">trendColor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="err">#</span><span class="nx">ff6a00</span>
<a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a>
<a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="nx">obvPlot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">(</span><span class="nx">obv</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"OBV with SMA"</span><span class="p">,</span><span class="w"> </span><span class="nx">linewidth</span><span class="o">=</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">obvColor</span><span class="p">,</span><span class="w"> </span><span class="nx">transp</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="nx">signalPlot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">(</span><span class="nx">showSignal</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">signal</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Signal"</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">signalColor</span><span class="p">,</span><span class="w"> </span><span class="nx">transp</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a>
<a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="nx">transparent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">(</span><span class="nx">white</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span>
<a href="#__codelineno-1-25" id="__codelineno-1-25" name="__codelineno-1-25"></a>
<a href="#__codelineno-1-26" id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="nx">fillColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">applyFilling</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">trendColor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">transparent</span>
<a href="#__codelineno-1-27" id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="nx">fill</span><span class="p">(</span><span class="nx">obvPlot</span><span class="p">,</span><span class="w"> </span><span class="nx">signalPlot</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">fillColor</span><span class="p">,</span><span class="w"> </span><span class="nx">transp</span><span class="o">=</span><span class="mf">70</span><span class="p">)</span>
<a href="#__codelineno-1-28" id="__codelineno-1-28" name="__codelineno-1-28"></a>
<a href="#__codelineno-1-29" id="__codelineno-1-29" name="__codelineno-1-29"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">crossover</span><span class="p">(</span><span class="nx">obv</span><span class="p">,</span><span class="w"> </span><span class="nx">signal</span><span class="p">)</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">highlightCrossovers</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">obv</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Crossover"</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">absolute</span><span class="p">,</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">circle</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">tiny</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="p">,</span><span class="w"> </span><span class="nx">transp</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-1-30" id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">crossunder</span><span class="p">(</span><span class="nx">obv</span><span class="p">,</span><span class="w"> </span><span class="nx">signal</span><span class="p">)</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">highlightCrossovers</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">obv</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Crossunder"</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">absolute</span><span class="p">,</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="nx">shape</span><span class="p">.</span><span class="nx">circle</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="o">=</span><span class="nx">size</span><span class="p">.</span><span class="nx">tiny</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="p">,</span><span class="w"> </span><span class="nx">transp</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span>
</code></pre></div> <div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1">//@version=5</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="nx">indicator</span><span class="p">(</span><span class="nx">title</span><span class="o">=</span><span class="s2">"Ichimoku Cloud Momentum &amp; Trend Indicator ¬´NoaTrader¬ª"</span><span class="p">,</span><span class="w"> </span><span class="nx">shorttitle</span><span class="o">=</span><span class="s2">"Ichi MTI"</span><span class="p">,</span><span class="w"> </span><span class="nx">overlay</span><span class="o">=</span><span class="kc">false</span><span class="p">)</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="kd">var</span><span class="w"> </span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">bool</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="s2">"Use weighted value for conditions"</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indicator"</span><span class="p">)</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="nx">conversionPeriods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Conversion Line Length"</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ichimoku"</span><span class="p">)</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="nx">basePeriods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">26</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Base Line Length"</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ichimoku"</span><span class="p">)</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="nx">laggingSpan2Periods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">52</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Leading Span B Length"</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ichimoku"</span><span class="p">)</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="nx">displacement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="kr">int</span><span class="p">(</span><span class="mf">26</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Lagging Span"</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ichimoku"</span><span class="p">)</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="nx">donchian</span><span class="p">(</span><span class="nx">len</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">avg</span><span class="p">(</span><span class="nx">ta</span><span class="p">.</span><span class="nx">lowest</span><span class="p">(</span><span class="nx">len</span><span class="p">),</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">highest</span><span class="p">(</span><span class="nx">len</span><span class="p">))</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="nx">conversionLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">donchian</span><span class="p">(</span><span class="nx">conversionPeriods</span><span class="p">)</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="nx">baseLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">donchian</span><span class="p">(</span><span class="nx">basePeriods</span><span class="p">)</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="nx">leadLine1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">avg</span><span class="p">(</span><span class="nx">conversionLine</span><span class="p">,</span><span class="w"> </span><span class="nx">baseLine</span><span class="p">)</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="nx">leadLine2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">donchian</span><span class="p">(</span><span class="nx">laggingSpan2Periods</span><span class="p">)</span>
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="kd">var</span><span class="w"> </span><span class="nx">trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="nx">lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">displacement</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="nx">cloud_top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">leadLine1</span><span class="p">[</span><span class="nx">lag</span><span class="p">],</span><span class="nx">leadLine2</span><span class="p">[</span><span class="nx">lag</span><span class="p">])</span>
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="nx">cloud_bot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">leadLine1</span><span class="p">[</span><span class="nx">lag</span><span class="p">],</span><span class="nx">leadLine2</span><span class="p">[</span><span class="nx">lag</span><span class="p">])</span>
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>
<a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="nx">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span>
<a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="c1">// momentun over cloud</span>
<a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="nx">is_mom_over_top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">cloud_top</span><span class="p">[</span><span class="nx">lag</span><span class="p">]</span>
<a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="nx">is_mom_under_bot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">cloud_bot</span><span class="p">[</span><span class="nx">lag</span><span class="p">]</span>
<a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="kd">var</span><span class="w"> </span><span class="nx">mom_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span>
<a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="k">if</span><span class="w"> </span><span class="nx">is_mom_over_top</span>
<a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">mom_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-25" id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">is_mom_under_bot</span>
<a href="#__codelineno-2-26" id="__codelineno-2-26" name="__codelineno-2-26"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">mom_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-27" id="__codelineno-2-27" name="__codelineno-2-27"></a>
<a href="#__codelineno-2-28" id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="c1">// price over cloud</span>
<a href="#__codelineno-2-29" id="__codelineno-2-29" name="__codelineno-2-29"></a><span class="nx">is_price_over_top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">cloud_top</span>
<a href="#__codelineno-2-30" id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="nx">is_price_under_bot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">cloud_bot</span>
<a href="#__codelineno-2-31" id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="kd">var</span><span class="w"> </span><span class="nx">price_could_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span>
<a href="#__codelineno-2-32" id="__codelineno-2-32" name="__codelineno-2-32"></a><span class="k">if</span><span class="w"> </span><span class="nx">is_price_over_top</span>
<a href="#__codelineno-2-33" id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">price_could_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-34" id="__codelineno-2-34" name="__codelineno-2-34"></a><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">is_price_under_bot</span>
<a href="#__codelineno-2-35" id="__codelineno-2-35" name="__codelineno-2-35"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">price_could_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-36" id="__codelineno-2-36" name="__codelineno-2-36"></a>
<a href="#__codelineno-2-37" id="__codelineno-2-37" name="__codelineno-2-37"></a><span class="c1">// cloud is green or red</span>
<a href="#__codelineno-2-38" id="__codelineno-2-38" name="__codelineno-2-38"></a><span class="kd">var</span><span class="w"> </span><span class="nx">cloud_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4</span>
<a href="#__codelineno-2-39" id="__codelineno-2-39" name="__codelineno-2-39"></a><span class="k">if</span><span class="w"> </span><span class="nx">leadLine1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">leadLine2</span>
<a href="#__codelineno-2-40" id="__codelineno-2-40" name="__codelineno-2-40"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">cloud_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-41" id="__codelineno-2-41" name="__codelineno-2-41"></a><span class="k">else</span>
<a href="#__codelineno-2-42" id="__codelineno-2-42" name="__codelineno-2-42"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">cloud_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-43" id="__codelineno-2-43" name="__codelineno-2-43"></a>
<a href="#__codelineno-2-44" id="__codelineno-2-44" name="__codelineno-2-44"></a><span class="kd">var</span><span class="w"> </span><span class="nx">lines_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span>
<a href="#__codelineno-2-45" id="__codelineno-2-45" name="__codelineno-2-45"></a><span class="k">if</span><span class="w"> </span><span class="nx">conversionLine</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">baseLine</span>
<a href="#__codelineno-2-46" id="__codelineno-2-46" name="__codelineno-2-46"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">lines_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-47" id="__codelineno-2-47" name="__codelineno-2-47"></a><span class="k">else</span><span class="w"> </span>
<a href="#__codelineno-2-48" id="__codelineno-2-48" name="__codelineno-2-48"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">lines_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-49" id="__codelineno-2-49" name="__codelineno-2-49"></a>
<a href="#__codelineno-2-50" id="__codelineno-2-50" name="__codelineno-2-50"></a><span class="kd">var</span><span class="w"> </span><span class="nx">prive_conv_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-2-51" id="__codelineno-2-51" name="__codelineno-2-51"></a><span class="k">if</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">conversionLine</span>
<a href="#__codelineno-2-52" id="__codelineno-2-52" name="__codelineno-2-52"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">prive_conv_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-53" id="__codelineno-2-53" name="__codelineno-2-53"></a><span class="k">else</span><span class="w"> </span>
<a href="#__codelineno-2-54" id="__codelineno-2-54" name="__codelineno-2-54"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">prive_conv_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-55" id="__codelineno-2-55" name="__codelineno-2-55"></a>
<a href="#__codelineno-2-56" id="__codelineno-2-56" name="__codelineno-2-56"></a><span class="kd">var</span><span class="w"> </span><span class="nx">price_base_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span>
<a href="#__codelineno-2-57" id="__codelineno-2-57" name="__codelineno-2-57"></a><span class="k">if</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">baseLine</span>
<a href="#__codelineno-2-58" id="__codelineno-2-58" name="__codelineno-2-58"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">price_base_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-59" id="__codelineno-2-59" name="__codelineno-2-59"></a><span class="k">else</span><span class="w"> </span>
<a href="#__codelineno-2-60" id="__codelineno-2-60" name="__codelineno-2-60"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">price_base_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<a href="#__codelineno-2-61" id="__codelineno-2-61" name="__codelineno-2-61"></a>
<a href="#__codelineno-2-62" id="__codelineno-2-62" name="__codelineno-2-62"></a><span class="nx">w_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">is_weighted</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">price_base_w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">prive_conv_w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">lines_w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">cloud_w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">price_could_w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mom_w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">6</span>
<a href="#__codelineno-2-63" id="__codelineno-2-63" name="__codelineno-2-63"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">total</span><span class="o">*</span><span class="mf">100</span><span class="o">/</span><span class="nx">w_sum</span><span class="p">,</span><span class="s2">"Total"</span><span class="p">,</span><span class="nx">color</span><span class="p">.</span><span class="nx">from_gradient</span><span class="p">(</span><span class="nx">total</span><span class="p">,</span><span class="o">-</span><span class="nx">w_sum</span><span class="p">,</span><span class="nx">w_sum</span><span class="p">,</span><span class="nx">color</span><span class="p">.</span><span class="nx">red</span><span class="p">,</span><span class="nx">color</span><span class="p">.</span><span class="nx">green</span><span class="p">),</span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_columns</span><span class="p">)</span>
<a href="#__codelineno-2-64" id="__codelineno-2-64" name="__codelineno-2-64"></a>
<a href="#__codelineno-2-65" id="__codelineno-2-65" name="__codelineno-2-65"></a><span class="k">if</span><span class="w"> </span><span class="nx">is_mom_over_top</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">is_price_over_top</span>
<a href="#__codelineno-2-66" id="__codelineno-2-66" name="__codelineno-2-66"></a><span class="w">    </span><span class="nx">trend</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-2-67" id="__codelineno-2-67" name="__codelineno-2-67"></a><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">is_mom_under_bot</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">is_price_under_bot</span>
<a href="#__codelineno-2-68" id="__codelineno-2-68" name="__codelineno-2-68"></a><span class="w">    </span><span class="nx">trend</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span>
<a href="#__codelineno-2-69" id="__codelineno-2-69" name="__codelineno-2-69"></a><span class="k">else</span>
<a href="#__codelineno-2-70" id="__codelineno-2-70" name="__codelineno-2-70"></a><span class="w">    </span><span class="nx">trend</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0</span>
<a href="#__codelineno-2-71" id="__codelineno-2-71" name="__codelineno-2-71"></a>
<a href="#__codelineno-2-72" id="__codelineno-2-72" name="__codelineno-2-72"></a><span class="nx">plot</span><span class="p">(</span><span class="nx">trend</span><span class="o">*</span><span class="mf">100</span><span class="p">,</span><span class="s2">"Trend"</span><span class="p">,</span><span class="nx">chart</span><span class="p">.</span><span class="nx">bg_color</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">white</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">black</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">white</span><span class="w"> </span><span class="p">,</span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plot</span><span class="p">.</span><span class="nx">style_stepline_diamond</span><span class="p">,</span><span class="nx">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
</code></pre></div> <div class="highlight"><span class="filename">JavaScript</span><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1">// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c1">// ¬© LonesomeTheBlue</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="c1">//@version=4</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="nx">study</span><span class="p">(</span><span class="s2">"Support Resistance - Dynamic v2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"SRv2"</span><span class="p">,</span><span class="w"> </span><span class="nx">overlay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="nx">prd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Pivot Period"</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="nx">maxval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Setup"</span><span class="p">)</span>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="nx">ppsrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'High/Low'</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s2">"Source"</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">'High/Low'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Close/Open'</span><span class="p">],</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Setup"</span><span class="p">)</span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="nx">maxnumpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="s2">" Maximum Number of Pivot"</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="nx">maxval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Setup"</span><span class="p">)</span>
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="nx">ChannelW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Maximum Channel Width %"</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Setup"</span><span class="p">)</span>
<a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="nx">maxnumsr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="s2">" Maximum Number of S/R"</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">maxval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Setup"</span><span class="p">)</span>
<a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="nx">min_strength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="s2">" Minimum Strength"</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">maxval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Setup"</span><span class="p">)</span>
<a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="nx">labelloc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Label Location"</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Colors"</span><span class="p">,</span><span class="w"> </span><span class="nx">tooltip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Positive numbers reference future bars, negative numbers reference histical bars"</span><span class="p">)</span>
<a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="nx">linestyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Dashed'</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Line Style"</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">'Solid'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Dotted'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Dashed'</span><span class="p">],</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Colors"</span><span class="p">)</span>
<a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="nx">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Line Width"</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">maxval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Colors"</span><span class="p">)</span>
<a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="nx">resistancecolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">red</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Resistance Color"</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Colors"</span><span class="p">)</span>
<a href="#__codelineno-3-16" id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="nx">supportcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="nx">defval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">lime</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Support Color"</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Colors"</span><span class="p">)</span>
<a href="#__codelineno-3-17" id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="nx">showpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Show Point Points"</span><span class="p">)</span>
<a href="#__codelineno-3-18" id="__codelineno-3-18" name="__codelineno-3-18"></a>
<a href="#__codelineno-3-19" id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="kr">float</span><span class="w"> </span><span class="nx">src1</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nx">ppsrc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'High/Low'</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">high</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">max</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">open</span><span class="p">)</span>
<a href="#__codelineno-3-20" id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="kr">float</span><span class="w"> </span><span class="nx">src2</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nx">ppsrc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'High/Low'</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">low</span><span class="o">:</span><span class="w"> </span><span class="nx">min</span><span class="p">(</span><span class="nx">close</span><span class="p">,</span><span class="w"> </span><span class="nx">open</span><span class="p">)</span>
<a href="#__codelineno-3-21" id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="kr">float</span><span class="w"> </span><span class="nx">ph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pivothigh</span><span class="p">(</span><span class="nx">src1</span><span class="p">,</span><span class="w"> </span><span class="nx">prd</span><span class="p">,</span><span class="w"> </span><span class="nx">prd</span><span class="p">)</span>
<a href="#__codelineno-3-22" id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="kr">float</span><span class="w"> </span><span class="nx">pl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pivotlow</span><span class="p">(</span><span class="nx">src2</span><span class="p">,</span><span class="w"> </span><span class="nx">prd</span><span class="p">,</span><span class="w"> </span><span class="nx">prd</span><span class="p">)</span>
<a href="#__codelineno-3-23" id="__codelineno-3-23" name="__codelineno-3-23"></a>
<a href="#__codelineno-3-24" id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">ph</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">showpp</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"H"</span><span class="p">,</span><span class="w">  </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shape</span><span class="p">.</span><span class="nx">labeldown</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">na</span><span class="p">,</span><span class="w"> </span><span class="nx">textcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">red</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">abovebar</span><span class="p">,</span><span class="w">  </span><span class="nx">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nx">prd</span><span class="p">)</span>
<a href="#__codelineno-3-25" id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="nx">plotshape</span><span class="p">(</span><span class="nx">pl</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">showpp</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L"</span><span class="p">,</span><span class="w">  </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shape</span><span class="p">.</span><span class="nx">labelup</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">na</span><span class="p">,</span><span class="w"> </span><span class="nx">textcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">lime</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">belowbar</span><span class="p">,</span><span class="w">  </span><span class="nx">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nx">prd</span><span class="p">)</span>
<a href="#__codelineno-3-26" id="__codelineno-3-26" name="__codelineno-3-26"></a>
<a href="#__codelineno-3-27" id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="nx">Lstyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">linestyle</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'Dashed'</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">line</span><span class="p">.</span><span class="nx">style_dashed</span><span class="w"> </span><span class="o">:</span>
<a href="#__codelineno-3-28" id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="w">         </span><span class="nx">linestyle</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'Solid'</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">line</span><span class="p">.</span><span class="nx">style_solid</span><span class="w"> </span><span class="o">:</span>
<a href="#__codelineno-3-29" id="__codelineno-3-29" name="__codelineno-3-29"></a><span class="w">         </span><span class="nx">line</span><span class="p">.</span><span class="nx">style_dotted</span>
<a href="#__codelineno-3-30" id="__codelineno-3-30" name="__codelineno-3-30"></a>
<a href="#__codelineno-3-31" id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="c1">//calculate maximum S/R channel zone width</span>
<a href="#__codelineno-3-32" id="__codelineno-3-32" name="__codelineno-3-32"></a><span class="nx">prdhighest</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nx">highest</span><span class="p">(</span><span class="mf">300</span><span class="p">)</span>
<a href="#__codelineno-3-33" id="__codelineno-3-33" name="__codelineno-3-33"></a><span class="nx">prdlowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lowest</span><span class="p">(</span><span class="mf">300</span><span class="p">)</span>
<a href="#__codelineno-3-34" id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="nx">cwidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">prdhighest</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">prdlowest</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">ChannelW</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span>
<a href="#__codelineno-3-35" id="__codelineno-3-35" name="__codelineno-3-35"></a>
<a href="#__codelineno-3-36" id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="kd">var</span><span class="w"> </span><span class="nx">pivotvals</span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">new_float</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-3-37" id="__codelineno-3-37" name="__codelineno-3-37"></a>
<a href="#__codelineno-3-38" id="__codelineno-3-38" name="__codelineno-3-38"></a><span class="k">if</span><span class="w"> </span><span class="nx">ph</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">pl</span>
<a href="#__codelineno-3-39" id="__codelineno-3-39" name="__codelineno-3-39"></a><span class="w">    </span><span class="nx">array</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">pivotvals</span><span class="p">,</span><span class="w"> </span><span class="nx">ph</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">ph</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">pl</span><span class="p">)</span>
<a href="#__codelineno-3-40" id="__codelineno-3-40" name="__codelineno-3-40"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">pivotvals</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxnumpp</span><span class="w"> </span><span class="c1">// limit the array size</span>
<a href="#__codelineno-3-41" id="__codelineno-3-41" name="__codelineno-3-41"></a><span class="w">        </span><span class="nx">array</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">pivotvals</span><span class="p">)</span>
<a href="#__codelineno-3-42" id="__codelineno-3-42" name="__codelineno-3-42"></a>
<a href="#__codelineno-3-43" id="__codelineno-3-43" name="__codelineno-3-43"></a><span class="nx">get_sr_vals</span><span class="p">(</span><span class="nx">ind</span><span class="p">)=&gt;</span>
<a href="#__codelineno-3-44" id="__codelineno-3-44" name="__codelineno-3-44"></a><span class="w">    </span><span class="kr">float</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">pivotvals</span><span class="p">,</span><span class="w"> </span><span class="nx">ind</span><span class="p">)</span>
<a href="#__codelineno-3-45" id="__codelineno-3-45" name="__codelineno-3-45"></a><span class="w">    </span><span class="kr">float</span><span class="w"> </span><span class="nx">hi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lo</span>
<a href="#__codelineno-3-46" id="__codelineno-3-46" name="__codelineno-3-46"></a><span class="w">    </span><span class="kr">int</span><span class="w"> </span><span class="nx">numpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span>
<a href="#__codelineno-3-47" id="__codelineno-3-47" name="__codelineno-3-47"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">pivotvals</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-3-48" id="__codelineno-3-48" name="__codelineno-3-48"></a><span class="w">        </span><span class="kr">float</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">pivotvals</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span>
<a href="#__codelineno-3-49" id="__codelineno-3-49" name="__codelineno-3-49"></a><span class="w">        </span><span class="kr">float</span><span class="w"> </span><span class="nx">wdth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">hi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">lo</span>
<a href="#__codelineno-3-50" id="__codelineno-3-50" name="__codelineno-3-50"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">wdth</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">cwidth</span><span class="w"> </span><span class="c1">// fits the max channel width?</span>
<a href="#__codelineno-3-51" id="__codelineno-3-51" name="__codelineno-3-51"></a><span class="w">            </span><span class="nx">lo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">lo</span>
<a href="#__codelineno-3-52" id="__codelineno-3-52" name="__codelineno-3-52"></a><span class="w">            </span><span class="nx">hi</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">cpp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">hi</span>
<a href="#__codelineno-3-53" id="__codelineno-3-53" name="__codelineno-3-53"></a><span class="w">            </span><span class="nx">numpp</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-3-54" id="__codelineno-3-54" name="__codelineno-3-54"></a><span class="w">    </span><span class="p">[</span><span class="nx">hi</span><span class="p">,</span><span class="w"> </span><span class="nx">lo</span><span class="p">,</span><span class="w"> </span><span class="nx">numpp</span><span class="p">]</span><span class="w">  </span>
<a href="#__codelineno-3-55" id="__codelineno-3-55" name="__codelineno-3-55"></a>
<a href="#__codelineno-3-56" id="__codelineno-3-56" name="__codelineno-3-56"></a><span class="kd">var</span><span class="w"> </span><span class="nx">sr_up_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">new_float</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-3-57" id="__codelineno-3-57" name="__codelineno-3-57"></a><span class="kd">var</span><span class="w"> </span><span class="nx">sr_dn_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">new_float</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-3-58" id="__codelineno-3-58" name="__codelineno-3-58"></a><span class="nx">sr_strength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">new_float</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<a href="#__codelineno-3-59" id="__codelineno-3-59" name="__codelineno-3-59"></a>
<a href="#__codelineno-3-60" id="__codelineno-3-60" name="__codelineno-3-60"></a><span class="nx">find_loc</span><span class="p">(</span><span class="nx">strength</span><span class="p">)=&gt;</span>
<a href="#__codelineno-3-61" id="__codelineno-3-61" name="__codelineno-3-61"></a><span class="w">    </span><span class="nx">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">)</span>
<a href="#__codelineno-3-62" id="__codelineno-3-62" name="__codelineno-3-62"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">ret</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">)</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="mf">0</span>
<a href="#__codelineno-3-63" id="__codelineno-3-63" name="__codelineno-3-63"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">strength</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span>
<a href="#__codelineno-3-64" id="__codelineno-3-64" name="__codelineno-3-64"></a><span class="w">            </span><span class="k">break</span>
<a href="#__codelineno-3-65" id="__codelineno-3-65" name="__codelineno-3-65"></a><span class="w">        </span><span class="nx">ret</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">i</span>
<a href="#__codelineno-3-66" id="__codelineno-3-66" name="__codelineno-3-66"></a><span class="w">    </span><span class="nx">ret</span>
<a href="#__codelineno-3-67" id="__codelineno-3-67" name="__codelineno-3-67"></a>
<a href="#__codelineno-3-68" id="__codelineno-3-68" name="__codelineno-3-68"></a><span class="nx">check_sr</span><span class="p">(</span><span class="nx">hi</span><span class="p">,</span><span class="w"> </span><span class="nx">lo</span><span class="p">,</span><span class="w"> </span><span class="nx">strength</span><span class="p">)=&gt;</span>
<a href="#__codelineno-3-69" id="__codelineno-3-69" name="__codelineno-3-69"></a><span class="w">    </span><span class="nx">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-3-70" id="__codelineno-3-70" name="__codelineno-3-70"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">)</span>
<a href="#__codelineno-3-71" id="__codelineno-3-71" name="__codelineno-3-71"></a><span class="w">        </span><span class="c1">//included?</span>
<a href="#__codelineno-3-72" id="__codelineno-3-72" name="__codelineno-3-72"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">hi</span><span class="w">  </span><span class="nx">or</span><span class="w"> </span>
<a href="#__codelineno-3-73" id="__codelineno-3-73" name="__codelineno-3-73"></a><span class="w">           </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">hi</span>
<a href="#__codelineno-3-74" id="__codelineno-3-74" name="__codelineno-3-74"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nx">strength</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span>
<a href="#__codelineno-3-75" id="__codelineno-3-75" name="__codelineno-3-75"></a><span class="w">                </span><span class="nx">array</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span>
<a href="#__codelineno-3-76" id="__codelineno-3-76" name="__codelineno-3-76"></a><span class="w">                </span><span class="nx">array</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span>
<a href="#__codelineno-3-77" id="__codelineno-3-77" name="__codelineno-3-77"></a><span class="w">                </span><span class="nx">array</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span>
<a href="#__codelineno-3-78" id="__codelineno-3-78" name="__codelineno-3-78"></a><span class="w">                </span><span class="nx">ret</span>
<a href="#__codelineno-3-79" id="__codelineno-3-79" name="__codelineno-3-79"></a><span class="w">            </span><span class="k">else</span>
<a href="#__codelineno-3-80" id="__codelineno-3-80" name="__codelineno-3-80"></a><span class="w">                </span><span class="nx">ret</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">false</span>
<a href="#__codelineno-3-81" id="__codelineno-3-81" name="__codelineno-3-81"></a><span class="w">            </span><span class="k">break</span>
<a href="#__codelineno-3-82" id="__codelineno-3-82" name="__codelineno-3-82"></a><span class="w">    </span><span class="nx">ret</span>
<a href="#__codelineno-3-83" id="__codelineno-3-83" name="__codelineno-3-83"></a>
<a href="#__codelineno-3-84" id="__codelineno-3-84" name="__codelineno-3-84"></a><span class="kd">var</span><span class="w"> </span><span class="nx">sr_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">new_line</span><span class="p">(</span><span class="mf">11</span><span class="p">,</span><span class="w"> </span><span class="nx">na</span><span class="p">)</span>
<a href="#__codelineno-3-85" id="__codelineno-3-85" name="__codelineno-3-85"></a><span class="kd">var</span><span class="w"> </span><span class="nx">sr_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">new_label</span><span class="p">(</span><span class="mf">11</span><span class="p">,</span><span class="w"> </span><span class="nx">na</span><span class="p">)</span>
<a href="#__codelineno-3-86" id="__codelineno-3-86" name="__codelineno-3-86"></a>
<a href="#__codelineno-3-87" id="__codelineno-3-87" name="__codelineno-3-87"></a><span class="k">for</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="mf">10</span>
<a href="#__codelineno-3-88" id="__codelineno-3-88" name="__codelineno-3-88"></a><span class="w">    </span><span class="nx">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">label</span><span class="p">.</span><span class="nx">get_y</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">close</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">close</span>
<a href="#__codelineno-3-89" id="__codelineno-3-89" name="__codelineno-3-89"></a><span class="w">    </span><span class="nx">label</span><span class="p">.</span><span class="nx">set_text</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">),</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tostring</span><span class="p">(</span><span class="nx">label</span><span class="p">.</span><span class="nx">get_y</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tostring</span><span class="p">(</span><span class="nx">rate</span><span class="p">,</span><span class="s1">'#.##'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"%)"</span><span class="p">)</span>
<a href="#__codelineno-3-90" id="__codelineno-3-90" name="__codelineno-3-90"></a><span class="w">    </span><span class="nx">label</span><span class="p">.</span><span class="nx">set_x</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">),</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bar_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">labelloc</span><span class="p">)</span>
<a href="#__codelineno-3-91" id="__codelineno-3-91" name="__codelineno-3-91"></a><span class="w">    </span><span class="nx">label</span><span class="p">.</span><span class="nx">set_color</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">),</span><span class="w"> </span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">get_y</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">red</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">lime</span><span class="p">)</span>
<a href="#__codelineno-3-92" id="__codelineno-3-92" name="__codelineno-3-92"></a><span class="w">    </span><span class="nx">label</span><span class="p">.</span><span class="nx">set_textcolor</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">),</span><span class="w"> </span><span class="nx">textcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">get_y</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">white</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">black</span><span class="p">)</span>
<a href="#__codelineno-3-93" id="__codelineno-3-93" name="__codelineno-3-93"></a><span class="w">    </span><span class="nx">label</span><span class="p">.</span><span class="nx">set_style</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">),</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">get_y</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">style_labeldown</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">style_labelup</span><span class="p">)</span>
<a href="#__codelineno-3-94" id="__codelineno-3-94" name="__codelineno-3-94"></a><span class="w">    </span><span class="nx">line</span><span class="p">.</span><span class="nx">set_color</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_lines</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">),</span><span class="w"> </span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">line</span><span class="p">.</span><span class="nx">get_y1</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_lines</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">resistancecolor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">supportcolor</span><span class="p">)</span><span class="w"> </span>
<a href="#__codelineno-3-95" id="__codelineno-3-95" name="__codelineno-3-95"></a>
<a href="#__codelineno-3-96" id="__codelineno-3-96" name="__codelineno-3-96"></a><span class="k">if</span><span class="w"> </span><span class="nx">ph</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">pl</span>
<a href="#__codelineno-3-97" id="__codelineno-3-97" name="__codelineno-3-97"></a><span class="w">    </span><span class="c1">//because of new calculation, remove old S/R levels</span>
<a href="#__codelineno-3-98" id="__codelineno-3-98" name="__codelineno-3-98"></a><span class="w">    </span><span class="nx">array</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span>
<a href="#__codelineno-3-99" id="__codelineno-3-99" name="__codelineno-3-99"></a><span class="w">    </span><span class="nx">array</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">)</span>
<a href="#__codelineno-3-100" id="__codelineno-3-100" name="__codelineno-3-100"></a><span class="w">    </span><span class="nx">array</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">)</span>
<a href="#__codelineno-3-101" id="__codelineno-3-101" name="__codelineno-3-101"></a><span class="w">    </span><span class="c1">//find S/R zones</span>
<a href="#__codelineno-3-102" id="__codelineno-3-102" name="__codelineno-3-102"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">pivotvals</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span>
<a href="#__codelineno-3-103" id="__codelineno-3-103" name="__codelineno-3-103"></a><span class="w">        </span><span class="p">[</span><span class="nx">hi</span><span class="p">,</span><span class="w"> </span><span class="nx">lo</span><span class="p">,</span><span class="w"> </span><span class="nx">strength</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">get_sr_vals</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
<a href="#__codelineno-3-104" id="__codelineno-3-104" name="__codelineno-3-104"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">check_sr</span><span class="p">(</span><span class="nx">hi</span><span class="p">,</span><span class="w"> </span><span class="nx">lo</span><span class="p">,</span><span class="w"> </span><span class="nx">strength</span><span class="p">)</span>
<a href="#__codelineno-3-105" id="__codelineno-3-105" name="__codelineno-3-105"></a><span class="w">            </span><span class="nx">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">find_loc</span><span class="p">(</span><span class="nx">strength</span><span class="p">)</span>
<a href="#__codelineno-3-106" id="__codelineno-3-106" name="__codelineno-3-106"></a><span class="w">            </span><span class="c1">// if strength is in first maxnumsr sr then insert it to the arrays </span>
<a href="#__codelineno-3-107" id="__codelineno-3-107" name="__codelineno-3-107"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nx">loc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">maxnumsr</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">strength</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">min_strength</span>
<a href="#__codelineno-3-108" id="__codelineno-3-108" name="__codelineno-3-108"></a><span class="w">                </span><span class="nx">array</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">,</span><span class="w"> </span><span class="nx">loc</span><span class="p">,</span><span class="w"> </span><span class="nx">strength</span><span class="p">)</span>
<a href="#__codelineno-3-109" id="__codelineno-3-109" name="__codelineno-3-109"></a><span class="w">                </span><span class="nx">array</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">,</span><span class="w"> </span><span class="nx">loc</span><span class="p">,</span><span class="w"> </span><span class="nx">hi</span><span class="p">)</span>
<a href="#__codelineno-3-110" id="__codelineno-3-110" name="__codelineno-3-110"></a><span class="w">                </span><span class="nx">array</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">,</span><span class="w"> </span><span class="nx">loc</span><span class="p">,</span><span class="w"> </span><span class="nx">lo</span><span class="p">)</span>
<a href="#__codelineno-3-111" id="__codelineno-3-111" name="__codelineno-3-111"></a><span class="w">                </span><span class="c1">// keep size of the arrays = 5</span>
<a href="#__codelineno-3-112" id="__codelineno-3-112" name="__codelineno-3-112"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">maxnumsr</span>
<a href="#__codelineno-3-113" id="__codelineno-3-113" name="__codelineno-3-113"></a><span class="w">                    </span><span class="nx">array</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">sr_strength</span><span class="p">)</span>
<a href="#__codelineno-3-114" id="__codelineno-3-114" name="__codelineno-3-114"></a><span class="w">                    </span><span class="nx">array</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span>
<a href="#__codelineno-3-115" id="__codelineno-3-115" name="__codelineno-3-115"></a><span class="w">                    </span><span class="nx">array</span><span class="p">.</span><span class="nx">pop</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">)</span>
<a href="#__codelineno-3-116" id="__codelineno-3-116" name="__codelineno-3-116"></a>
<a href="#__codelineno-3-117" id="__codelineno-3-117" name="__codelineno-3-117"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="mf">10</span>
<a href="#__codelineno-3-118" id="__codelineno-3-118" name="__codelineno-3-118"></a><span class="w">        </span><span class="nx">line</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_lines</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span>
<a href="#__codelineno-3-119" id="__codelineno-3-119" name="__codelineno-3-119"></a><span class="w">        </span><span class="nx">label</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span>
<a href="#__codelineno-3-120" id="__codelineno-3-120" name="__codelineno-3-120"></a>
<a href="#__codelineno-3-121" id="__codelineno-3-121" name="__codelineno-3-121"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">)</span>
<a href="#__codelineno-3-122" id="__codelineno-3-122" name="__codelineno-3-122"></a><span class="w">        </span><span class="kr">float</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">round_to_mintick</span><span class="p">((</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
<a href="#__codelineno-3-123" id="__codelineno-3-123" name="__codelineno-3-123"></a><span class="w">        </span><span class="nx">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">mid</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">close</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">close</span>
<a href="#__codelineno-3-124" id="__codelineno-3-124" name="__codelineno-3-124"></a><span class="w">        </span><span class="nx">array</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">sr_labels</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-125" id="__codelineno-3-125" name="__codelineno-3-125"></a><span class="w">          </span><span class="nx">label</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bar_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">labelloc</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-126" id="__codelineno-3-126" name="__codelineno-3-126"></a><span class="w">                     </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mid</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tostring</span><span class="p">(</span><span class="nx">mid</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tostring</span><span class="p">(</span><span class="nx">rate</span><span class="p">,</span><span class="s1">'#.##'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"%)"</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-127" id="__codelineno-3-127" name="__codelineno-3-127"></a><span class="w">                     </span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">red</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">lime</span><span class="p">,</span>
<a href="#__codelineno-3-128" id="__codelineno-3-128" name="__codelineno-3-128"></a><span class="w">                     </span><span class="nx">textcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">white</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">black</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-129" id="__codelineno-3-129" name="__codelineno-3-129"></a><span class="w">                     </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">style_labeldown</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">label</span><span class="p">.</span><span class="nx">style_labelup</span><span class="p">))</span>
<a href="#__codelineno-3-130" id="__codelineno-3-130" name="__codelineno-3-130"></a>
<a href="#__codelineno-3-131" id="__codelineno-3-131" name="__codelineno-3-131"></a><span class="w">        </span><span class="nx">array</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">sr_lines</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-132" id="__codelineno-3-132" name="__codelineno-3-132"></a><span class="w">                  </span><span class="nx">line</span><span class="p">.</span><span class="ow">new</span><span class="p">(</span><span class="nx">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bar_index</span><span class="p">,</span><span class="w"> </span><span class="nx">y1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mid</span><span class="p">,</span><span class="w"> </span><span class="nx">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bar_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">y2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mid</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-133" id="__codelineno-3-133" name="__codelineno-3-133"></a><span class="w">                  </span><span class="nx">extend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">both</span><span class="p">,</span>
<a href="#__codelineno-3-134" id="__codelineno-3-134" name="__codelineno-3-134"></a><span class="w">                  </span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">resistancecolor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">supportcolor</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-135" id="__codelineno-3-135" name="__codelineno-3-135"></a><span class="w">                  </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Lstyle</span><span class="p">,</span><span class="w"> </span>
<a href="#__codelineno-3-136" id="__codelineno-3-136" name="__codelineno-3-136"></a><span class="w">                  </span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">linewidth</span><span class="p">))</span>
<a href="#__codelineno-3-137" id="__codelineno-3-137" name="__codelineno-3-137"></a>
<a href="#__codelineno-3-138" id="__codelineno-3-138" name="__codelineno-3-138"></a><span class="nx">f_crossed_over</span><span class="p">()=&gt;</span>
<a href="#__codelineno-3-139" id="__codelineno-3-139" name="__codelineno-3-139"></a><span class="w">    </span><span class="nx">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<a href="#__codelineno-3-140" id="__codelineno-3-140" name="__codelineno-3-140"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">)</span>
<a href="#__codelineno-3-141" id="__codelineno-3-141" name="__codelineno-3-141"></a><span class="w">        </span><span class="kr">float</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">round_to_mintick</span><span class="p">((</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
<a href="#__codelineno-3-142" id="__codelineno-3-142" name="__codelineno-3-142"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">close</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">mid</span>
<a href="#__codelineno-3-143" id="__codelineno-3-143" name="__codelineno-3-143"></a><span class="w">            </span><span class="nx">ret</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-3-144" id="__codelineno-3-144" name="__codelineno-3-144"></a><span class="w">    </span><span class="nx">ret</span>
<a href="#__codelineno-3-145" id="__codelineno-3-145" name="__codelineno-3-145"></a>
<a href="#__codelineno-3-146" id="__codelineno-3-146" name="__codelineno-3-146"></a><span class="nx">f_crossed_under</span><span class="p">()=&gt;</span>
<a href="#__codelineno-3-147" id="__codelineno-3-147" name="__codelineno-3-147"></a><span class="w">    </span><span class="nx">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<a href="#__codelineno-3-148" id="__codelineno-3-148" name="__codelineno-3-148"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">size</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">na</span><span class="p">)</span>
<a href="#__codelineno-3-149" id="__codelineno-3-149" name="__codelineno-3-149"></a><span class="w">        </span><span class="kr">float</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">round_to_mintick</span><span class="p">((</span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_up_level</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">sr_dn_level</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
<a href="#__codelineno-3-150" id="__codelineno-3-150" name="__codelineno-3-150"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">close</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">mid</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">close</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">mid</span>
<a href="#__codelineno-3-151" id="__codelineno-3-151" name="__codelineno-3-151"></a><span class="w">            </span><span class="nx">ret</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-3-152" id="__codelineno-3-152" name="__codelineno-3-152"></a><span class="w">    </span><span class="nx">ret</span>
<a href="#__codelineno-3-153" id="__codelineno-3-153" name="__codelineno-3-153"></a>
<a href="#__codelineno-3-154" id="__codelineno-3-154" name="__codelineno-3-154"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">f_crossed_over</span><span class="p">(),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Resistance Broken'</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">=</span><span class="s1">'Resistance Broken'</span><span class="p">)</span>
<a href="#__codelineno-3-155" id="__codelineno-3-155" name="__codelineno-3-155"></a><span class="nx">alertcondition</span><span class="p">(</span><span class="nx">f_crossed_under</span><span class="p">(),</span><span class="w"> </span><span class="nx">title</span><span class="o">=</span><span class="s1">'Support Broken'</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">=</span><span class="s1">'Support Broken'</span><span class="p">)</span>
</code></pre></div> </article> </div> </div> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest", "header.autohide"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src="../../assets/javascripts/bundle.8492ddcf.min.js"></script> <script src="../../assets/javascripts/extra.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body> </html>