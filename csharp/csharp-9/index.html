<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Get an overview of the new features available in C# 9.0." name="description"/><meta content="Padam Shrestha" name="author"/><link href="../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.5.3, mkdocs-material-8.5.7" name="generator"/><title>What's new in C# 9.0 - C# Guide - Blog</title><link href="../../assets/stylesheets/main.20d9efc8.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../assets/stylesheets/extra.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-08DR4DTC9K"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-08DR4DTC9K",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-08DR4DTC9K",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="indigo" data-md-color-primary="light-blue" data-md-color-scheme="slate" dir="ltr"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#whats-new-in-c-90"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="Blog" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Blog </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> What's new in C# 9.0 - C# Guide </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="light-blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Blog" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Blog"> <img alt="logo" src="../../assets/images/blog_logo.png"/> </a> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2"> Synapse <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Synapse" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Synapse </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/build-dev-pyspark-cluster/"> üê≥ Build Development Spark cluster - PySpark, Delta Lake </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-dataframe-api/"> üìù PySpark Quickstart </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-cheat-sheet/"> üìÑ PySpark Cheat Sheet </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-azure-tables/"> ‚ú® Creating tables in PySpark Azure </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/spark-delta-partition/"> Creating partition in delta lake with spark </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/generate-stock-schema-delta-api/"> Design stock and option schema and provide fast api to access using spark delta </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/introduction/"> üìò Synapse Introduction </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/problem-solutions/"> üîì Synapse / PySpark problem and solutions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/data-dcitionary-pipeline/"> üß∫ Data dictionary for metadata driven Synapse pipeline </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/pyspark-courses/"> üîÖ Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../synapse/links/"> üîó Synapse links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3"> Python <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Python" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Python </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-basics/"> üêç Python Basics </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/create-python-package/"> üì¶ Create Custom Python Package </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/python-courses/"> üìô Courses and Tutorials </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../python/links/"> üîó Python links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4"> Dotnet <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Dotnet" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Dotnet </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../csharp-7/"> What's new in C# 7.0 through C# 7.3 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../csharp-8/"> What's new in C# 8.0 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> What's new in C# 9.0 - C# Guide <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> What's new in C# 9.0 - C# Guide </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#record-types"> Record types </a> <nav aria-label="Record types" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#positional-syntax-for-property-definition"> Positional syntax for property definition </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#immutability"> Immutability </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#value-equality"> Value equality </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#nondestructive-mutation"> Nondestructive mutation </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#built-in-formatting-for-display"> Built-in formatting for display </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#inheritance"> Inheritance </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#init-only-setters"> Init only setters </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#top-level-statements"> Top-level statements </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pattern-matching-enhancements"> Pattern matching enhancements </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#performance-and-interop"> Performance and interop </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#fit-and-finish-features"> Fit and finish features </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#support-for-code-generators"> Support for code generators </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../csharp-10/"> What's new in C# 10 - C# Guide </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../csharp-11/"> What's new in C# 11 - C# Guide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5"> Microservices <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Microservices" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Microservices </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/grafana-dashboards/"> Grafana Dashboards </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/azure-function-dapr/"> Azure function with Dapr to create event-driven, distributed application </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/dapr-resources/"> Resources </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../microservices/links/"> üîó Dapr links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6"> Serverless <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Serverless" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../serverless/links/"> üîó Azure Serverless links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7"> Azure <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Azure" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Azure </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-resource-graph-explorer/"> Write query using Azure Resource Graph Explorer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-keyboard-shortcuts/"> Azure Keyboard Shortcuts in Azure Portal </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/azure-service-fabric/"> Introduction to Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/starting-azure-service-fabric/"> Starting Azure Service Fabric </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../azure/links/"> üîó Azure links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" id="__nav_8" type="checkbox"/> <label class="md-nav__link" for="__nav_8"> Spark <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Spark" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> Spark </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/jupyter-pyspark-docker/"> Run Jupyter for Pyspark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-learning/"> Spark Machine Learning </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker/"> Run and Debug Dotnet Spark application on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-ubuntu/"> Install Dotnet Spark on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/dotnet-spark-docker-ubuntu/"> Running Dotnet Spark applications on Ubuntu Continer </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/install-docker-ubuntu2004/"> Install Docker on Ubuntu 20.04 LTS and Dotnet Spark on Docker </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/python-learning/"> Learning Python </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../spark/links/"> üîó Spark links </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9"> Kusto <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Kusto" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Kusto </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/kusto-overview/"> Kusto Query Language (KQL) </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/dynamic-365-hcm-kusto/"> Troubleshoot using Kusto </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" id="__nav_10" type="checkbox"/> <label class="md-nav__link" for="__nav_10"> Angular <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Angular" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> Angular </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../home/deploy-angular-app-to-github-io-pages/"> Deploy Angular app to github.io pages </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11"> Tools and Tricks <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Tools and Tricks" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> Tools and Tricks </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../explore/fastapi-uvicorn/"> Configure Fast API with Uvicorn in Dockerfile </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/limited_access_pat_token/"> Create Git PAT token with limited access. </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/multiple-remote-git/"> Multiple remote git configuration for repository </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/chocolatey/"> Install and manage applications using Chocolatey </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/keyboard-shortcuts/"> Keyboard shortcuts for everyday tasks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/error-solutions/"> Everyday error and fixes </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/certificates/"> Searching and Installing Certificates </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-vscode-ubuntu/"> Install VS Code on Ubuntu </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-brave-ubuntu2004/"> Install Brave browser on Ubuntu 20.04 LTS </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/useful-online-tools/"> ‚öí Useful online tools </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/helpful-links/"> üîó Helpful links </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/nuget/"> Nuget Package Manger </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/docker/"> üê≥ Installing and Running Docker in WSL with VS Code </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/dotnetcore-azurefunction-wsl/"> Install dotnet core 3.1 and azure-functions-core-tools on WSL </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/configure-publish-mkdocs-github/"> üìö Configure Mkdocs and Auto deploy to Github.io </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/rename-dotnet-3-6/"> Migrate Dotnet Core 3.1 to DotNet 6.0 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/git-help/"> Git </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/install-dotnet-sdk-armx64/"> Install dotnet skd on Mac m1 armx64 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/windows-tricks/"> Windows tricks </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tools/linux-commands/"> Useful linux commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" id="__nav_12" type="checkbox"/> <label class="md-nav__link" for="__nav_12"> Courses, Projects, Tutorials, Blogs <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Courses, Projects, Tutorials, Blogs" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> Courses, Projects, Tutorials, Blogs </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/coursera/"> Coursera Courses </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../courses-projects/github_project/"> Github repo and projects </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" id="__nav_13" type="checkbox"/> <label class="md-nav__link" for="__nav_13"> Finance <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Finance" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> Finance </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../finance/use_of_ft/"> Fourier Transform in Price </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" id="__nav_14" type="checkbox"/> <label class="md-nav__link" for="__nav_14"> Random <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Random" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> Random </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../random/links/"> üîó Random useful links </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tags/"> Tags </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#record-types"> Record types </a> <nav aria-label="Record types" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#positional-syntax-for-property-definition"> Positional syntax for property definition </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#immutability"> Immutability </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#value-equality"> Value equality </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#nondestructive-mutation"> Nondestructive mutation </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#built-in-formatting-for-display"> Built-in formatting for display </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#inheritance"> Inheritance </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#init-only-setters"> Init only setters </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#top-level-statements"> Top-level statements </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pattern-matching-enhancements"> Pattern matching enhancements </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#performance-and-interop"> Performance and interop </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#fit-and-finish-features"> Fit and finish features </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#support-for-code-generators"> Support for code generators </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="whats-new-in-c-90">What's new in C# 9.0<a class="headerlink" href="#whats-new-in-c-90" title="Permanent link">¬∂</a></h1> <p>C# 9.0 adds the following features and enhancements to the C# language:</p> <ul> <li><a href="#record-types">Records</a></li> <li><a href="#init-only-setters">Init only setters</a></li> <li><a href="#top-level-statements">Top-level statements</a></li> <li><a href="#pattern-matching-enhancements">Pattern matching enhancements</a></li> <li><a href="#performance-and-interop">Performance and interop</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/native-integers.md">Native sized integers</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/function-pointers.md">Function pointers</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/skip-localsinit.md">Suppress emitting localsinit flag</a></li> <li><a href="#fit-and-finish-features">Fit and finish features</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/target-typed-new.md">Target-typed <code>new</code> expressions</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/static-anonymous-functions.md"><code>static</code> anonymous functions</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/target-typed-conditional-expression.md">Target-typed conditional expressions</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/covariant-returns.md">Covariant return types</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/extension-getenumerator.md">Extension <code>GetEnumerator</code> support for <code>foreach</code> loops</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/lambda-discard-parameters.md">Lambda discard parameters</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/local-function-attributes.md">Attributes on local functions</a></li> <li><a href="#support-for-code-generators">Support for code generators</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/module-initializers.md">Module initializers</a></li> <li><a href="~/_csharplang/proposals/csharp-9.0/extending-partial-methods.md">New features for partial methods</a></li> <li><a href="../language-reference/compiler-messages/warning-waves.md#cs7023---a-static-type-is-used-in-an-is-or-as-expression">Warning wave 5</a></li> </ul> <p>C# 9.0 is supported on <strong>.NET 5</strong>. For more information, see <a href="../language-reference/configure-language-version.md">C# language versioning</a>.</p> <p>You can download the latest .NET SDK from the <a href="https://dotnet.microsoft.com/download">.NET downloads page</a>.</p> <h2 id="record-types">Record types<a class="headerlink" href="#record-types" title="Permanent link">¬∂</a></h2> <p>C# 9.0 introduces <strong><em>record types</em></strong>. You use the <code>record</code> keyword to define a reference type that provides built-in functionality for encapsulating data. You can create record types with immutable properties by using positional parameters or standard property syntax:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="PositionalRecord"::: :::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="ImmutableRecord":::</p> <p>You can also create record types with mutable properties and fields:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="MutableRecord":::</p> <p>While records can be mutable, they are primarily intended for supporting immutable data models. The record type offers the following features:</p> <ul> <li><a href="#whats-new-in-c-90">What's new in C# 9.0</a></li> <li><a href="#record-types">Record types</a><ul> <li><a href="#positional-syntax-for-property-definition">Positional syntax for property definition</a></li> <li><a href="#immutability">Immutability</a></li> <li><a href="#value-equality">Value equality</a></li> <li><a href="#nondestructive-mutation">Nondestructive mutation</a></li> <li><a href="#built-in-formatting-for-display">Built-in formatting for display</a></li> <li><a href="#inheritance">Inheritance</a></li> </ul> </li> <li><a href="#init-only-setters">Init only setters</a></li> <li><a href="#top-level-statements">Top-level statements</a></li> <li><a href="#pattern-matching-enhancements">Pattern matching enhancements</a></li> <li><a href="#performance-and-interop">Performance and interop</a></li> <li><a href="#fit-and-finish-features">Fit and finish features</a></li> <li><a href="#support-for-code-generators">Support for code generators</a></li> </ul> <p>You can use <a href="../language-reference/builtin-types/struct.md">structure types</a> to design data-centric types that provide value equality and little or no behavior. But for relatively large data models, structure types have some disadvantages:</p> <ul> <li>They don't support inheritance.</li> <li>They're less efficient at determining value equality. For value types, the <xref:system.valuetype.equals%2a?displayproperty=namewithtype> method uses reflection to find all fields. For records, the compiler generates the <code>Equals</code> method. In practice, the implementation of value equality in records is measurably faster.</xref:system.valuetype.equals%2a?displayproperty=namewithtype></li> <li>They use more memory in some scenarios, since every instance has a complete copy of all of the data. Record types are <a href="../language-reference/builtin-types/reference-types.md">reference types</a>, so a record instance contains only a reference to the data.</li> </ul> <h3 id="positional-syntax-for-property-definition">Positional syntax for property definition<a class="headerlink" href="#positional-syntax-for-property-definition" title="Permanent link">¬∂</a></h3> <p>You can use positional parameters to declare properties of a record and to initialize the property values when you create an instance:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="InstantiatePositional":::</p> <p>When you use the positional syntax for property definition, the compiler creates:</p> <ul> <li>A public init-only auto-implemented property for each positional parameter provided in the record declaration. An <a href="../language-reference/keywords/init.md">init-only</a> property can only be set in the constructor or by using a property initializer.</li> <li>A primary constructor whose parameters match the positional parameters on the record declaration.</li> <li>A <code>Deconstruct</code> method with an <code>out</code> parameter for each positional parameter provided in the record declaration.</li> </ul> <p>For more information, see <a href="../language-reference/builtin-types/record.md#positional-syntax-for-property-definition">Positional syntax</a> in the C# language reference article about records.</p> <h3 id="immutability">Immutability<a class="headerlink" href="#immutability" title="Permanent link">¬∂</a></h3> <p>A record type is not necessarily immutable. You can declare properties with <code>set</code> accessors and fields that aren't <code>readonly</code>. But while records can be mutable, they make it easier to create immutable data models. Properties that you create by using positional syntax are immutable.</p> <p>Immutability can be useful when you want a data-centric type to be thread-safe or a hash code to remain the same in a hash table. It can prevent bugs that happen when you pass an argument by reference to a method, and the method unexpectedly changes the argument value.</p> <p>The features unique to record types are implemented by compiler-synthesized methods, and none of these methods compromises immutability by modifying object state.</p> <h3 id="value-equality">Value equality<a class="headerlink" href="#value-equality" title="Permanent link">¬∂</a></h3> <p>Value equality means that two variables of a record type are equal if the types match and all property and field values match. For other reference types, equality means identity. That is, two variables of a reference type are equal if they refer to the same object.</p> <p>The following example illustrates value equality of record types:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="Equality":::</p> <p>In <code>class</code> types, you could manually override equality methods and operators to achieve value equality, but developing and testing that code would be time-consuming and error-prone. Having this functionality built-in prevents bugs that would result from forgetting to update custom override code when properties or fields are added or changed.</p> <p>For more information, see <a href="../language-reference/builtin-types/record.md#value-equality">Value equality</a> in the C# language reference article about records.</p> <h3 id="nondestructive-mutation">Nondestructive mutation<a class="headerlink" href="#nondestructive-mutation" title="Permanent link">¬∂</a></h3> <p>If you need to mutate immutable properties of a record instance, you can use a <code>with</code> expression to achieve <em>nondestructive mutation</em>. A <code>with</code> expression makes a new record instance that is a copy of an existing record instance, with specified properties and fields modified. You use <a href="../programming-guide/classes-and-structs/object-and-collection-initializers.md">object initializer</a> syntax to specify the values to be changed, as shown in the following example:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="WithExpressions":::</p> <p>For more information, see <a href="../language-reference/builtin-types/record.md#nondestructive-mutation">Nondestructive mutation</a> in the C# language reference article about records.</p> <h3 id="built-in-formatting-for-display">Built-in formatting for display<a class="headerlink" href="#built-in-formatting-for-display" title="Permanent link">¬∂</a></h3> <p>Record types have a compiler-generated <xref:system.object.tostring%2a> method that displays the names and values of public properties and fields. The <code>ToString</code> method returns a string of the following format:</xref:system.object.tostring%2a></p> <blockquote> <p>\<record name="" type=""> { \<property name=""> = \<value>, \<property name=""> = \<value>, ...}</value></property></value></property></record></p> </blockquote> <p>For reference types, the type name of the object that the property refers to is displayed instead of the property value. In the following example, the array is a reference type, so <code>System.String[]</code> is displayed instead of the actual array element values:</p> <div class="highlight"><span class="filename">Text Only</span><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>Person { FirstName = Nancy, LastName = Davolio, ChildNames = System.String[] }
</code></pre></div> <p>For more information, see <a href="../language-reference/builtin-types/record.md#built-in-formatting-for-display">Built-in formatting</a> in the C# language reference article about records.</p> <h3 id="inheritance">Inheritance<a class="headerlink" href="#inheritance" title="Permanent link">¬∂</a></h3> <p>A record can inherit from another record. However, a record can't inherit from a class, and a class can't inherit from a record.</p> <p>The following example illustrates inheritance with positional property syntax:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="PositionalInheritance":::</p> <p>For two record variables to be equal, the run-time type must be equal. The types of the containing variables might be different. This is illustrated in the following code example:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="InheritanceEquality":::</p> <p>In the example, all instances have the same properties and the same property values. But <code>student == teacher</code> returns <code>False</code> although both are <code>Person</code>-type variables. And <code>student == student2</code> returns <code>True</code> although one is a <code>Person</code> variable and one is a <code>Student</code> variable.</p> <p>All public properties and fields of both derived and base types are included in the <code>ToString</code> output, as shown in the following example:</p> <p>:::code language="csharp" source="../language-reference/builtin-types/snippets/shared/RecordType.cs" id="ToStringInheritance":::</p> <p>For more information, see <a href="../language-reference/builtin-types/record.md#inheritance">Inheritance</a> in the C# language reference article about records.</p> <h2 id="init-only-setters">Init only setters<a class="headerlink" href="#init-only-setters" title="Permanent link">¬∂</a></h2> <p><strong><em>Init only setters</em></strong> provide consistent syntax to initialize members of an object. Property initializers make it clear which value is setting which property. The downside is that those properties must be settable. Starting with C# 9.0, you can create <code>init</code> accessors instead of <code>set</code> accessors for properties and indexers. Callers can use property initializer syntax to set these values in creation expressions, but those properties are readonly once construction has completed. Init only setters provide a window to change state. That window closes when the construction phase ends. The construction phase effectively ends after all initialization, including property initializers and with-expressions have completed.</p> <p>You can declare <code>init</code> only setters in any type you write. For example, the following struct defines a weather observation structure:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/WeatherObservation.cs" ID="DeclareWeatherObservation":::</p> <p>Callers can use property initializer syntax to set the values, while still preserving the immutability:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/WeatherObservation.cs" ID="UseWeatherObservation":::</p> <p>An attempt to change an observation after initialization results in a compiler error:</p> <div class="highlight"><span class="filename">C#</span><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">// Error! CS8852.</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">now</span><span class="p">.</span><span class="n">TemperatureInCelsius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">;</span>
</code></pre></div> <p>Init only setters can be useful to set base class properties from derived classes. They can also set derived properties through helpers in a base class. Positional records declare properties using init only setters. Those setters are used in with-expressions. You can declare init only setters for any <code>class</code>, <code>struct</code>, or <code>record</code> you define.</p> <p>For more information, see <a href="../language-reference/keywords/init.md">init (C# Reference)</a>.</p> <h2 id="top-level-statements">Top-level statements<a class="headerlink" href="#top-level-statements" title="Permanent link">¬∂</a></h2> <p><strong><em>Top-level statements</em></strong> remove unnecessary ceremony from many applications. Consider the canonical "Hello World!" program:</p> <div class="highlight"><span class="filename">C#</span><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">using</span><span class="w"> </span><span class="nn">System</span><span class="p">;</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="k">namespace</span><span class="w"> </span><span class="nn">HelloWorld</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="p">{</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="k">class</span><span class="w"> </span><span class="nc">Program</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="p">{</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">        </span><span class="p">{</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Hello World!"</span><span class="p">);</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="p">}</span>
</code></pre></div> <p>There's only one line of code that does anything. With top-level statements, you can replace all that boilerplate with the <code>using</code> directive and the single line that does the work:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/Program.cs" ID="TopLevelStatements":::</p> <p>If you wanted a one-line program, you could remove the <code>using</code> directive and use the fully qualified type name:</p> <div class="highlight"><span class="filename">C#</span><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Hello World!"</span><span class="p">);</span>
</code></pre></div> <p>Only one file in your application may use top-level statements. If the compiler finds top-level statements in multiple source files, it's an error. It's also an error if you combine top-level statements with a declared program entry point method, typically a <code>Main</code> method. In a sense, you can think that one file contains the statements that would normally be in the <code>Main</code> method of a <code>Program</code> class. </p> <p>One of the most common uses for this feature is creating teaching materials. Beginner C# developers can write the canonical "Hello World!" in one or two lines of code. None of the extra ceremony is needed. However, seasoned developers will find many uses for this feature as well. Top-level statements enable a script-like experience for experimentation similar to what Jupyter notebooks provide. Top-level statements are great for small console programs and utilities. <a href="/azure/azure-functions/">Azure Functions</a> is an ideal use case for top-level statements.</p> <p>Most importantly, top-level statements don't limit your application's scope or complexity. Those statements can access or use any .NET class. They also don't limit your use of command-line arguments or return values. Top-level statements can access an array of strings named <code>args</code>. If the top-level statements return an integer value, that value becomes the integer return code from a synthesized <code>Main</code> method. The top-level statements may contain async expressions. In that case, the synthesized entry point returns a <code>Task</code>, or <code>Task&lt;int&gt;</code>.</p> <p>For more information, see <a href="../fundamentals/program-structure/top-level-statements.md">Top-level statements</a> in the C# Programming Guide.</p> <h2 id="pattern-matching-enhancements">Pattern matching enhancements<a class="headerlink" href="#pattern-matching-enhancements" title="Permanent link">¬∂</a></h2> <p>C# 9 includes new pattern matching improvements:</p> <ul> <li><strong><em>Type patterns</em></strong> match an object matches a particular type</li> <li><strong><em>Parenthesized patterns</em></strong> enforce or emphasize the precedence of pattern combinations</li> <li><strong><em>Conjunctive <code>and</code> patterns</em></strong> require both patterns to match</li> <li><strong><em>Disjunctive <code>or</code> patterns</em></strong> require either pattern to match</li> <li><strong><em>Negated <code>not</code> patterns</em></strong> require that a pattern doesn't match</li> <li><strong><em>Relational patterns</em></strong> require the input be less than, greater than, less than or equal, or greater than or equal to a given constant.</li> </ul> <p>These patterns enrich the syntax for patterns. Consider these examples:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/PatternUtilities.cs" ID="IsLetterPattern":::</p> <p>With optional parentheses to make it clear that <code>and</code> has higher precedence than <code>or</code>:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/PatternUtilities.cs" ID="IsLetterOrSeparatorPattern":::</p> <p>One of the most common uses is a new syntax for a null check:</p> <div class="highlight"><span class="filename">C#</span><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="p">{</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="c1">// ...</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="p">}</span>
</code></pre></div> <p>Any of these patterns can be used in any context where patterns are allowed: <code>is</code> pattern expressions, <code>switch</code> expressions, nested patterns, and the pattern of a <code>switch</code> statement's <code>case</code> label.</p> <p>For more information, see <a href="../language-reference/operators/patterns.md">Patterns (C# reference)</a>.</p> <p>For more information, see the <a href="../language-reference/operators/patterns.md#relational-patterns">Relational patterns</a> and <a href="../language-reference/operators/patterns.md#logical-patterns">Logical patterns</a> sections of the <a href="../language-reference/operators/patterns.md">Patterns</a> article.</p> <h2 id="performance-and-interop">Performance and interop<a class="headerlink" href="#performance-and-interop" title="Permanent link">¬∂</a></h2> <p>Three new features improve support for native interop and low-level libraries that require high performance: native sized integers, function pointers, and omitting the <code>localsinit</code> flag.</p> <p>Native sized integers, <code>nint</code> and <code>nuint</code>, are integer types. They're expressed by the underlying types <xref:system.intptr?displayproperty=namewithtype> and <xref:system.uintptr?displayproperty=namewithtype>. The compiler surfaces additional conversions and operations for these types as native ints. Native sized integers define properties for <code>MaxValue</code> or <code>MinValue</code>. These values can't be expressed as compile-time constants because they depend on the native size of an integer on the target machine. Those values are readonly at run time. You can use constant values for <code>nint</code> in the range [<code>int.MinValue</code> .. <code>int.MaxValue</code>]. You can use constant values for <code>nuint</code> in the range [<code>uint.MinValue</code> .. <code>uint.MaxValue</code>]. The compiler performs constant folding for all unary and binary operators using the <xref:system.int32?displayproperty=namewithtype> and <xref:system.uint32?displayproperty=namewithtype> types. If the result doesn't fit in 32 bits, the operation is executed at run time and isn't considered a constant. Native sized integers can increase performance in scenarios where integer math is used extensively and needs to have the fastest performance possible. For more information, see <a href="../language-reference/builtin-types/integral-numeric-types.md#native-sized-integers"><code>nint</code> and <code>nuint</code> types</a>.</xref:system.uint32?displayproperty=namewithtype></xref:system.int32?displayproperty=namewithtype></xref:system.uintptr?displayproperty=namewithtype></xref:system.intptr?displayproperty=namewithtype></p> <p>Function pointers provide an easy syntax to access the IL opcodes <code>ldftn</code> and <code>calli</code>. You can declare function pointers using new <code>delegate*</code> syntax. A <code>delegate*</code> type is a pointer type. Invoking the <code>delegate*</code> type uses <code>calli</code>, in contrast to a delegate that uses <code>callvirt</code> on the <code>Invoke()</code> method. Syntactically, the invocations are identical. Function pointer invocation uses the <code>managed</code> calling convention. You add the <code>unmanaged</code> keyword after the <code>delegate*</code> syntax to declare that you want the <code>unmanaged</code> calling convention. Other calling conventions can be specified using attributes on the <code>delegate*</code> declaration. For more information, see <a href="../language-reference/unsafe-code.md">Unsafe code and pointer types</a>.</p> <p>Finally, you can add the <xref:system.runtime.compilerservices.skiplocalsinitattribute?displayproperty=namewithtype> to instruct the compiler not to emit the <code>localsinit</code> flag. This flag instructs the CLR to zero-initialize all local variables. The <code>localsinit</code> flag has been the default behavior for C# since 1.0. However, the extra zero-initialization may have measurable performance impact in some scenarios. In particular, when you use <code>stackalloc</code>. In those cases, you can add the <xref:system.runtime.compilerservices.skiplocalsinitattribute>. You may add it to a single method or property, or to a <code>class</code>, <code>struct</code>, <code>interface</code>, or even a module. This attribute doesn't affect <code>abstract</code> methods; it affects the code generated for the implementation. For more information, see <a href="../language-reference/attributes/general.md#skiplocalsinit-attribute"><code>SkipLocalsInit</code> attribute</a>.</xref:system.runtime.compilerservices.skiplocalsinitattribute></xref:system.runtime.compilerservices.skiplocalsinitattribute?displayproperty=namewithtype></p> <p>These features can improve performance in some scenarios. They should be used only after careful benchmarking both before and after adoption. Code involving native sized integers must be tested on multiple target platforms with different integer sizes. The other features require unsafe code.</p> <h2 id="fit-and-finish-features">Fit and finish features<a class="headerlink" href="#fit-and-finish-features" title="Permanent link">¬∂</a></h2> <p>Many of the other features help you write code more efficiently. In C# 9.0, you can omit the type in a <a href="../language-reference/operators/new-operator.md"><code>new</code> expression</a> when the created object's type is already known. The most common use is in field declarations:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/FitAndFinish.cs" ID="WeatherStationField":::</p> <p>Target-typed <code>new</code> can also be used when you need to create a new object to pass as an argument to a method. Consider a <code>ForecastFor()</code> method with the following signature:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/FitAndFinish.cs" ID="ForecastSignature":::</p> <p>You could call it as follows:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/FitAndFinish.cs" ID="TargetTypeNewArgument":::</p> <p>Another nice use for this feature is to combine it with init only properties to initialize a new object:</p> <p>:::code language="csharp" source="snippets/whats-new-csharp9/FitAndFinish.cs" ID="InitWeatherStation":::</p> <p>You can return an instance created by the default constructor using a <code>return new();</code> statement.</p> <p>A similar feature improves the target type resolution of <a href="../language-reference/operators/conditional-operator.md">conditional expressions</a>. With this change, the two expressions need not have an implicit conversion from one to the other, but may both have implicit conversions to a target type. You likely won't notice this change. What you will notice is that some conditional expressions that previously required casts or wouldn't compile now just work.</p> <p>Starting in C# 9.0, you can add the <code>static</code> modifier to <a href="../language-reference/operators/lambda-expressions.md">lambda expressions</a> or <a href="../language-reference/operators/delegate-operator.md">anonymous methods</a>. Static lambda expressions are analogous to the <code>static</code> local functions: a static lambda or anonymous method can't capture local variables or instance state. The <code>static</code> modifier prevents accidentally capturing other variables.</p> <p>Covariant return types provide flexibility for the return types of <a href="../language-reference/keywords/override.md">override</a> methods. An override method can return a type derived from the return type of the overridden base method. This can be useful for records and for other types that support virtual clone or factory methods.</p> <p>In addition, the <a href="../language-reference/statements/iteration-statements.md#the-foreach-statement"><code>foreach</code> loop</a> will recognize and use an extension method <code>GetEnumerator</code> that otherwise satisfies the <code>foreach</code> pattern. This change means <code>foreach</code> is consistent with other pattern-based constructions such as the async pattern, and pattern-based deconstruction. In practice, this change means you can add <code>foreach</code> support to any type. You should limit its use to when enumerating an object makes sense in your design.</p> <p>Next, you can use discards as parameters to lambda expressions. This convenience enables you to avoid naming the argument, and the compiler may avoid using it. You use the <code>_</code> for any argument. For more information, see the <a href="../language-reference/operators/lambda-expressions.md#input-parameters-of-a-lambda-expression">Input parameters of a lambda expression</a> section of the <a href="../language-reference/operators/lambda-expressions.md">Lambda expressions</a> article.</p> <p>Finally, you can now apply attributes to <a href="../programming-guide/classes-and-structs/local-functions.md">local functions</a>. For example, you can apply <a href="../language-reference/attributes/nullable-analysis.md">nullable attribute annotations</a> to local functions.</p> <h2 id="support-for-code-generators">Support for code generators<a class="headerlink" href="#support-for-code-generators" title="Permanent link">¬∂</a></h2> <p>Two final features support C# code generators. C# code generators are a component you can write that is similar to a roslyn analyzer or code fix. The difference is that code generators analyze code and write new source code files as part of the compilation process. A typical code generator searches code for attributes or other conventions.</p> <p>A code generator reads attributes or other code elements using the Roslyn analysis APIs. From that information, it adds new code to the compilation. Source generators can only add code; they aren't allowed to modify any existing code in the compilation.</p> <p>The two features added for code generators are extensions to <strong><em>partial method syntax</em></strong>, and <strong><em>module initializers</em></strong>. First, the changes to partial methods. Before C# 9.0, partial methods are <code>private</code> but can't specify an access modifier, have a <code>void</code> return, and can't have <code>out</code> parameters. These restrictions meant that if no method implementation is provided, the compiler removes all calls to the partial method. C# 9.0 removes these restrictions, but requires that partial method declarations have an implementation. Code generators can provide that implementation. To avoid introducing a breaking change, the compiler considers any partial method without an access modifier to follow the old rules. If the partial method includes the <code>private</code> access modifier, the new rules govern that partial method. For more information, see <a href="../language-reference/keywords/partial-method.md">partial method (C# Reference)</a>.</p> <p>The second new feature for code generators is <strong><em>module initializers</em></strong>. Module initializers are methods that have the <xref:system.runtime.compilerservices.moduleinitializerattribute> attribute attached to them. These methods will be called by the runtime before any other field access or method invocation within the entire module. A module initializer method:</xref:system.runtime.compilerservices.moduleinitializerattribute></p> <ul> <li>Must be static</li> <li>Must be parameterless</li> <li>Must return void</li> <li>Must not be a generic method</li> <li>Must not be contained in a generic class</li> <li>Must be accessible from the containing module</li> </ul> <p>That last bullet point effectively means the method and its containing class must be internal or public. The method can't be a local function. For more information, see <a href="../language-reference/attributes/general.md#moduleinitializer-attribute"><code>ModuleInitializer</code> attribute</a>.</p> </article> </div> </div> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: What's new in C# 8.0" class="md-footer__link md-footer__link--prev" href="../csharp-8/" rel="prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Previous </span> What's new in C# 8.0 </div> </div> </a> <a aria-label="Next: What's new in C# 10 - C# Guide" class="md-footer__link md-footer__link--next" href="../csharp-10/" rel="next"> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> Next </span> What's new in C# 10 - C# Guide </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest", "header.autohide"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src="../../assets/javascripts/bundle.8492ddcf.min.js"></script> <script src="../../assets/javascripts/extra.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body> </html>